(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{jkDv:function(t,e,n){"use strict";n.r(e),n.d(e,"AdminModule",function(){return xp});var r=n("ofXK"),i=n("fXoL"),o=n("tyNb"),s=n("/t3+"),a=n("bTqV"),u=n("NFeN"),c=n("XhcP"),h=n("MutI"),l=n("FKr1");function f(t,e){if(1&t&&(i.Vb(0,"mat-list-item",13),i.Vb(1,"mat-icon",14),i.Ac(2),i.Ub(),i.Vb(3,"h3",15),i.Ac(4),i.Ub(),i.Ub()),2&t){const t=e.$implicit;i.mc("routerLink",t.url),i.Eb(2),i.Bc(t.icon),i.Eb(2),i.Bc(t.name)}}function d(t,e){if(1&t&&(i.Vb(0,"div"),i.zc(1,f,5,3,"mat-list-item",12),i.Ub()),2&t){const t=i.gc().$implicit;i.Eb(1),i.lc("ngForOf",t.children)}}function p(t,e){if(1&t&&(i.Vb(0,"mat-list-item",16),i.Vb(1,"mat-icon",14),i.Ac(2),i.Ub(),i.Vb(3,"h3",15),i.Ac(4),i.Ub(),i.Ub()),2&t){const t=i.gc().$implicit;i.Eb(2),i.Bc(t.icon),i.Eb(2),i.Bc(t.name)}}function m(t,e){if(1&t&&(i.Vb(0,"div"),i.zc(1,d,2,1,"div",10),i.zc(2,p,5,2,"mat-list-item",11),i.Ub()),2&t){const t=e.$implicit;i.Eb(1),i.lc("ngIf",null!=t.children),i.Eb(1),i.lc("ngIf",null==t.children)}}let g=(()=>{class t{constructor(t){this.router=t,this.loading=!0,this.menu=[{name:"Profil",icon:"account_circle",url:"/admin/beranda"},{group:"Menu Group",children:[{name:"Timeline",icon:"home",url:"/admin/product"},{name:"Gallery",icon:"collections",url:"/admin/collection"}]}]}ngOnInit(){}logout(){confirm("Keluar aplikasi?")&&(localStorage.removeItem("appToken"),this.router.navigate(["/login"]))}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(o.a))},t.\u0275cmp=i.Jb({type:t,selectors:[["app-admin"]],decls:19,vars:9,consts:[["color","primary",1,"example-header"],["mat-icon-button","",3,"click"],[1,"uk-width-expand"],["mat-button","",3,"click"],[1,"example-container"],["mode","side","opened","",1,"sidenav-left",3,"position","fixedInViewport","fixedTopGap","fixedBottomGap"],["sidenav",""],[4,"ngFor","ngForOf"],["mode","side",1,"example-sidenav",3,"position","fixedInViewport","fixedTopGap","fixedBottomGap"],[2,"padding","20px","background-color","rgb(250, 250, 250)"],[4,"ngIf"],["routerLink","/admin/beranda",4,"ngIf"],[3,"routerLink",4,"ngFor","ngForOf"],[3,"routerLink"],["matListIcon",""],["matLine",""],["routerLink","/admin/beranda"]],template:function(t,e){if(1&t){const t=i.Wb();i.Tb(0),i.Vb(1,"mat-toolbar",0),i.Vb(2,"button",1),i.cc("click",function(){return i.tc(t),i.rc(12).toggle()}),i.Vb(3,"mat-icon"),i.Ac(4,"menu"),i.Ub(),i.Ub(),i.Vb(5,"span"),i.Ac(6,"Welcome to The Reds Indonesia Web"),i.Ub(),i.Qb(7,"div",2),i.Vb(8,"button",3),i.cc("click",function(){return e.logout()}),i.Ac(9,"Logout"),i.Ub(),i.Ub(),i.Vb(10,"mat-sidenav-container",4),i.Vb(11,"mat-sidenav",5,6),i.Vb(13,"mat-nav-list"),i.zc(14,m,3,2,"div",7),i.Ub(),i.Ub(),i.Qb(15,"mat-sidenav",8,6),i.Vb(17,"mat-sidenav-content",9),i.Qb(18,"router-outlet"),i.Ub(),i.Ub(),i.Sb()}2&t&&(i.Eb(11),i.lc("position","start")("fixedInViewport",!0)("fixedTopGap",60)("fixedBottomGap",0),i.Eb(3),i.lc("ngForOf",e.menu),i.Eb(1),i.lc("position","end")("fixedInViewport",!0)("fixedTopGap",60)("fixedBottomGap",0))},directives:[s.a,a.a,u.a,c.b,c.a,h.d,r.j,c.c,o.d,r.k,h.b,o.b,h.a,l.j],styles:[""]}),t})();var y=n("hctd"),v=n("3Pt+"),b=n("tk/3");let w=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Jb({type:t,selectors:[["app-beranda"]],decls:19,vars:0,consts:[["lang","en"],["charset","utf-8"],["name","viewport","content","width-device-width, initial-scale=1"],["rel","stylesheet","href","https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"],["href","https://fonts.googleapis.com/css?family=Montserrat","rel","stylesheet"],[1,"container-fluid","bg-3","text-center"],[1,"margin"],["src","assets/images/theredsindo.jpeg","alt","Image","width","100%",1,"img-responsive"],[1,"container-fluid","bg-4","text-center"]],template:function(t,e){1&t&&(i.Vb(0,"html",0),i.Vb(1,"head"),i.Vb(2,"title"),i.Ac(3,"Bootstrap Theme Simply Me"),i.Ub(),i.Qb(4,"meta",1),i.Qb(5,"meta",2),i.Qb(6,"link",3),i.Qb(7,"link",4),i.Ub(),i.Vb(8,"body"),i.Vb(9,"div",5),i.Vb(10,"h3",6),i.Ac(11,"Selamat Datang di The Reds Indonesia Web"),i.Ub(),i.Qb(12,"br"),i.Vb(13,"p"),i.Ac(14,"The Reds Indonesia adalah official account fanbase dari klub Liverpool F.C. The Reds Indonesia pertama kali didirikan pada tahun 2015 dan muncul pertama kali di line. Seiring berkembangnya waktu kini The Reds Indonesia sudah memiliki akun Instagram (@theredsindo) dengan 22,8 ribu followers dan akun twitter (@The_RedsIndo) dengan 3,1 ribu followers. Salah satu kebanggaan dari The Reds Indonesia adalah nama The Reds Indonesia sudah pernah terpampang di ruang ganti pemain Liverpool di stadion Anfield."),i.Ub(),i.Qb(15,"img",7),i.Ub(),i.Vb(16,"footer",8),i.Vb(17,"p"),i.Ac(18,"The Reds Indonesia Web"),i.Ub(),i.Ub(),i.Ub(),i.Ub())},styles:["","body[_ngcontent-%COMP%] {\n  font: 20px Montserrat, sans-serif;\n  line-height: 1.8;\n  color: #f5f6f7;\n}\np[_ngcontent-%COMP%] {font-size: 20px;}\n.margin[_ngcontent-%COMP%] {margin-bottom: 45px;}\n.bg-1[_ngcontent-%COMP%] {\n  background-color: #1abc9c;\n  color: #ffffff;\n}\n.bg-2[_ngcontent-%COMP%] {\n  background-color: #474e5d;\n  color: #ffffff;\n}\n.bg-3[_ngcontent-%COMP%] {\n  background-color: #ffffff;\n  color: #555555;\n}\n.bg-4[_ngcontent-%COMP%] {\n  background-color: #2f2f2f;\n  color: #fff;\n}\n.container-fluid[_ngcontent-%COMP%] {\n  text-align:center;\n  padding-top: 70px;\n  padding-bottom: 70px;\n}\n.navbar[_ngcontent-%COMP%] {\n  padding-top: 15px;\n  padding-bottom: 15px;\n  border: 0;\n  border-radius: 0;\n  margin-bottom: 0;\n  font-size: 12px;\n  letter-spacing: 5px;\n}\n.navbar-nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover {\n  color: #1abc9c !important;\n}"]}),t})();var I=n("0IaG"),T=n("D0XW"),_=n("HDdC"),E=n("Cfvw"),O=n("LRne"),S=n("JX91"),A=n("Zy1z"),k=n("lJxs"),D=n("Kqap"),N=n("/uUt"),j=n("pLZG"),x=n("pxpQ"),C=n("spgP"),R=n("Jgta"),V=n("zIRd"),U=n("qOnz"),P=n("q/0M"),L=function(t,e){return(L=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function M(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var F,q="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},B=B||{},K=q||self;function Q(){}function G(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function z(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var H="closure_uid_"+(1e9*Math.random()>>>0),W=0;function X(t,e,n){return t.call.apply(t.bind,arguments)}function Y(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function J(t,e,n){return(J=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?X:Y).apply(null,arguments)}function $(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Z(){return Date.now()}function tt(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Pb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function et(){this.j=this.j,this.i=this.i}et.prototype.j=!1,et.prototype.ka=function(){!this.j&&(this.j=!0,this.H(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,H)&&t[H]||(t[H]=++W)}(this)},et.prototype.H=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var nt=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},rt=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function it(t){return Array.prototype.concat.apply([],arguments)}function ot(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function st(t){return/^[\s\xa0]*$/.test(t)}var at,ut=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function ct(t,e){return-1!=t.indexOf(e)}function ht(t,e){return t<e?-1:t>e?1:0}t:{var lt=K.navigator;if(lt){var ft=lt.userAgent;if(ft){at=ft;break t}}at=""}function dt(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function pt(t){var e={};for(var n in t)e[n]=t[n];return e}var mt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function gt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<mt.length;o++)n=mt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function yt(t){return yt[" "](t),t}yt[" "]=Q;var vt,bt,wt=ct(at,"Opera"),It=ct(at,"Trident")||ct(at,"MSIE"),Tt=ct(at,"Edge"),_t=Tt||It,Et=ct(at,"Gecko")&&!(ct(at.toLowerCase(),"webkit")&&!ct(at,"Edge"))&&!(ct(at,"Trident")||ct(at,"MSIE"))&&!ct(at,"Edge"),Ot=ct(at.toLowerCase(),"webkit")&&!ct(at,"Edge");function St(){var t=K.document;return t?t.documentMode:void 0}t:{var At="",kt=(bt=at,Et?/rv:([^\);]+)(\)|;)/.exec(bt):Tt?/Edge\/([\d\.]+)/.exec(bt):It?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(bt):Ot?/WebKit\/(\S+)/.exec(bt):wt?/(?:Version)[ \/]?(\S+)/.exec(bt):void 0);if(kt&&(At=kt?kt[1]:""),It){var Dt=St();if(null!=Dt&&Dt>parseFloat(At)){vt=String(Dt);break t}}vt=At}var Nt={};function jt(t){return function(t,e){var n=Nt;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,function(){for(var e=0,n=ut(String(vt)).split("."),r=ut(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;e=ht(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||ht(0==s[2].length,0==a[2].length)||ht(s[2],a[2]),s=s[3],a=a[3]}while(0==e)}return 0<=e})}var xt=K.document&&It&&(St()||parseInt(vt,10))||void 0,Ct=!It||9<=Number(xt),Rt=It&&!jt("9"),Vt=function(){if(!K.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{K.addEventListener("test",Q,e),K.removeEventListener("test",Q,e)}catch(n){}return t}();function Ut(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Pt(t,e){if(Ut.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(Et){t:{try{yt(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Lt[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}Ut.prototype.b=function(){this.defaultPrevented=!0},tt(Pt,Ut);var Lt={2:"touch",3:"pen",4:"mouse"};Pt.prototype.b=function(){Pt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Rt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var Mt="closure_listenable_"+(1e6*Math.random()|0),Ft=0;function qt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.da=i,this.key=++Ft,this.Y=this.Z=!1}function Bt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function Kt(t){this.src=t,this.a={},this.b=0}function Qt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=nt(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Bt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Gt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.da==r)return i}return-1}Kt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Gt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new qt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var zt="closure_lm_"+(1e6*Math.random()|0),Ht={};function Wt(t,e,n,r,i){if(r&&r.once)return Yt(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Wt(t,e[o],n,r,i);return null}return n=ie(n),t&&t[Mt]?t.wa(e,n,z(r)?!!r.capture:!!r,i):Xt(t,e,n,!1,r,i)}function Xt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=z(i)?!!i.capture:!!i;if(s&&!Ct)return null;var a=ne(t);if(a||(t[zt]=a=new Kt(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=ee,e=Ct?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Vt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Zt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Yt(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Yt(t,e[o],n,r,i);return null}return n=ie(n),t&&t[Mt]?t.xa(e,n,z(r)?!!r.capture:!!r,i):Xt(t,e,n,!0,r,i)}function Jt(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Jt(t,e[o],n,r,i);else r=z(r)?!!r.capture:!!r,n=ie(n),t&&t[Mt]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=Gt(o=t.a[e],n,r,i))&&(Bt(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=ne(t))&&(e=t.a[e.toString()],t=-1,e&&(t=Gt(e,n,r,i)),(n=-1<t?e[t]:null)&&$t(n))}function $t(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[Mt])Qt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Zt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=ne(e))?(Qt(n,t),0==n.b&&(n.src=null,e[zt]=null)):Bt(t)}}}function Zt(t){return t in Ht?Ht[t]:Ht[t]="on"+t}function te(t,e){var n=t.listener,r=t.da||t.src;return t.Z&&$t(t),n.call(r,e)}function ee(t,e){if(t.Y)return!0;if(!Ct){if(!e)t:{e=["window","event"];for(var n=K,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return te(t,e=new Pt(e,this))}return te(t,new Pt(e,this))}function ne(t){return(t=t[zt])instanceof Kt?t:null}var re="__closure_events_fn_"+(1e9*Math.random()>>>0);function ie(t){return"function"==typeof t?t:(t[re]||(t[re]=function(e){return t.handleEvent(e)}),t[re])}function oe(){et.call(this),this.c=new Kt(this),this.J=this,this.D=null}function se(t,e){var n,r=t.D;if(r)for(n=[];r;r=r.D)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new Ut(e,t);else if(e instanceof Ut)e.target=e.target||t;else{var i=e;gt(e=new Ut(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=ae(s,r,!0,e)&&i}if(i=ae(s=e.a=t,r,!0,e)&&i,i=ae(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=ae(s=e.a=n[o],r,!1,e)&&i}function ae(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var a=s.listener,u=s.da||s.src;s.Z&&Qt(t.c,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}tt(oe,et),oe.prototype[Mt]=!0,(F=oe.prototype).addEventListener=function(t,e,n,r){Wt(this,t,e,n,r)},F.removeEventListener=function(t,e,n,r){Jt(this,t,e,n,r)},F.H=function(){if(oe.X.H.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Bt(n[r]);delete e.a[t],e.b--}}this.D=null},F.wa=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},F.xa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var ue=K.JSON.stringify;function ce(){this.b=this.a=null}var he,le=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,this.a=(t=this.a).next,t.next=null):t=this.c(),t},t}())(function(){return new de},function(t){t.reset()});function fe(){var t=ye,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function de(){this.next=this.b=this.a=null}function pe(t){K.setTimeout(function(){throw t},0)}function me(t,e){he||function(){var t=K.Promise.resolve(void 0);he=function(){t.then(ve)}}(),ge||(he(),ge=!0),ye.add(t,e)}ce.prototype.add=function(t,e){var n=le.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},de.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},de.prototype.reset=function(){this.next=this.b=this.a=null};var ge=!1,ye=new ce;function ve(){for(var t;t=fe();){try{t.a.call(t.b)}catch(n){pe(n)}var e=le;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}ge=!1}function be(t,e){oe.call(this),this.b=t||1,this.a=e||K,this.f=J(this.eb,this),this.g=Z()}function we(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Ie(t,e,n){if("function"==typeof t)n&&(t=J(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=J(t.handleEvent,t)}return 2147483647<Number(e)?-1:K.setTimeout(t,e||0)}function Te(t){t.a=Ie(function(){t.a=null,t.c&&(t.c=!1,Te(t))},t.h);var e=t.b;t.b=null,t.g.apply(null,e)}tt(be,oe),(F=be.prototype).aa=!1,F.M=null,F.eb=function(){if(this.aa){var t=Z()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),se(this,"tick"),this.aa&&(we(this),this.start()))}},F.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=Z())},F.H=function(){be.X.H.call(this),we(this),delete this.a};var _e=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}L(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Te(this)},e.prototype.H=function(){t.prototype.H.call(this),this.a&&(K.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(et);function Ee(t){et.call(this),this.b=t,this.a={}}tt(Ee,et);var Oe=[];function Se(t,e,n,r){Array.isArray(n)||(n&&(Oe[0]=n.toString()),n=Oe);for(var i=0;i<n.length;i++){var o=Wt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function Ae(t){dt(t.a,function(t,e){this.a.hasOwnProperty(e)&&$t(t)},t),t.a={}}function ke(){this.a=!0}function De(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return ue(n)}catch(a){return e}}(t,n)+(r?" "+r:"")})}Ee.prototype.H=function(){Ee.X.H.call(this),Ae(this)},Ee.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ke.prototype.info=function(){};var Ne={},je=null;function xe(){return je=je||new oe}function Ce(t){Ut.call(this,Ne.Ga,t)}function Re(t){var e=xe();se(e,new Ce(e,t))}function Ve(t,e){Ut.call(this,Ne.STAT_EVENT,t),this.stat=e}function Ue(t){var e=xe();se(e,new Ve(e,t))}function Pe(t){Ut.call(this,Ne.Ha,t)}function Le(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return K.setTimeout(function(){t()},e)}Ne.Ga="serverreachability",tt(Ce,Ut),Ne.STAT_EVENT="statevent",tt(Ve,Ut),Ne.Ha="timingevent",tt(Pe,Ut);var Me={NO_ERROR:0,fb:1,sb:2,rb:3,mb:4,qb:5,tb:6,Ea:7,TIMEOUT:8,wb:9},Fe={kb:"complete",Gb:"success",Fa:"error",Ea:"abort",yb:"ready",zb:"readystatechange",TIMEOUT:"timeout",ub:"incrementaldata",xb:"progress",nb:"downloadprogress",Ob:"uploadprogress"};function qe(){}function Be(){}qe.prototype.b=null;var Ke,Qe={OPEN:"a",jb:"b",Fa:"c",vb:"d"};function Ge(){Ut.call(this,"d")}function ze(){Ut.call(this,"c")}function He(){}function We(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new Ee(this),this.P=Xe,this.R=new be(t=_t?125:void 0),this.B=null,this.b=!1,this.j=this.l=this.i=this.G=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}tt(Ge,Ut),tt(ze,Ut),tt(He,qe),He.prototype.a=function(){return new XMLHttpRequest},He.prototype.c=function(){return{}},Ke=new He;var Xe=45e3,Ye={},Je={};function $e(t,e,n){t.G=1,t.i=In(mn(e)),t.j=n,t.I=!0,Ze(t,null)}function Ze(t,e){t.u=Z(),nn(t),t.l=mn(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),Rn(n.b,"t",r),t.D=0,t.a=kr(t.g,t.g.C?e:null),0<t.O&&(t.F=new _e(J(t.Da,t,t.a),t.O)),Se(t.J,t.a,"readystatechange",t.bb),e=t.B?pt(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),Re(1),function(t,e,n,r,i,o){t.info(function(){if(t.a)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");s=2<=l.length&&"type"==l[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s})}(t.c,t.m,t.l,t.f,t.S,t.j)}function tn(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=en(t,n);if(i==Je){4==e&&(t.h=4,Ue(14),r=!1),De(t.c,t.f,null,"[Incomplete Response]");break}if(i==Ye){t.h=4,Ue(15),De(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}De(t.c,t.f,i,null),un(t,i)}4==e&&0==n.length&&(t.h=1,Ue(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),wr(e),e.F=!0,Ue(11))):(De(t.c,t.f,n,"[Invalid Chunked Response]"),an(t),sn(t))}function en(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?Je:(n=Number(e.substring(n,r)),isNaN(n)?Ye:(r+=1)+n>e.length?Je:(e=e.substr(r,n),t.D=r+n,e))}function nn(t){t.T=Z()+t.P,rn(t,t.P)}function rn(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Le(J(t.$a,t),e)}function on(t){t.o&&(K.clearTimeout(t.o),t.o=null)}function sn(t){0==t.g.v||t.A||_r(t.g,t)}function an(t){on(t);var e=t.F;e&&"function"==typeof e.ka&&e.ka(),t.F=null,we(t.R),Ae(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ka())}function un(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||qn(n.b,t)))if(n.I=t.N,!t.C&&qn(n.b,t)&&3==n.v){try{var r=n.la.a.parse(e)}catch(xd){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;Tr(n),lr(n)}br(n),Ue(18)}}else n.pa=i[1],0<n.pa-n.P&&37500>i[2]&&n.G&&0==n.o&&!n.m&&(n.m=Le(J(n.Xa,n),6e3));if(1>=Fn(n.b)&&n.fa){try{n.fa()}catch(xd){}n.fa=void 0}}else Or(n,11)}else if((t.C||n.a==t)&&Tr(n),!st(e))for(e=r=n.la.a.parse(e),r=0;r<e.length;r++)if(n.P=(i=e[r])[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ha=i[2];var o=i[3];null!=o&&(n.ia=o,n.c.info("VER="+n.ia));var s=i[4];null!=s&&(n.qa=s,n.c.info("SVER="+n.qa));var a=i[5];if(null!=a&&"number"==typeof a&&0<a){var u=1.5*a;n.D=u,n.c.info("backChannelRequestTimeoutMs_="+u)}u=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=u.b;!l.a&&(ct(h,"spdy")||ct(h,"quic")||ct(h,"h2"))&&(l.f=l.g,l.a=new Set,l.b&&(Bn(l,l.b),l.b=null))}if(u.A){var f=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.oa=f,wn(u.B,u.A,f))}}n.v=3,n.f&&n.f.ua(),n.U&&(n.N=Z()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var d=t;if((u=n).ma=Ar(u,u.C?u.ha:null,u.ga),d.C){Kn(u.b,d);var p=d,m=u.D;m&&p.setTimeout(m),p.o&&(on(p),nn(p)),u.a=d}else vr(u);0<n.g.length&&pr(n)}else"stop"!=i[0]&&"close"!=i[0]||Or(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?Or(n,7):hr(n):"noop"!=i[0]&&n.f&&n.f.ta(i),n.o=0);Re(4)}catch(xd){}}function cn(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(G(t)||"string"==typeof t)rt(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(G(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(G(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function hn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof hn)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ln(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];fn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)fn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function fn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(F=We.prototype).setTimeout=function(t){this.P=t},F.bb=function(t){t=t.target;var e=this.F;e&&3==sr(t)?e.f():this.Da(t)},F.Da=function(t){try{if(t==this.a)t:{var e=sr(this.a),n=this.a.va(),r=this.a.W();if(!(3>e||3==e&&!_t&&!this.a.$())){this.A||4!=e||7==n||Re(8==n||0>=r?3:2),on(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s})}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,a=this.a;if((s=a.a?a.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!st(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.h=3,Ue(12),an(this),sn(this);break t}De(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,un(this,u)}this.I?(tn(this,e,o),_t&&this.b&&3==e&&(Se(this.J,this.R,"tick",this.ab),this.R.start())):(De(this.c,this.f,o,null),un(this,o)),4==e&&an(this),this.b&&!this.A&&(4==e?_r(this.g,this):(this.b=!1,nn(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Ue(12)):(this.h=0,Ue(13)),an(this),sn(this)}}}catch(c){}},F.ab=function(){if(this.a){var t=sr(this.a),e=this.a.$();this.D<e.length&&(on(this),tn(this,t,e),this.b&&4!=t&&nn(this))}},F.cancel=function(){this.A=!0,an(this)},F.$a=function(){this.o=null;var t=Z();0<=t-this.T?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.c,this.l),2!=this.G&&(Re(3),Ue(17)),an(this),this.h=2,sn(this)):rn(this,this.T-t)},(F=hn.prototype).K=function(){ln(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},F.L=function(){return ln(this),this.a.concat()},F.get=function(t,e){return fn(this.b,t)?this.b[t]:e},F.set=function(t,e){fn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},F.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var dn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function pn(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof pn){this.a=void 0!==e?e:t.a,gn(this,t.f),this.j=t.j,yn(this,t.c),vn(this,t.h),this.g=t.g,e=t.b;var n=new Nn;n.c=e.c,e.a&&(n.a=new hn(e.a),n.b=e.b),bn(this,n),this.i=t.i}else t&&(n=String(t).match(dn))?(this.a=!!e,gn(this,n[1]||"",!0),this.j=Tn(n[2]||""),yn(this,n[3]||"",!0),vn(this,n[4]),this.g=Tn(n[5]||"",!0),bn(this,n[6]||"",!0),this.i=Tn(n[7]||"")):(this.a=!!e,this.b=new Nn(null,this.a))}function mn(t){return new pn(t)}function gn(t,e,n){t.f=n?Tn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function yn(t,e,n){t.c=n?Tn(e,!0):e}function vn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function bn(t,e,n){e instanceof Nn?(t.b=e,function(t,e){e&&!t.f&&(jn(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(xn(this,e),Rn(this,n,t))},t)),t.f=e}(t.b,t.a)):(n||(e=_n(e,kn)),t.b=new Nn(e,t.a))}function wn(t,e,n){t.b.set(e,n)}function In(t){return wn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Z()).toString(36)),t}function Tn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function _n(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,En),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function En(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}pn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(_n(e,On,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(_n(e,On,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(_n(n,"/"==n.charAt(0)?An:Sn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",_n(n,Dn)),t.join("")};var On=/[#\/\?@]/g,Sn=/[#\?:]/g,An=/[#\?]/g,kn=/[#\?@]/g,Dn=/#/g;function Nn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function jn(t){t.a||(t.a=new hn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function xn(t,e){jn(t),e=Vn(t,e),fn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,fn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&ln(t)))}function Cn(t,e){return jn(t),e=Vn(t,e),fn(t.a.b,e)}function Rn(t,e,n){xn(t,e),0<n.length&&(t.c=null,t.a.set(Vn(t,e),ot(n)),t.b+=n.length)}function Vn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(F=Nn.prototype).add=function(t,e){jn(this),this.c=null,t=Vn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},F.forEach=function(t,e){jn(this),this.a.forEach(function(n,r){rt(n,function(n){t.call(e,n,r,this)},this)},this)},F.L=function(){jn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},F.K=function(t){jn(this);var e=[];if("string"==typeof t)Cn(this,t)&&(e=it(e,this.a.get(Vn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=it(e,t[n])}return e},F.set=function(t,e){return jn(this),this.c=null,Cn(this,t=Vn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},F.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},F.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var Un=function(){return function(t,e){this.b=t,this.a=e}}();function Pn(t){this.g=t||Ln,t=K.PerformanceNavigationTiming?0<(t=K.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(K.ja&&K.ja.za&&K.ja.za()&&K.ja.za().Qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var Ln=10;function Mn(t){return!!t.b||!!t.a&&t.a.size>=t.f}function Fn(t){return t.b?1:t.a?t.a.size:0}function qn(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function Bn(t,e){t.a?t.a.add(e):t.b=e}function Kn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Qn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=M(t.a.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.s)}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return ot(t.c)}function Gn(){}function zn(){this.a=new Gn}function Hn(t,e,n){var r=n||"";try{cn(t,function(t,n){var i=t;z(t)&&(i=ue(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(np){throw e.push(r+"type="+encodeURIComponent("_badmap")),np}}function Wn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}Pn.prototype.cancel=function(){var t,e;if(this.c=Qn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=M(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Gn.prototype.stringify=function(t){return K.JSON.stringify(t,void 0)},Gn.prototype.parse=function(t){return K.JSON.parse(t,void 0)};var Xn=K.JSON.parse;function Yn(t){oe.call(this),this.headers=new hn,this.l=t||null,this.b=!1,this.u=this.a=null,this.C="",this.h=0,this.f="",this.g=this.B=this.m=this.A=!1,this.s=0,this.o=null,this.I=Jn,this.F=this.G=!1}tt(Yn,oe);var Jn="",$n=/^https?$/i,Zn=["POST","PUT"];function tr(t){return"content-type"==t.toLowerCase()}function er(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,nr(t),ir(t)}function nr(t){t.A||(t.A=!0,se(t,"complete"),se(t,"error"))}function rr(t){if(t.b&&void 0!==B&&(!t.u[1]||4!=sr(t)||2!=t.W()))if(t.m&&4==sr(t))Ie(t.Aa,0,t);else if(se(t,"readystatechange"),4==sr(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.C).match(dn)[1]||null;if(!o&&K.self&&K.self.location){var s=K.self.location.protocol;o=s.substr(0,s.length-1)}i=!$n.test(o?o.toLowerCase():"")}e=i}if(e)se(t,"complete"),se(t,"success");else{t.h=6;try{var a=2<sr(t)?t.a.statusText:""}catch(n){a=""}t.f=a+" ["+t.W()+"]",nr(t)}}finally{ir(t)}}}function ir(t,e){if(t.a){or(t);var n=t.a,r=t.u[0]?Q:null;t.a=null,t.u=null,e||se(t,"ready");try{n.onreadystatechange=r}catch(np){}}}function or(t){t.a&&t.F&&(t.a.ontimeout=null),t.o&&(K.clearTimeout(t.o),t.o=null)}function sr(t){return t.a?t.a.readyState:0}function ar(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return dt(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):wn(t,e,n))}function ur(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function cr(t){this.qa=0,this.g=[],this.c=new ke,this.ha=this.ma=this.B=this.ga=this.a=this.oa=this.A=this.V=this.i=this.O=this.l=null,this.Pa=this.R=0,this.Ma=ur("failFast",!1,t),this.G=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.pa=this.P=-1,this.T=this.o=this.u=0,this.Ia=ur("baseRetryDelayMs",5e3,t),this.Sa=ur("retryDelaySeedMs",1e4,t),this.Na=ur("forwardChannelMaxRetries",2,t),this.na=ur("forwardChannelRequestTimeoutMs",2e4,t),this.Oa=t&&t.xmlHttpFactory||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new Pn(t&&t.concurrentRequestLimit),this.la=new zn,this.ea=t&&t.fastHandshake||!1,this.Ja=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.ea&&this.S&&t&&t.detectBufferingProxy||!1,this.fa=void 0,this.N=0,this.F=!1,this.s=null,(this.La=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function hr(t){if(fr(t),3==t.v){var e=t.R++,n=mn(t.B);wn(n,"SID",t.J),wn(n,"RID",e),wn(n,"TYPE","terminate"),gr(t,n),(e=new We(t,t.c,e,void 0)).G=2,e.i=In(mn(n)),n=!1,K.navigator&&K.navigator.sendBeacon&&(n=K.navigator.sendBeacon(e.i.toString(),"")),!n&&K.Image&&((new Image).src=e.i,n=!0),n||(e.a=kr(e.g,null),e.a.ba(e.i)),e.u=Z(),nn(e)}Sr(t)}function lr(t){t.a&&(wr(t),t.a.cancel(),t.a=null)}function fr(t){lr(t),t.j&&(K.clearTimeout(t.j),t.j=null),Tr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&K.clearTimeout(t.h),t.h=null)}function dr(t,e){t.g.push(new Un(t.Pa++,e)),3==t.v&&pr(t)}function pr(t){Mn(t.b)||t.h||(t.h=!0,me(t.Ca,t),t.u=0)}function mr(t,e){var n;n=e?e.f:t.R++;var r=mn(t.B);wn(r,"SID",t.J),wn(r,"RID",n),wn(r,"AID",t.P),gr(t,r),t.i&&t.l&&ar(r,t.i,t.l),n=new We(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=yr(t,n,1e3),n.setTimeout(Math.round(.5*t.na)+Math.round(.5*t.na*Math.random())),Bn(t.b,n),$e(n,r,e)}function gr(t,e){t.f&&cn({},function(t,n){wn(e,n,t)})}function yr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?J(t.f.Ka,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].b)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].b,h=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),a=!1;else try{Hn(h,s,"req"+c+"_")}catch(li){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function vr(t){t.a||t.j||(t.T=1,me(t.Ba,t),t.o=0)}function br(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=Le(J(t.Ba,t),Er(t,t.o)),t.o++,0))}function wr(t){null!=t.s&&(K.clearTimeout(t.s),t.s=null)}function Ir(t){t.a=new We(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=mn(t.ma);wn(e,"RID","rpc"),wn(e,"SID",t.J),wn(e,"CI",t.G?"0":"1"),wn(e,"AID",t.P),gr(t,e),wn(e,"TYPE","xmlhttp"),t.i&&t.l&&ar(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ha,n.G=1,n.i=In(mn(e)),n.j=null,n.I=!0,Ze(n,t)}function Tr(t){null!=t.m&&(K.clearTimeout(t.m),t.m=null)}function _r(t,e){var n=null;if(t.a==e){Tr(t),wr(t),t.a=null;var r=2}else{if(!qn(t.b,e))return;n=e.s,Kn(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=Z()-e.u;var i=t.u;se(r=xe(),new Pe(r,n,e,i)),pr(t)}else vr(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(Fn(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.Ma?0:t.Na)||(t.h=Le(J(t.Ca,t,e),Er(t,t.u)),t.u++,0)))}(t,e)||2==r&&br(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:Or(t,5);break;case 4:Or(t,10);break;case 3:Or(t,6);break;default:Or(t,2)}}function Er(t,e){var n=t.Ia+Math.floor(Math.random()*t.Sa);return t.f||(n*=2),n*e}function Or(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=J(t.cb,t);n||(n=new pn("//www.google.com/images/cleardot.gif"),K.location&&"http"==K.location.protocol||gn(n,"https"),In(n)),function(t,e){var n=new ke;if(K.Image){var r=new Image;r.onload=$(Wn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=$(Wn,n,r,"TestLoadImage: error",!1,e),r.onabort=$(Wn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=$(Wn,n,r,"TestLoadImage: timeout",!1,e),K.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else Ue(2);t.v=0,t.f&&t.f.sa(e),Sr(t),fr(t)}function Sr(t){t.v=0,t.I=-1,t.f&&(0==Qn(t.b).length&&0==t.g.length||(t.b.c.length=0,ot(t.g),t.g.length=0),t.f.ra())}function Ar(t,e,n){var r=function(t){return t instanceof pn?mn(t):new pn(t,void 0)}(n);if(""!=r.c)e&&yn(r,e+"."+r.c),vn(r,r.h);else{var i=K.location;r=function(t,e,n,r){var i=new pn(null,void 0);return t&&gn(i,t),e&&yn(i,e),n&&vn(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&dt(t.V,function(t,e){wn(r,e,t)}),n=t.oa,(e=t.A)&&n&&wn(r,e,n),wn(r,"VER",t.ia),gr(t,r),r}function kr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Yn(t.Oa)).G=t.C,e}function Dr(){}function Nr(){if(It&&!(10<=Number(xt)))throw Error("Environmental error: no available transport.")}function jr(t,e){oe.call(this),this.a=new cr(e),this.g=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!st(t)&&(this.a.i=t),this.o=e&&e.supportsCrossDomainXhr||!1,this.m=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!st(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new Rr(this)}function xr(t){Ge.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Cr(){ze.call(this),this.status=1}function Rr(t){this.a=t}function Vr(t){this.f=t}function Ur(t){oe.call(this),this.u=t,this.h=void 0,this.readyState=Pr,this.status=0,this.responseType=this.responseText=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.o="",this.a=!1,this.m=this.f=this.g=null}(F=Yn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.C+"; newUri="+t);e=e?e.toUpperCase():"GET",this.C=t,this.f="",this.h=0,this.A=!1,this.b=!0,this.a=this.l?this.l.a():Ke.a(),this.u=function(t){return t.b||(t.b=t.c())}(this.l?this.l:Ke),this.a.onreadystatechange=J(this.Aa,this);try{this.B=!0,this.a.open(e,String(t),!0),this.B=!1}catch(o){return void er(this,o)}t=n||"";var i=new hn(this.headers);r&&cn(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=tr,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=K.FormData&&t instanceof K.FormData,!(0<=nt(Zn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.G&&(this.a.withCredentials=this.G);try{or(this),0<this.s&&((this.F=function(t){return It&&jt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.s,this.a.ontimeout=J(this.ya,this)):this.o=Ie(this.ya,this.s,this)),this.m=!0,this.a.send(t),this.m=!1}catch(o){er(this,o)}},F.ya=function(){void 0!==B&&this.a&&(this.f="Timed out after "+this.s+"ms, aborting",this.h=8,se(this,"timeout"),this.abort(8))},F.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,se(this,"complete"),se(this,"abort"),ir(this))},F.H=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),ir(this,!0)),Yn.X.H.call(this)},F.Aa=function(){this.j||(this.B||this.m||this.g?rr(this):this.Za())},F.Za=function(){rr(this)},F.W=function(){try{return 2<sr(this)?this.a.status:-1}catch(bt){return-1}},F.$=function(){try{return this.a?this.a.responseText:""}catch(bt){return""}},F.Qa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Xn(e)}},F.va=function(){return this.h},F.Ra=function(){return"string"==typeof this.f?this.f:String(this.f)},(F=cr.prototype).ia=8,F.v=1,F.Ca=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new We(this,this.c,t,void 0),r=this.l;if(this.O&&(r?gt(r=pt(r),this.O):r=this.O),null===this.i&&(n.B=r),this.ea)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=yr(this,n,e),wn(i=mn(this.B),"RID",t),wn(i,"CVER",22),this.A&&wn(i,"X-HTTP-Session-Id",this.A),gr(this,i),this.i&&r&&ar(i,this.i,r),Bn(this.b,n),this.Ja&&wn(i,"TYPE","init"),this.ea?(wn(i,"$req",e),wn(i,"SID","null"),n.U=!0,$e(n,i,null)):$e(n,i,e),this.v=2}}else 3==this.v&&(t?mr(this,t):0==this.g.length||Mn(this.b)||mr(this))},F.Ba=function(){if(this.j=null,Ir(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=Le(J(this.Ya,this),t)}},F.Ya=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.F=!0,Ue(10),lr(this),Ir(this))},F.Xa=function(){null!=this.m&&(this.m=null,lr(this),br(this),Ue(19))},F.cb=function(t){t?(this.c.info("Successfully pinged google.com"),Ue(2)):(this.c.info("Failed to ping google.com"),Ue(1))},(F=Dr.prototype).ua=function(){},F.ta=function(){},F.sa=function(){},F.ra=function(){},F.Ka=function(){},Nr.prototype.a=function(t,e){return new jr(t,e)},tt(jr,oe),jr.prototype.h=function(){this.a.f=this.f,this.o&&(this.a.C=!0);var t=this.a,e=this.g,n=this.b||void 0;Ue(0),t.ga=e,t.V=n||{},t.G=t.S,t.B=Ar(t,null,t.ga),pr(t)},jr.prototype.close=function(){hr(this.a)},jr.prototype.l=function(t){if("string"==typeof t){var e={};e.__data__=t,dr(this.a,e)}else this.m?((e={}).__data__=ue(t),dr(this.a,e)):dr(this.a,t)},jr.prototype.H=function(){this.a.f=null,delete this.f,hr(this.a),delete this.a,jr.X.H.call(this)},tt(xr,Ge),tt(Cr,ze),tt(Rr,Dr),Rr.prototype.ua=function(){se(this.a,"a")},Rr.prototype.ta=function(t){se(this.a,new xr(t))},Rr.prototype.sa=function(t){se(this.a,new Cr(t))},Rr.prototype.ra=function(){se(this.a,"b")},tt(Vr,qe),Vr.prototype.a=function(){return new Ur(this.f)},Vr.prototype.c=function(t){return function(){return t}}({}),tt(Ur,oe);var Pr=0;function Lr(t){t.f.read().then(t.Ta.bind(t)).catch(t.ca.bind(t))}function Mr(t){t.readyState=4,t.g=null,t.f=null,t.m=null,Fr(t)}function Fr(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(F=Ur.prototype).open=function(t,e){if(this.readyState!=Pr)throw this.abort(),Error("Error reopening a connection");this.s=t,this.o=e,this.readyState=1,Fr(this)},F.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.l,method:this.s,credentials:this.h,cache:void 0};t&&(e.body=t),this.u.fetch(new Request(this.o,e)).then(this.Wa.bind(this),this.ca.bind(this))},F.abort=function(){this.responseText="",this.l=new Headers,this.status=0,this.f&&this.f.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,Mr(this)),this.readyState=Pr},F.Wa=function(t){this.a&&(this.g=t,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=t.headers,this.readyState=2,Fr(this)),this.a&&(this.readyState=3,Fr(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.Ua.bind(this),this.ca.bind(this)):void 0!==K.ReadableStream&&"body"in t?(this.responseText="",this.f=t.body.getReader(),this.m=new TextDecoder,Lr(this)):t.text().then(this.Va.bind(this),this.ca.bind(this)))))},F.Ta=function(t){if(this.a){var e=this.m.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.responseText+=e),t.done?Mr(this):Fr(this),3==this.readyState&&Lr(this)}},F.Va=function(t){this.a&&(this.responseText=t,Mr(this))},F.Ua=function(){this.a&&Mr(this)},F.ca=function(){this.a&&Mr(this)},F.setRequestHeader=function(t,e){this.l.append(t,e)},F.getResponseHeader=function(t){return this.b&&this.b.get(t.toLowerCase())||""},F.getAllResponseHeaders=function(){if(!this.b)return"";for(var t=[],e=this.b.entries(),n=e.next();!n.done;)t.push((n=n.value)[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Ur.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(t){this.h=t?"include":"same-origin"}}),Nr.prototype.createWebChannel=Nr.prototype.a,jr.prototype.send=jr.prototype.l,jr.prototype.open=jr.prototype.h,jr.prototype.close=jr.prototype.close,Me.NO_ERROR=0,Me.TIMEOUT=8,Me.HTTP_ERROR=6,Fe.COMPLETE="complete",Be.EventType=Qe,Qe.OPEN="a",Qe.CLOSE="b",Qe.ERROR="c",Qe.MESSAGE="d",oe.prototype.listen=oe.prototype.wa,Yn.prototype.listenOnce=Yn.prototype.xa,Yn.prototype.getLastError=Yn.prototype.Ra,Yn.prototype.getLastErrorCode=Yn.prototype.va,Yn.prototype.getStatus=Yn.prototype.W,Yn.prototype.getResponseJson=Yn.prototype.Qa,Yn.prototype.getResponseText=Yn.prototype.$,Yn.prototype.send=Yn.prototype.ba;var qr=Me,Br=Fe,Kr=Ne,Qr=Vr,Gr=Be,zr=Yn,Hr=n("mrSG"),Wr=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();Wr.o=-1;var Xr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Yr=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(Hr.c)(e,t),e}(Error),Jr=new P.b("@firebase/firestore");function $r(){return Jr.logLevel}function Zr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Jr.logLevel<=P.a.DEBUG){var r=e.map(ni);Jr.debug.apply(Jr,Object(Hr.f)(["Firestore (8.6.8): "+t],r))}}function ti(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Jr.logLevel<=P.a.ERROR){var r=e.map(ni);Jr.error.apply(Jr,Object(Hr.f)(["Firestore (8.6.8): "+t],r))}}function ei(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Jr.logLevel<=P.a.WARN){var r=e.map(ni);Jr.warn.apply(Jr,Object(Hr.f)(["Firestore (8.6.8): "+t],r))}}function ni(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(np){return t}}function ri(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.6.8) INTERNAL ASSERTION FAILED: "+t;throw ti(e),new Error(e)}function ii(t,e){t||ri()}function oi(t,e){return t}function si(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var ai=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=si(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function ui(t,e){return t<e?-1:t>e?1:0}function ci(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function hi(t){return t+"\0"}var li=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Yr(Xr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Yr(Xr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Yr(Xr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Yr(Xr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?ui(this.nanoseconds,t.nanoseconds):ui(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),fi=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new li(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();function di(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function pi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function mi(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var gi=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&ri(),void 0===n?n=t.length-e:n>t.length-e&&ri(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return this.construct(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),yi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Hr.c)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter(function(t){return t.length>0}))}return new e(r)},e.emptyPath=function(){return new e([])},e}(gi),vi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,bi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Hr.c)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return vi.test(t)},e.prototype.canonicalString=function(){return this.toArray().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new Yr(Xr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Yr(Xr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new Yr(Xr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(gi),wi=function(){function t(t){this.fields=t,t.sort(bi.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return ci(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),Ii=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.binaryString)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return ui(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();Ii.EMPTY_BYTE_STRING=new Ii("");var Ti=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function _i(t){if(ii(!!t),"string"==typeof t){var e=0,n=Ti.exec(t);if(ii(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Ei(t.seconds),nanos:Ei(t.nanos)}}function Ei(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Oi(t){return"string"==typeof t?Ii.fromBase64String(t):Ii.fromUint8Array(t)}function Si(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Ai(t){var e=t.mapValue.fields.__previous_value__;return Si(e)?Ai(e):e}function ki(t){var e=_i(t.mapValue.fields.__local_write_time__.timestampValue);return new li(e.seconds,e.nanos)}function Di(t){return null==t}function Ni(t){return 0===t&&1/t==-1/0}function ji(t){return"number"==typeof t&&Number.isInteger(t)&&!Ni(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var xi=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(yi.fromString(e))},t.fromName=function(e){return new t(yi.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===yi.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return yi.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new yi(e.slice()))},t}();function Ci(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Si(t)?4:10:ri()}function Ri(t,e){var n=Ci(t);if(n!==Ci(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ki(t).isEqual(ki(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=_i(t.timestampValue),r=_i(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Oi(t.bytesValue).isEqual(Oi(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Ei(t.geoPointValue.latitude)===Ei(e.geoPointValue.latitude)&&Ei(t.geoPointValue.longitude)===Ei(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Ei(t.integerValue)===Ei(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Ei(t.doubleValue),r=Ei(e.doubleValue);return n===r?Ni(n)===Ni(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return ci(t.arrayValue.values||[],e.arrayValue.values||[],Ri);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(di(n)!==di(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Ri(n[i],r[i])))return!1;return!0}(t,e);default:return ri()}}function Vi(t,e){return void 0!==(t.values||[]).find(function(t){return Ri(t,e)})}function Ui(t,e){var n=Ci(t),r=Ci(e);if(n!==r)return ui(n,r);switch(n){case 0:return 0;case 1:return ui(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=Ei(t.integerValue||t.doubleValue),r=Ei(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Pi(t.timestampValue,e.timestampValue);case 4:return Pi(ki(t),ki(e));case 5:return ui(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Oi(t),r=Oi(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=ui(n[i],r[i]);if(0!==o)return o}return ui(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=ui(Ei(t.latitude),Ei(e.latitude));return 0!==n?n:ui(Ei(t.longitude),Ei(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Ui(n[i],r[i]);if(o)return o}return ui(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=ui(r[s],o[s]);if(0!==a)return a;var u=Ui(n[r[s]],i[o[s]]);if(0!==u)return u}return ui(r.length,o.length)}(t.mapValue,e.mapValue);default:throw ri()}}function Pi(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return ui(t,e);var n=_i(t),r=_i(e),i=ui(n.seconds,r.seconds);return 0!==i?i:ui(n.nanos,r.nanos)}function Li(t){return Mi(t)}function Mi(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=_i(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Oi(t.bytesValue).toBase64():"referenceValue"in t?xi.fromName(t.referenceValue).toString():"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=Mi(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+Mi(t.fields[o])}return e+"}"}(t.mapValue):ri();var e}function Fi(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function qi(t){return!!t&&"integerValue"in t}function Bi(t){return!!t&&"arrayValue"in t}function Ki(t){return!!t&&"nullValue"in t}function Qi(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Gi(t){return!!t&&"mapValue"in t}function zi(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue)return{timestampValue:Object.assign({},_i(t.timestampValue))};if(t.mapValue){var e={mapValue:{fields:{}}};return pi(t.mapValue.fields,function(t,n){return e.mapValue.fields[t]=zi(n)}),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=zi(t.arrayValue.values[r]);return n}return Object.assign({},t)}var Hi=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!Gi(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=zi(e)},t.prototype.setAll=function(t){var e=this,n=bi.emptyPath(),r={},i=[];t.forEach(function(t,o){if(!n.isImmediateParentOf(o)){var s=e.getFieldsMap(n);e.applyChanges(s,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=zi(t):i.push(o.lastSegment())});var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());Gi(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return Ri(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];Gi(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){pi(e,function(e,n){return t[e]=n});for(var r=0,i=n;r<i.length;r++)delete t[i[r]]},t.prototype.clone=function(){return new t(zi(this.value))},t}();function Wi(t){var e=[];return pi(t.fields,function(t,n){var r=new bi([t]);if(Gi(n)){var i=Wi(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)}),new wi(e)}var Xi=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,fi.min(),Hi.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,Hi.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,Hi.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=Hi.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=Hi.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),Yi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};function Ji(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Yi(t,e,n,r,i,o,s)}function $i(t){var e=oi(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return function(t){return t.field.canonicalString()+t.op.toString()+Li(t.value)}(t)}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return function(t){return t.field.canonicalString()+t.dir}(t)}).join(","),Di(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=lo(e.startAt)),e.endAt&&(n+="|ub:",n+=lo(e.endAt)),e.h=n}return e.h}function Zi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!po(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!Ri(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!go(t.startAt,e.startAt)&&go(t.endAt,e.endAt)}function to(t){return xi.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var eo=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(Hr.c)(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new no(t,n,r):"array-contains"===n?new so(t,r):"in"===n?new ao(t,r):"not-in"===n?new uo(t,r):"array-contains-any"===n?new co(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new ro(t,n):new io(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(Ui(e,this.value)):null!==e&&Ci(this.value)===Ci(e)&&this.m(Ui(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return ri()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}(function(){}),no=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=xi.fromName(r.referenceValue),i}return Object(Hr.c)(e,t),e.prototype.matches=function(t){var e=xi.comparator(t.key,this.key);return this.m(e)},e}(eo),ro=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=oo(0,n),r}return Object(Hr.c)(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(eo),io=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=oo(0,n),r}return Object(Hr.c)(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(eo);function oo(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return xi.fromName(t.referenceValue)})}var so=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(Hr.c)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return Bi(e)&&Vi(e.arrayValue,this.value)},e}(eo),ao=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(Hr.c)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&Vi(this.value.arrayValue,e)},e}(eo),uo=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(Hr.c)(e,t),e.prototype.matches=function(t){if(Vi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!Vi(this.value.arrayValue,e)},e}(eo),co=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(Hr.c)(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!Bi(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return Vi(e.value.arrayValue,t)})},e}(eo),ho=function(t,e){this.position=t,this.before=e};function lo(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return Li(t)}).join(",")}var fo=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function po(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function mo(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?xi.comparator(xi.fromName(s.referenceValue),n.key):Ui(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function go(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Ri(t.position[n],e.position[n]))return!1;return!0}var yo=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null};function vo(t,e,n,r,i,o,s,a){return new yo(t,e,n,r,i,o,s,a)}function bo(t){return new yo(t)}function wo(t){return!Di(t.limit)&&"F"===t.limitType}function Io(t){return!Di(t.limit)&&"L"===t.limitType}function To(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function _o(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function Eo(t){return null!==t.collectionGroup}function Oo(t){var e=oi(t);if(null===e.p){e.p=[];var n=_o(e),r=To(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new fo(n)),e.p.push(new fo(bi.keyField(),"asc"));else{for(var i=!1,o=0,s=e.explicitOrderBy;o<s.length;o++){var a=s[o];e.p.push(a),a.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new fo(bi.keyField(),u))}}}return e.p}function So(t){var e=oi(t);if(!e.T)if("F"===e.limitType)e.T=Ji(e.path,e.collectionGroup,Oo(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Oo(e);r<i.length;r++){var o=i[r];n.push(new fo(o.field,"desc"===o.dir?"asc":"desc"))}var s=e.endAt?new ho(e.endAt.position,!e.endAt.before):null,a=e.startAt?new ho(e.startAt.position,!e.startAt.before):null;e.T=Ji(e.path,e.collectionGroup,n,e.filters,e.limit,s,a)}return e.T}function Ao(t,e,n){return new yo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ko(t,e){return Zi(So(t),So(e))&&t.limitType===e.limitType}function Do(t){return $i(So(t))+"|lt:"+t.limitType}function No(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map(function(t){return(e=t).field.canonicalString()+" "+e.op+" "+Li(e.value);var e}).join(", ")+"]"),Di(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map(function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)}).join(", ")+"]"),t.startAt&&(e+=", startAt: "+lo(t.startAt)),t.endAt&&(e+=", endAt: "+lo(t.endAt)),"Target("+e+")"}(So(t))+"; limitType="+t.limitType+")"}function jo(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):xi.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!mo(t.startAt,Oo(t),e)||t.endAt&&mo(t.endAt,Oo(t),e))}(t,e)}function xo(t){return function(e,n){for(var r=!1,i=0,o=Oo(t);i<o.length;i++){var s=o[i],a=Co(s,e,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}function Co(t,e,n){var r=t.field.isKeyField()?xi.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?Ui(r,i):ri()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ri()}}function Ro(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ni(e)?"-0":e}}function Vo(t){return{integerValue:""+t}}function Uo(t,e){return ji(e)?Vo(e):Ro(t,e)}var Po=function(){this._=void 0};function Lo(t,e,n){return t instanceof qo?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Bo?Ko(t,e):t instanceof Qo?Go(t,e):function(t,e){var n=Fo(t,e),r=Ho(n)+Ho(t.A);return qi(n)&&qi(t.A)?Vo(r):Ro(t.R,r)}(t,e)}function Mo(t,e,n){return t instanceof Bo?Ko(t,e):t instanceof Qo?Go(t,e):n}function Fo(t,e){return t instanceof zo?qi(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var qo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Hr.c)(e,t),e}(Po),Bo=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(Hr.c)(e,t),e}(Po);function Ko(t,e){for(var n=Wo(e),r=function(t){n.some(function(e){return Ri(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Qo=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(Hr.c)(e,t),e}(Po);function Go(t,e){for(var n=Wo(e),r=function(t){n=n.filter(function(e){return!Ri(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var zo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return Object(Hr.c)(e,t),e}(Po);function Ho(t){return Ei(t.integerValue||t.doubleValue)}function Wo(t){return Bi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Xo=function(t,e){this.field=t,this.transform=e},Yo=function(t,e){this.version=t,this.transformResults=e},Jo=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function $o(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var Zo=function(){};function ts(t,e,n){t instanceof os?function(t,e,n){var r=t.value.clone(),i=us(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof ss?function(t,e,n){if($o(t.precondition,e)){var r=us(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(as(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function es(t,e,n){t instanceof os?function(t,e,n){if($o(t.precondition,e)){var r=t.value.clone(),i=cs(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(is(e),r).setHasLocalMutations()}}(t,e,n):t instanceof ss?function(t,e,n){if($o(t.precondition,e)){var r=cs(t.fieldTransforms,n,e),i=e.data;i.setAll(as(t)),i.setAll(r),e.convertToFoundDocument(is(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){$o(t.precondition,e)&&e.convertToNoDocument(fi.min())}(t,e)}function ns(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),a=Fo(o.transform,s||null);null!=a&&(null==n&&(n=Hi.empty()),n.set(o.field,a))}return n||null}function rs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&ci(t,e,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Bo&&e instanceof Bo||t instanceof Qo&&e instanceof Qo?ci(t.elements,e.elements,Ri):t instanceof zo&&e instanceof zo?Ri(t.A,e.A):t instanceof qo&&e instanceof qo}(t.transform,e.transform)}(t,e)})}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function is(t){return t.isFoundDocument()?t.version:fi.min()}var os=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return Object(Hr.c)(e,t),e}(Zo),ss=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return Object(Hr.c)(e,t),e}(Zo);function as(t){var e=new Map;return t.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}}),e}function us(t,e,n){var r=new Map;ii(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,Mo(s,a,n[i]))}return r}function cs(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var s=o[i],a=s.transform,u=n.data.field(s.field);r.set(s.field,Lo(a,u,e))}return r}var hs,ls,fs=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return Object(Hr.c)(e,t),e}(Zo),ds=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return Object(Hr.c)(e,t),e}(Zo),ps=function(t){this.count=t};function ms(t){switch(t){case Xr.OK:return ri();case Xr.CANCELLED:case Xr.UNKNOWN:case Xr.DEADLINE_EXCEEDED:case Xr.RESOURCE_EXHAUSTED:case Xr.INTERNAL:case Xr.UNAVAILABLE:case Xr.UNAUTHENTICATED:return!1;case Xr.INVALID_ARGUMENT:case Xr.NOT_FOUND:case Xr.ALREADY_EXISTS:case Xr.PERMISSION_DENIED:case Xr.FAILED_PRECONDITION:case Xr.ABORTED:case Xr.OUT_OF_RANGE:case Xr.UNIMPLEMENTED:case Xr.DATA_LOSS:return!0;default:return ri()}}function gs(t){if(void 0===t)return ti("GRPC error has no .code"),Xr.UNKNOWN;switch(t){case hs.OK:return Xr.OK;case hs.CANCELLED:return Xr.CANCELLED;case hs.UNKNOWN:return Xr.UNKNOWN;case hs.DEADLINE_EXCEEDED:return Xr.DEADLINE_EXCEEDED;case hs.RESOURCE_EXHAUSTED:return Xr.RESOURCE_EXHAUSTED;case hs.INTERNAL:return Xr.INTERNAL;case hs.UNAVAILABLE:return Xr.UNAVAILABLE;case hs.UNAUTHENTICATED:return Xr.UNAUTHENTICATED;case hs.INVALID_ARGUMENT:return Xr.INVALID_ARGUMENT;case hs.NOT_FOUND:return Xr.NOT_FOUND;case hs.ALREADY_EXISTS:return Xr.ALREADY_EXISTS;case hs.PERMISSION_DENIED:return Xr.PERMISSION_DENIED;case hs.FAILED_PRECONDITION:return Xr.FAILED_PRECONDITION;case hs.ABORTED:return Xr.ABORTED;case hs.OUT_OF_RANGE:return Xr.OUT_OF_RANGE;case hs.UNIMPLEMENTED:return Xr.UNIMPLEMENTED;case hs.DATA_LOSS:return Xr.DATA_LOSS;default:return ri()}}(ls=hs||(hs={}))[ls.OK=0]="OK",ls[ls.CANCELLED=1]="CANCELLED",ls[ls.UNKNOWN=2]="UNKNOWN",ls[ls.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ls[ls.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ls[ls.NOT_FOUND=5]="NOT_FOUND",ls[ls.ALREADY_EXISTS=6]="ALREADY_EXISTS",ls[ls.PERMISSION_DENIED=7]="PERMISSION_DENIED",ls[ls.UNAUTHENTICATED=16]="UNAUTHENTICATED",ls[ls.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ls[ls.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ls[ls.ABORTED=10]="ABORTED",ls[ls.OUT_OF_RANGE=11]="OUT_OF_RANGE",ls[ls.UNIMPLEMENTED=12]="UNIMPLEMENTED",ls[ls.INTERNAL=13]="INTERNAL",ls[ls.UNAVAILABLE=14]="UNAVAILABLE",ls[ls.DATA_LOSS=15]="DATA_LOSS";var ys=function(){function t(t,e){this.comparator=t,this.root=e||bs.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,bs.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,bs.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.inorderTraversal(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new vs(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new vs(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new vs(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new vs(this.root,t,this.comparator,!0)},t}(),vs=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),bs=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw ri();if(this.right.isRed())throw ri();var t=this.left.check();if(t!==this.right.check())throw ri();return t+(this.isRed()?0:1)},t}();bs.EMPTY=null,bs.RED=!0,bs.BLACK=!1,bs.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw ri()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw ri()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw ri()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw ri()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw ri()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new bs(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());var ws=function(){function t(t){this.comparator=t,this.data=new ys(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new Is(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new Is(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),Is=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),Ts=new ys(xi.comparator);function _s(){return Ts}var Es=new ys(xi.comparator);function Os(){return Es}var Ss=new ys(xi.comparator);function As(){return Ss}var ks=new ws(xi.comparator);function Ds(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=ks,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Ns=new ws(ui);function js(){return Ns}var xs=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,Cs.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(fi.min(),r,js(),_s(),Ds())},t}(),Cs=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(Ii.EMPTY_BYTE_STRING,n,Ds(),Ds(),Ds())},t}(),Rs=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},Vs=function(t,e){this.targetId=t,this.V=e},Us=function(t,e,n,r){void 0===n&&(n=Ii.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Ps=function(){function t(){this.S=0,this.D=Fs(),this.C=Ii.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.F},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.F=!0,this.C=t)},t.prototype.M=function(){var t=Ds(),e=Ds(),n=Ds();return this.D.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:ri()}}),new Cs(this.C,this.N,t,e,n)},t.prototype.L=function(){this.F=!1,this.D=Fs()},t.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.F=!0,this.N=!0},t}(),Ls=function(){function t(t){this.W=t,this.G=new Map,this.H=_s(),this.J=Ms(),this.Y=new ws(ui)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.tt(r=o[i],t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.k||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.k||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:ri()}})},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach(function(t,r){n.st(r)&&e(r)})},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(to(i))if(0===n){var o=new xi(i.path);this.tt(e,o,Xi.newNoDocument(o,fi.min()))}else ii(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach(function(r,i){var o=e.ot(i);if(o){if(r.current&&to(o.target)){var s=new xi(o.target.path);null!==e.H.get(s)||e.at(i,s)||e.tt(i,s,Xi.newNoDocument(s,t))}r.$&&(n.set(i,r.M()),r.L())}});var r=Ds();this.J.forEach(function(t,n){var i=!0;n.forEachWhile(function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)}),i&&(r=r.add(t))});var i=new xs(t,n,this.Y,this.H,r);return this.H=_s(),this.J=Ms(),this.Y=new ws(ui),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new Ps,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new ws(ui),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||Zr("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new Ps),this.W.getRemoteKeysForTarget(t).forEach(function(n){e.tt(t,n,null)})},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function Ms(){return new ys(xi.comparator)}function Fs(){return new ys(xi.comparator)}var qs={asc:"ASCENDING",desc:"DESCENDING"},Bs={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ks=function(t,e){this.databaseId=t,this.I=e};function Qs(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Gs(t,e){return t.I?e.toBase64():e.toUint8Array()}function zs(t,e){return Qs(t,e.toTimestamp())}function Hs(t){return ii(!!t),fi.fromTimestamp(function(t){var e=_i(t);return new li(e.seconds,e.nanos)}(t))}function Ws(t,e){return function(t){return new yi(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Xs(t){var e=yi.fromString(t);return ii(ba(e)),e}function Ys(t,e){return Ws(t.databaseId,e.path)}function Js(t,e){var n=Xs(e);if(n.get(1)!==t.databaseId.projectId)throw new Yr(Xr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Yr(Xr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new xi(ea(n))}function $s(t,e){return Ws(t.databaseId,e)}function Zs(t){var e=Xs(t);return 4===e.length?yi.emptyPath():ea(e)}function ta(t){return new yi(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function ea(t){return ii(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function na(t,e,n){return{name:Ys(t,e),fields:n.value.mapValue.fields}}function ra(t,e,n){var r=Js(t,e.name),i=Hs(e.updateTime),o=new Hi({mapValue:{fields:e.fields}}),s=Xi.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}function ia(t,e){var n;if(e instanceof os)n={update:na(t,e.key,e.value)};else if(e instanceof fs)n={delete:Ys(t,e.key)};else if(e instanceof ss)n={update:na(t,e.key,e.data),updateMask:va(e.fieldMask)};else{if(!(e instanceof ds))return ri();n={verify:Ys(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof qo)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Bo)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Qo)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof zo)return{fieldPath:e.field.canonicalString(),increment:n.A};throw ri()}(0,t)})),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:zs(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:ri()}(t,e.precondition)),n}function oa(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Jo.updateTime(Hs(t.updateTime)):void 0!==t.exists?Jo.exists(t.exists):Jo.none()}(e.currentDocument):Jo.none(),r=e.updateTransforms?e.updateTransforms.map(function(e){return function(t,e){var n=null;"setToServerValue"in e?(ii("REQUEST_TIME"===e.setToServerValue),n=new qo):"appendMissingElements"in e?n=new Bo(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new Qo(e.removeAllFromArray.values||[]):"increment"in e?n=new zo(t,e.increment):ri();var r=bi.fromServerFormat(e.fieldPath);return new Xo(r,n)}(t,e)}):[];if(e.update){var i=Js(t,e.update.name),o=new Hi({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){return new wi((t.fieldPaths||[]).map(function(t){return bi.fromServerFormat(t)}))}(e.updateMask);return new ss(i,o,s,n,r)}return new os(i,o,n,r)}if(e.delete){var a=Js(t,e.delete);return new fs(a,n)}if(e.verify){var u=Js(t,e.verify);return new ds(u,n)}return ri()}function sa(t,e){return{documents:[$s(t,e.path)]}}function aa(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=$s(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=$s(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(Qi(t.value))return{unaryFilter:{field:pa(t.field),op:"IS_NAN"}};if(Ki(t.value))return{unaryFilter:{field:pa(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Qi(t.value))return{unaryFilter:{field:pa(t.field),op:"IS_NOT_NAN"}};if(Ki(t.value))return{unaryFilter:{field:pa(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:pa(t.field),op:da(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:pa(t.field),direction:fa(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.I||Di(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=ha(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ha(e.endAt)),n}function ua(t){var e=Zs(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){ii(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=ca(n.where));var a=[];n.orderBy&&(a=n.orderBy.map(function(t){return function(t){return new fo(ma(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}));var u=null;n.limit&&(u=function(t){var e;return Di(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=la(n.startAt));var h=null;return n.endAt&&(h=la(n.endAt)),vo(e,i,a,s,u,"F",c,h)}function ca(t){return t?void 0!==t.unaryFilter?[ya(t)]:void 0!==t.fieldFilter?[ga(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return ca(t)}).reduce(function(t,e){return t.concat(e)}):ri():[]}function ha(t){return{before:t.before,values:t.position}}function la(t){return new ho(t.values||[],!!t.before)}function fa(t){return qs[t]}function da(t){return Bs[t]}function pa(t){return{fieldPath:t.canonicalString()}}function ma(t){return bi.fromServerFormat(t.fieldPath)}function ga(t){return eo.create(ma(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return ri()}}(t.fieldFilter.op),t.fieldFilter.value)}function ya(t){switch(t.unaryFilter.op){case"IS_NAN":var e=ma(t.unaryFilter.field);return eo.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=ma(t.unaryFilter.field);return eo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=ma(t.unaryFilter.field);return eo.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=ma(t.unaryFilter.field);return eo.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return ri()}}function va(t){var e=[];return t.fields.forEach(function(t){return e.push(t.canonicalString())}),{fieldPaths:e}}function ba(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function wa(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Ta(e)),e=Ia(t.get(n),e);return Ta(e)}function Ia(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function Ta(t){return t+"\x01\x01"}function _a(t){var e=t.length;if(ii(e>=2),2===e)return ii("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),yi.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&ri(),t.charAt(s+1)){case"\x01":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:ri()}o=s+2}return new yi(r)}var Ea=function(t,e){this.seconds=t,this.nanoseconds=e},Oa=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Oa.store="owner",Oa.key="owner";var Sa=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Sa.store="mutationQueues",Sa.keyPath="userId";var Aa=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Aa.store="mutations",Aa.keyPath="batchId",Aa.userMutationsIndex="userMutationsIndex",Aa.userMutationsKeyPath=["userId","batchId"];var ka=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,wa(e)]},t.key=function(t,e,n){return[t,wa(e),n]},t}();ka.store="documentMutations",ka.PLACEHOLDER=new ka;var Da=function(t,e){this.path=t,this.readTime=e},Na=function(t,e){this.path=t,this.version=e},ja=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};ja.store="remoteDocuments",ja.readTimeIndex="readTimeIndex",ja.readTimeIndexPath="readTime",ja.collectionReadTimeIndex="collectionReadTimeIndex",ja.collectionReadTimeIndexPath=["parentPath","readTime"];var xa=function(t){this.byteSize=t};xa.store="remoteDocumentGlobal",xa.key="remoteDocumentGlobalKey";var Ca=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Ca.store="targets",Ca.keyPath="targetId",Ca.queryTargetsIndexName="queryTargetsIndex",Ca.queryTargetsKeyPath=["canonicalId","targetId"];var Ra=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Ra.store="targetDocuments",Ra.keyPath=["targetId","path"],Ra.documentTargetsIndex="documentTargetsIndex",Ra.documentTargetsKeyPath=["path","targetId"];var Va=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Va.key="targetGlobalKey",Va.store="targetGlobal";var Ua=function(t,e){this.collectionId=t,this.parent=e};Ua.store="collectionParents",Ua.keyPath=["collectionId","parent"];var Pa=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Pa.store="clientMetadata",Pa.keyPath="clientId";var La=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};La.store="bundles",La.keyPath="bundleId";var Ma=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Ma.store="namedQueries",Ma.keyPath="name";var Fa=Object(Hr.f)(Object(Hr.f)([],Object(Hr.f)(Object(Hr.f)([],Object(Hr.f)(Object(Hr.f)([],Object(Hr.f)(Object(Hr.f)([],[Sa.store,Aa.store,ka.store,ja.store,Ca.store,Oa.store,Va.store,Ra.store]),[Pa.store])),[xa.store])),[Ua.store])),[La.store,Ma.store]),qa="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ba=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach(function(t){return t()})},t}(),Ka=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},Qa=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)},function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&ri(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t(function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}})},t.prototype.toPromise=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.waitFor=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.waitFor(r)},t}(),Ga=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new Ka,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new Wa(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=Za(e.target.error);n.ft.reject(new Wa(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Wa(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(Zr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Ya(e)},t}(),za=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t(Object(U.i)())&&ti("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Zr("SimpleDb","Removing database:",t),Ja(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=Object(U.i)(),n=t._t(e),r=0<n&&n<10,i=t.Et(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return Object(Hr.b)(this,void 0,void 0,function(){var e,n=this;return Object(Hr.d)(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(Zr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new Wa(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new Yr(Xr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new Wa(t,n))},i.onupgradeneeded=function(t){Zr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.wt.Rt(t.target.result,i.transaction,t.oldVersion,n.version).next(function(){Zr("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}})})},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Object(Hr.b)(this,void 0,void 0,function(){var i,o,s,a,u;return Object(Hr.d)(this,function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,u,c,h;return Object(Hr.d)(this,function(l){switch(l.label){case 0:++o,l.label=1;case 1:return l.trys.push([1,4,,5]),[4,a.At(t)];case 2:return a.db=l.sent(),e=Ga.open(a.db,t,i?"readonly":"readwrite",n),s=r(e).catch(function(t){return e.abort(t),Qa.reject(t)}).toPromise(),u={},s.catch(function(){}),[4,e.dt];case 3:return[2,(u.value=(l.sent(),s),u)];case 4:return Zr("SimpleDb","Transaction failed with error:",(c=l.sent()).message,"Retrying:",h="FirebaseError"!==c.name&&o<3),a.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}})},a=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Ha=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return Ja(this.Pt.delete())},t}(),Wa=function(t){function e(e,n){var r=this;return(r=t.call(this,Xr.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(Hr.c)(e,t),e}(Yr);function Xa(t){return"IndexedDbTransactionError"===t.name}var Ya=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Zr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Zr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Ja(n)},t.prototype.add=function(t){return Zr("SimpleDb","ADD",this.store.name,t,t),Ja(this.store.add(t))},t.prototype.get=function(t){var e=this;return Ja(this.store.get(t)).next(function(n){return void 0===n&&(n=null),Zr("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return Zr("SimpleDb","DELETE",this.store.name,t),Ja(this.store.delete(t))},t.prototype.count=function(){return Zr("SimpleDb","COUNT",this.store.name),Ja(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.Ft=function(t,e){Zr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.kt=!1;var r=this.cursor(n);return this.xt(r,function(t,e,n){return n.delete()})},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new Qa(function(n,r){e.onerror=function(t){var e=Za(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.xt=function(t,e){var n=[];return new Qa(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Ha(i),s=e(i.primaryKey,i.value,o);if(s instanceof Qa){var a=s.catch(function(t){return o.done(),Qa.reject(t)});n.push(a)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}}).next(function(){return Qa.waitFor(n)})},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.kt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Ja(t){return new Qa(function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=Za(t.target.error);n(e)}})}var $a=!1;function Za(t){var e=za._t(Object(U.i)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Yr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return $a||($a=!0,setTimeout(function(){throw r},0)),r}}return t}var tu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return Object(Hr.c)(e,t),e}(Ba);function eu(t,e){var n=oi(t);return za.It(n.Mt,e)}var nu=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&ts(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&es(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&es(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach(function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(fi.min())})},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Ds())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&ci(this.mutations,t.mutations,function(t,e){return rs(t,e)})&&ci(this.baseMutations,t.baseMutations,function(t,e){return rs(t,e)})},t}(),ru=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){ii(e.mutations.length===r.length);for(var i=As(),o=e.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),iu=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=fi.min()),void 0===o&&(o=fi.min()),void 0===s&&(s=Ii.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),ou=function(t){this.Lt=t};function su(t,e){if(e.document)return ra(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=xi.fromSegments(e.noDocument.path),r=lu(e.noDocument.readTime),i=Xi.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=xi.fromSegments(e.unknownDocument.path);return r=lu(e.unknownDocument.version),Xi.newUnknownDocument(o,r)}return ri()}function au(t,e,n){var r=uu(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:Ys(t,e.key),fields:e.data.value.mapValue.fields,updateTime:Qs(t,e.version.toTimestamp())}}(t.Lt,e),s=e.hasCommittedMutations;return new ja(null,null,o,s,r,i)}if(e.isNoDocument()){var a=e.key.path.toArray(),u=hu(e.version);return s=e.hasCommittedMutations,new ja(null,new Da(a,u),null,s,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),h=hu(e.version);return new ja(new Na(c,h),null,null,!0,r,i)}return ri()}function uu(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function cu(t){var e=new li(t[0],t[1]);return fi.fromTimestamp(e)}function hu(t){var e=t.toTimestamp();return new Ea(e.seconds,e.nanoseconds)}function lu(t){var e=new li(t.seconds,t.nanoseconds);return fi.fromTimestamp(e)}function fu(t,e){for(var n=(e.baseMutations||[]).map(function(e){return oa(t.Lt,e)}),r=0;r<e.mutations.length-1;++r)r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform&&(e.mutations[r].updateTransforms=e.mutations[r+1].transform.fieldTransforms,e.mutations.splice(r+1,1),++r);var i=e.mutations.map(function(e){return oa(t.Lt,e)}),o=li.fromMillis(e.localWriteTimeMs);return new nu(e.batchId,o,n,i)}function du(t){var e,n,r=lu(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?lu(t.lastLimboFreeSnapshotVersion):fi.min();return void 0!==t.query.documents?(ii(1===(n=t.query).documents.length),e=So(bo(Zs(n.documents[0])))):e=function(t){return So(ua(t))}(t.query),new iu(e,t.targetId,0,t.lastListenSequenceNumber,r,i,Ii.fromBase64String(t.resumeToken))}function pu(t,e){var n,r=hu(e.snapshotVersion),i=hu(e.lastLimboFreeSnapshotVersion);n=to(e.target)?sa(t.Lt,e.target):aa(t.Lt,e.target);var o=e.resumeToken.toBase64();return new Ca(e.targetId,$i(e.target),r,o,e.sequenceNumber,i,n)}function mu(t){var e=ua({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Ao(e,e.limit,"L"):e}var gu=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return yu(t).get(e).next(function(t){if(t)return{id:(e=t).bundleId,createTime:lu(e.createTime),version:e.version};var e})},t.prototype.saveBundleMetadata=function(t,e){return yu(t).put({bundleId:(n=e).id,createTime:hu(Hs(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return vu(t).get(e).next(function(t){if(t)return{name:(e=t).name,query:mu(e.bundledQuery),readTime:lu(e.readTime)};var e})},t.prototype.saveNamedQuery=function(t,e){return vu(t).put(function(t){return{name:t.name,readTime:hu(Hs(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function yu(t){return eu(t,La.store)}function vu(t){return eu(t,Ma.store)}var bu=function(){function t(){this.Bt=new wu}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),Qa.resolve()},t.prototype.getCollectionParents=function(t,e){return Qa.resolve(this.Bt.getEntries(e))},t}(),wu=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new ws(yi.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new ws(yi.comparator)).toArray()},t}(),Iu=function(){function t(){this.qt=new wu}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener(function(){n.qt.add(e)});var o={collectionId:r,parent:wa(i)};return Tu(t).put(o)}return Qa.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[hi(e),""],!1,!0);return Tu(t).Nt(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(_a(o.parent))}return n})},t}();function Tu(t){return eu(t,Ua.store)}var _u={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Eu=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();function Ou(t,e,n){var r=t.store(Aa.store),i=t.store(ka.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.$t({range:s},function(t,e,n){return a++,n.delete()});o.push(u.next(function(){ii(1===a)}));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],d=ka.key(e,f.key.path,n.batchId);o.push(i.delete(d)),c.push(f.key)}return Qa.waitFor(o).next(function(){return c})}function Su(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw ri();e=t.noDocument}return JSON.stringify(e).length}Eu.DEFAULT_COLLECTION_PERCENTILE=10,Eu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Eu.DEFAULT=new Eu(41943040,Eu.DEFAULT_COLLECTION_PERCENTILE,Eu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Eu.DISABLED=new Eu(-1,0,0);var Au=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Qt={}}return t.Kt=function(e,n,r,i){return ii(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Du(t).$t({index:Aa.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=Nu(t),s=Du(t);return s.add({}).next(function(a){ii("number"==typeof a);for(var u=new nu(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return ia(t.Lt,e)}),i=n.mutations.map(function(e){return ia(t.Lt,e)});return new Aa(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),h=[],l=new ws(function(t,e){return ui(t.canonicalString(),e.canonicalString())}),f=0,d=r;f<d.length;f++){var p=d[f],m=ka.key(i.userId,p.key.path,a);l=l.add(p.key.path.popLast()),h.push(s.put(c)),h.push(o.put(m,ka.PLACEHOLDER))}return l.forEach(function(e){h.push(i.Ut.addToCollectionParentIndex(t,e))}),t.addOnCommittedListener(function(){i.Qt[a]=u.keys()}),Qa.waitFor(h).next(function(){return u})})},t.prototype.lookupMutationBatch=function(t,e){var n=this;return Du(t).get(e).next(function(t){return t?(ii(t.userId===n.userId),fu(n.R,t)):null})},t.prototype.jt=function(t,e){var n=this;return this.Qt[e]?Qa.resolve(this.Qt[e]):this.lookupMutationBatch(t,e).next(function(t){if(t){var r=t.keys();return n.Qt[e]=r,r}return null})},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Du(t).$t({index:Aa.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(ii(e.batchId>=r),o=fu(n.R,e)),i.done()}).next(function(){return o})},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Du(t).$t({index:Aa.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Du(t).Nt(Aa.userMutationsIndex,n).next(function(t){return t.map(function(t){return fu(e.R,t)})})},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=ka.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Nu(t).$t({range:i},function(r,i,s){var a=r[0],u=r[2],c=_a(r[1]);if(a===n.userId&&e.path.isEqual(c))return Du(t).get(u).next(function(t){if(!t)throw ri();ii(t.userId===n.userId),o.push(fu(n.R,t))});s.done()}).next(function(){return o})},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new ws(ui),i=[];return e.forEach(function(e){var o=ka.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=Nu(t).$t({range:s},function(t,i,o){var s=t[0],a=t[2],u=_a(t[1]);s===n.userId&&e.path.isEqual(u)?r=r.add(a):o.done()});i.push(a)}),Qa.waitFor(i).next(function(){return n.Wt(t,r)})},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=ka.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new ws(ui);return Nu(t).$t({range:s},function(t,e,o){var s=t[0],u=t[2],c=_a(t[1]);s===n.userId&&r.isPrefixOf(c)?c.length===i&&(a=a.add(u)):o.done()}).next(function(){return n.Wt(t,a)})},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(Du(t).get(e).next(function(t){if(null===t)throw ri();ii(t.userId===n.userId),r.push(fu(n.R,t))}))}),Qa.waitFor(i).next(function(){return r})},t.prototype.removeMutationBatch=function(t,e){var n=this;return Ou(t.Mt,this.userId,e).next(function(r){return t.addOnCommittedListener(function(){n.Gt(e.batchId)}),Qa.forEach(r,function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)})})},t.prototype.Gt=function(t){delete this.Qt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next(function(n){if(!n)return Qa.resolve();var r=IDBKeyRange.lowerBound(ka.prefixForUser(e.userId)),i=[];return Nu(t).$t({range:r},function(t,n,r){if(t[0]===e.userId){var o=_a(t[1]);i.push(o)}else r.done()}).next(function(){ii(0===i.length)})})},t.prototype.containsKey=function(t,e){return ku(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return ju(t).get(this.userId).next(function(t){return t||new Sa(e.userId,-1,"")})},t}();function ku(t,e,n){var r=ka.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Nu(t).$t({range:o,kt:!0},function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()}).next(function(){return s})}function Du(t){return eu(t,Aa.store)}function Nu(t){return eu(t,ka.store)}function ju(t){return eu(t,Sa.store)}var xu=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),Cu=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next(function(n){var r=new xu(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next(function(){return n.highestTargetId})})},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next(function(t){return fi.fromTimestamp(new li(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)})},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next(function(){return n.Xt(t).next(function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)})})},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next(function(){return Ru(t).delete(e.targetId)}).next(function(){return n.Xt(t)}).next(function(e){return ii(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)})},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return Ru(t).$t(function(s,a){var u=du(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))}).next(function(){return Qa.waitFor(o)}).next(function(){return i})},t.prototype.forEachTarget=function(t,e){return Ru(t).$t(function(t,n){var r=du(n);e(r)})},t.prototype.Xt=function(t){return Vu(t).get(Va.key).next(function(t){return ii(null!==t),t})},t.prototype.Zt=function(t,e){return Vu(t).put(Va.key,e)},t.prototype.te=function(t,e){return Ru(t).put(pu(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next(function(t){return t.targetCount})},t.prototype.getTargetData=function(t,e){var n=$i(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Ru(t).$t({range:r,index:Ca.queryTargetsIndexName},function(t,n,r){var o=du(n);Zi(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=Uu(t);return e.forEach(function(e){var s=wa(e.path);i.push(o.put(new Ra(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))}),Qa.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=Uu(t);return Qa.forEach(e,function(e){var o=wa(e.path);return Qa.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])})},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=Uu(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Uu(t),i=Ds();return r.$t({range:n,kt:!0},function(t,e,n){var r=_a(t[1]),o=new xi(r);i=i.add(o)}).next(function(){return i})},t.prototype.containsKey=function(t,e){var n=wa(e.path),r=IDBKeyRange.bound([n],[hi(n)],!1,!0),i=0;return Uu(t).$t({index:Ra.documentTargetsIndex,kt:!0,range:r},function(t,e,n){0!==t[0]&&(i++,n.done())}).next(function(){return i>0})},t.prototype.lt=function(t,e){return Ru(t).get(e).next(function(t){return t?du(t):null})},t}();function Ru(t){return eu(t,Ca.store)}function Vu(t){return eu(t,Va.store)}function Uu(t){return eu(t,Ra.store)}function Pu(t){return Object(Hr.b)(this,void 0,void 0,function(){return Object(Hr.d)(this,function(e){if(t.code!==Xr.FAILED_PRECONDITION||t.message!==qa)throw t;return Zr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Lu(t,e){var n=t[1],r=e[1],i=ui(t[0],e[0]);return 0===i?ui(n,r):i}var Mu=function(){function t(t){this.ne=t,this.buffer=new ws(Lu),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Lu(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Fu=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;Zr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,function(){return Object(Hr.b)(e,void 0,void 0,function(){var e;return Object(Hr.d)(this,function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return Xa(e=n.sent())?(Zr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Pu(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}})})})},t}(),qu=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return Qa.resolve(Wr.o);var r=new Mu(e);return this.ae.forEachTarget(t,function(t){return r.re(t.sequenceNumber)}).next(function(){return n.ae.le(t,function(t){return r.re(t)})}).next(function(){return r.maxValue})},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(Zr("LruGarbageCollector","Garbage collection skipped; disabled"),Qa.resolve(_u)):this.getCacheSize(t).next(function(r){return r<n.params.cacheSizeCollectionThreshold?(Zr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),_u):n.fe(t,e)})},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,s,a,u,c=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(function(e){return e>c.params.maximumSequenceNumbersToCollect?(Zr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)}).next(function(r){return n=r,s=Date.now(),c.removeTargets(t,n,e)}).next(function(e){return i=e,a=Date.now(),c.removeOrphanedDocuments(t,n)}).next(function(t){return u=Date.now(),$r()<=P.a.DEBUG&&Zr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-h)+"ms"),Qa.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})})},t}(),Bu=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new qu(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.de=function(t){var e=0;return this.le(t,function(t){e++}).next(function(){return e})},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,function(t,n){return e(n)})},t.prototype.addReference=function(t,e,n){return Ku(t,n)},t.prototype.removeReference=function(t,e,n){return Ku(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return Ku(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return ju(t).Ot(function(r){return ku(t,r,e).next(function(t){return t&&(n=!0),Qa.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,function(s,a){if(a<=e){var u=n._e(t,s).next(function(e){if(!e)return o++,r.getEntry(t,s).next(function(){return r.removeEntry(s),Uu(t).delete([0,wa(s.path)])})});i.push(u)}}).next(function(){return Qa.waitFor(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return Ku(t,e)},t.prototype.we=function(t,e){var n,r=Uu(t),i=Wr.o;return r.$t({index:Ra.documentTargetsIndex},function(t,r){var o=r.path,s=r.sequenceNumber;0===t[0]?(i!==Wr.o&&e(new xi(_a(n)),i),i=s,n=o):i=Wr.o}).next(function(){i!==Wr.o&&e(new xi(_a(n)),i)})},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function Ku(t,e){return Uu(t).put(function(t,e){return new Ra(0,wa(t.path),e)}(e,t.currentSequenceNumber))}var Qu=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(this.equalsFn(o[0],t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){pi(this.inner,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}})},t.prototype.isEmpty=function(){return mi(this.inner)},t}(),Gu=function(){function t(){this.changes=new Qu(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:fi.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:Xi.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?Qa.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),zu=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return Xu(t).put(Yu(e),n)},t.prototype.removeEntry=function(t,e){var n=Xu(t),r=Yu(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.me(t,r)})},t.prototype.getEntry=function(t,e){var n=this;return Xu(t).get(Yu(e)).next(function(t){return n.ye(e,t)})},t.prototype.ge=function(t,e){var n=this;return Xu(t).get(Yu(e)).next(function(t){return{document:n.ye(e,t),size:Su(t)}})},t.prototype.getEntries=function(t,e){var n=this,r=_s();return this.pe(t,e,function(t,e){var i=n.ye(t,e);r=r.insert(t,i)}).next(function(){return r})},t.prototype.Ee=function(t,e){var n=this,r=_s(),i=new ys(xi.comparator);return this.pe(t,e,function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,Su(e))}).next(function(){return{documents:r,Te:i}})},t.prototype.pe=function(t,e,n){if(e.isEmpty())return Qa.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return Xu(t).$t({range:r},function(t,e,r){for(var s=xi.fromSegments(t);o&&xi.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()}).next(function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null})},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=_s(),o=e.path.length+1,s={};if(n.isEqual(fi.min())){var a=e.path.toArray();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.toArray(),c=uu(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=ja.collectionReadTimeIndex}return Xu(t).$t(s,function(t,n,s){if(t.length===o){var a=su(r.R,n);e.path.isPrefixOf(a.key.path)?jo(e,a)&&(i=i.insert(a.key,a)):s.done()}}).next(function(){return i})},t.prototype.newChangeBuffer=function(t){return new Hu(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return Wu(t).get(xa.key).next(function(t){return ii(!!t),t})},t.prototype.me=function(t,e){return Wu(t).put(xa.key,e)},t.prototype.ye=function(t,e){if(e){var n=su(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(fi.min()))return n}return Xi.newInvalidDocument(t)},t}(),Hu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new Qu(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return Object(Hr.c)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new ws(function(t,e){return ui(t.canonicalString(),e.canonicalString())});return this.changes.forEach(function(o,s){var a=e.Ae.get(o);if(s.document.isValidDocument()){var u=au(e.Ie.R,s.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=Su(u);r+=c-a,n.push(e.Ie.addEntry(t,o,u))}else if(r-=a,e.trackRemovals){var h=au(e.Ie.R,Xi.newNoDocument(o,fi.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,h))}else n.push(e.Ie.removeEntry(t,o))}),i.forEach(function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))}),n.push(this.Ie.updateMetadata(t,r)),Qa.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next(function(t){return n.Ae.set(e,t.size),t.document})},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next(function(t){var e=t.documents;return t.Te.forEach(function(t,e){n.Ae.set(t,e)}),e})},e}(Gu);function Wu(t){return eu(t,xa.store)}function Xu(t){return eu(t,ja.store)}function Yu(t){return t.path.toArray()}var Ju=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;ii(n<r&&n>=0&&r<=11);var o=new Ga("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Oa.store)}(t),function(t){t.createObjectStore(Sa.store,{keyPath:Sa.keyPath}),t.createObjectStore(Aa.store,{keyPath:Aa.keyPath,autoIncrement:!0}).createIndex(Aa.userMutationsIndex,Aa.userMutationsKeyPath,{unique:!0}),t.createObjectStore(ka.store)}(t),$u(t),function(t){t.createObjectStore(ja.store)}(t));var s=Qa.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Ra.store),t.deleteObjectStore(Ca.store),t.deleteObjectStore(Va.store)}(t),$u(t)),s=s.next(function(){return function(t){var e=t.store(Va.store),n=new Va(0,0,fi.min().toTimestamp(),0);return e.put(Va.key,n)}(o)})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return function(t,e){return e.store(Aa.store).Nt().next(function(n){t.deleteObjectStore(Aa.store),t.createObjectStore(Aa.store,{keyPath:Aa.keyPath,autoIncrement:!0}).createIndex(Aa.userMutationsIndex,Aa.userMutationsKeyPath,{unique:!0});var r=e.store(Aa.store),i=n.map(function(t){return r.put(t)});return Qa.waitFor(i)})}(t,o)})),s=s.next(function(){!function(t){t.createObjectStore(Pa.store,{keyPath:Pa.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(function(){return i.Re(o)})),n<6&&r>=6&&(s=s.next(function(){return function(t){t.createObjectStore(xa.store)}(t),i.be(o)})),n<7&&r>=7&&(s=s.next(function(){return i.ve(o)})),n<8&&r>=8&&(s=s.next(function(){return i.Pe(t,o)})),n<9&&r>=9&&(s=s.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(ja.store);e.createIndex(ja.readTimeIndex,ja.readTimeIndexPath,{unique:!1}),e.createIndex(ja.collectionReadTimeIndex,ja.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(function(){return i.Ve(o)})),n<11&&r>=11&&(s=s.next(function(){!function(t){t.createObjectStore(La.store,{keyPath:La.keyPath})}(t),function(t){t.createObjectStore(Ma.store,{keyPath:Ma.keyPath})}(t)})),s},t.prototype.be=function(t){var e=0;return t.store(ja.store).$t(function(t,n){e+=Su(n)}).next(function(){var n=new xa(e);return t.store(xa.store).put(xa.key,n)})},t.prototype.Re=function(t){var e=this,n=t.store(Sa.store),r=t.store(Aa.store);return n.Nt().next(function(n){return Qa.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(Aa.userMutationsIndex,i).next(function(r){return Qa.forEach(r,function(r){ii(r.userId===n.userId);var i=fu(e.R,r);return Ou(t,n.userId,i).next(function(){})})})})})},t.prototype.ve=function(t){var e=t.store(Ra.store),n=t.store(ja.store);return t.store(Va.store).get(Va.key).next(function(t){var r=[];return n.$t(function(n,i){var o=new yi(n),s=function(t){return[0,wa(t)]}(o);r.push(e.get(s).next(function(n){return n?Qa.resolve():function(n){return e.put(new Ra(0,wa(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return Qa.waitFor(r)})})},t.prototype.Pe=function(t,e){t.createObjectStore(Ua.store,{keyPath:Ua.keyPath});var n=e.store(Ua.store),r=new wu,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:wa(i)})}};return e.store(ja.store).$t({kt:!0},function(t,e){var n=new yi(t);return i(n.popLast())}).next(function(){return e.store(ka.store).$t({kt:!0},function(t,e){var n=_a(t[1]);return i(n.popLast())})})},t.prototype.Ve=function(t){var e=this,n=t.store(Ca.store);return n.$t(function(t,r){var i=du(r),o=pu(e.R,i);return n.put(o)})},t}();function $u(t){t.createObjectStore(Ra.store,{keyPath:Ra.keyPath}).createIndex(Ra.documentTargetsIndex,Ra.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Ca.store,{keyPath:Ca.keyPath}).createIndex(Ca.queryTargetsIndexName,Ca.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Va.store)}var Zu="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",tc=function(){function t(e,n,r,i,o,s,a,u,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=a,this.De=c,this.Ce=h,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new Yr(Xr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Bu(this,i),this.Le=n+"main",this.R=new ou(u),this.Be=new za(this.Le,11,new Ju(this.R)),this.qe=new Cu(this.referenceDelegate,this.R),this.Ut=new Iu,this.Ue=function(t,e){return new zu(t,e)}(this.R,this.Ut),this.Qe=new gu,this.window&&this.window.localStorage?this.Ke=this.window.localStorage:(this.Ke=null,!1===h&&ti("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Yr(Xr.FAILED_PRECONDITION,Zu);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.qe.getHighestSequenceNumber(e)})}).then(function(e){t.Ne=new Wr(e,t.De)}).then(function(){t.xe=!0}).catch(function(e){return t.Be&&t.Be.close(),Promise.reject(e)})},t.prototype.He=function(t){var e=this;return this.Me=function(n){return Object(Hr.b)(e,void 0,void 0,function(){return Object(Hr.d)(this,function(e){return this.started?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt(function(n){return Object(Hr.b)(e,void 0,void 0,function(){return Object(Hr.d)(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget(function(){return Object(Hr.b)(e,void 0,void 0,function(){return Object(Hr.d)(this,function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return nc(e).put(new Pa(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.Je(e).next(function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable(function(){return t.Me(!1)}))})}).next(function(){return t.Ye(e)}).next(function(n){return t.isPrimary&&!n?t.Xe(e).next(function(){return!1}):!!n&&t.Ze(e).next(function(){return!0})})}).catch(function(e){if(Xa(e))return Zr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Zr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.Se.enqueueRetryable(function(){return t.Me(e)}),t.isPrimary=e})},t.prototype.Je=function(t){var e=this;return ec(t).get(Oa.key).next(function(t){return Qa.resolve(e.tn(t))})},t.prototype.en=function(t){return nc(t).delete(this.clientId)},t.prototype.nn=function(){return Object(Hr.b)(this,void 0,void 0,function(){var t,e,n,r=this;return Object(Hr.d)(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var e=eu(t,Pa.store);return e.Nt().next(function(t){var n=r.rn(t,18e5),i=t.filter(function(t){return-1===n.indexOf(t)});return Qa.forEach(i,function(t){return e.delete(t.clientId)}).next(function(){return i})})}).catch(function(){return[]})]);case 1:if(t=i.sent(),this.Ke)for(e=0,n=t;e<n.length;e++)this.Ke.removeItem(this.on(n[e].clientId));i.label=2;case 2:return[2]}})})},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,function(){return t.je().then(function(){return t.nn()}).then(function(){return t.ze()})})},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?Qa.resolve(!0):ec(t).get(Oa.key).next(function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new Yr(Xr.FAILED_PRECONDITION,Zu);return!1}}return!(!e.networkEnabled||!e.inForeground)||nc(t).Nt().next(function(t){return void 0===e.rn(t,5e3).find(function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))})})}).next(function(t){return e.isPrimary!==t&&Zr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.shutdown=function(){return Object(Hr.b)(this,void 0,void 0,function(){var t=this;return Object(Hr.d)(this,function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[Oa.store,Pa.store],function(e){var n=new tu(e,Wr.o);return t.Xe(n).next(function(){return t.en(n)})})];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}})})},t.prototype.rn=function(t,e){var n=this;return t.filter(function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)})},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return nc(e).Nt().next(function(e){return t.rn(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return Au.Kt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Qe},t.prototype.runTransaction=function(t,e,n){var r,i=this;return Zr("IndexedDbPersistence","Starting transaction:",t),this.Be.runTransaction(t,"readonly"===e?"readonly":"readwrite",Fa,function(o){return r=new tu(o,i.Ne?i.Ne.next():Wr.o),"readwrite-primary"===e?i.Je(r).next(function(t){return!!t||i.Ye(r)}).next(function(e){if(!e)throw ti("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.Se.enqueueRetryable(function(){return i.Me(!1)}),new Yr(Xr.FAILED_PRECONDITION,qa);return n(r)}).next(function(t){return i.Ze(r).next(function(){return t})}):i.dn(r).next(function(){return n(r)})}).then(function(t){return r.raiseOnCommittedEvent(),t})},t.prototype.dn=function(t){var e=this;return ec(t).get(Oa.key).next(function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Yr(Xr.FAILED_PRECONDITION,Zu)})},t.prototype.Ze=function(t){var e=new Oa(this.clientId,this.allowTabSynchronization,Date.now());return ec(t).put(Oa.key,e)},t.yt=function(){return za.yt()},t.prototype.Xe=function(t){var e=this,n=ec(t);return n.get(Oa.key).next(function(t){return e.tn(t)?(Zr("IndexedDbPersistence","Releasing primary lease."),n.delete(Oa.key)):Qa.resolve()})},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(ti("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ke=function(){t.Se.enqueueAndForget(function(){return t.inForeground="visible"===t.document.visibilityState,t.je()})},this.document.addEventListener("visibilitychange",this.ke),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.ke&&(this.document.removeEventListener("visibilitychange",this.ke),this.ke=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Fe=function(){e.un(),e.Se.enqueueAndForget(function(){return e.shutdown()})},this.window.addEventListener("pagehide",this.Fe))},t.prototype.hn=function(){this.Fe&&(this.window.removeEventListener("pagehide",this.Fe),this.Fe=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Ke)||void 0===e?void 0:e.getItem(this.on(t)));return Zr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return ti("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Ke)try{this.Ke.setItem(this.on(this.clientId),String(Date.now()))}catch(t){ti("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Ke)try{this.Ke.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function ec(t){return eu(t,Oa.store)}function nc(t){return eu(t,Pa.store)}function rc(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var ic=function(t,e){this.progress=t,this.wn=e},oc=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next(function(r){return n.yn(t,e,r)})},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next(function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t})},t.prototype.gn=function(t,e){t.forEach(function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)})},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next(function(e){return n.En(t,e).next(function(){return e})})},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next(function(t){return n.gn(e,t)})},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return xi.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):Eo(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new xi(e)).next(function(t){var e=Os();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e})},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=Os();return this.Ut.getCollectionParents(t,i).next(function(s){return Qa.forEach(s,function(s){var a=function(t,e){return new yo(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.An(t,a,n).next(function(t){t.forEach(function(t,e){o=o.insert(t,e)})})}).next(function(){return o})})},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next(function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)}).next(function(e){return o.Rn(t,i=e,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,h=r.get(c);null==h&&(h=Xi.newInvalidDocument(c),r=r.insert(c,h)),es(u,h,o.localWriteTime),h.isFoundDocument()||(r=r.remove(c))}})}).next(function(){return r.forEach(function(t,n){jo(e,n)||(r=r.remove(t))}),r})},t.prototype.Rn=function(t,e,n){for(var r=Ds(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof ss&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next(function(t){return t.forEach(function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))}),c})},t}(),sc=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=Ds(),i=Ds(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),ac=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(fi.min())?this.Dn(t,e):this.Sn.pn(t,r).next(function(o){var s=i.Cn(e,o);return(wo(e)||Io(e))&&i.Nn(e.limitType,s,r,n)?i.Dn(t,e):($r()<=P.a.DEBUG&&Zr("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),No(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next(function(t){return s.forEach(function(e){t=t.insert(e.key,e)}),t}))})},t.prototype.Cn=function(t,e){var n=new ws(xo(t));return e.forEach(function(e,r){jo(t,r)&&(n=n.add(r))}),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return $r()<=P.a.DEBUG&&Zr("QueryEngine","Using full collection scan to execute query:",No(e)),this.Sn.getDocumentsMatchingQuery(t,e,fi.min())},t}(),uc=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new ys(ui),this.kn=new Qu(function(t){return $i(t)},Zi),this.$n=fi.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new oc(this.On,this._n,this.persistence.getIndexManager()),this.Qe=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.collect(n,e.Fn)})},t}();function cc(t,e,n,r){return new uc(t,e,n,r)}function hc(t,e){return Object(Hr.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(Hr.d)(this,function(s){switch(s.label){case 0:return n=oi(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var o;return n._n.getAllMutationBatches(t).next(function(s){return o=s,r=n.persistence.getMutationQueue(e),i=new oc(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)}).next(function(e){for(var n=[],r=[],s=Ds(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++)s=s.add(l[h].key)}for(var f=0,d=e;f<d.length;f++){var p=d[f];r.push(p.batchId);for(var m=0,g=p.mutations;m<g.length;m++)s=s.add(g[m].key)}return i.pn(t,s).next(function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}})})})];case 1:return o=s.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}})})}function lc(t,e){var n=oi(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r=e.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=Qa.resolve();return o.forEach(function(t){s=s.next(function(){return r.getEntry(e,t)}).next(function(e){var o=n.docVersions.get(t);ii(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))})}),s.next(function(){return t._n.removeMutationBatch(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n._n.performConsistencyCheck(t)}).next(function(){return n.Mn.pn(t,r)})})}function fc(t){var e=oi(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.qe.getLastRemoteSnapshotVersion(t)})}function dc(t,e){var n=oi(t),r=e.snapshotVersion,i=n.Fn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.Fn;var s=[];e.targetChanges.forEach(function(e,o){var a=i.get(o);if(a){s.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next(function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)}));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=a.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return ii(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,c,e)&&s.push(n.qe.updateTargetData(t,c))}}});var a=_s();if(e.documentUpdates.forEach(function(r,i){e.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))}),s.push(pc(t,o,e.documentUpdates,r,void 0).next(function(t){a=t})),!r.isEqual(fi.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next(function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)});s.push(u)}return Qa.waitFor(s).next(function(){return o.apply(t)}).next(function(){return n.Mn.En(t,a)}).next(function(){return a})}).then(function(t){return n.Fn=i,t})}function pc(t,e,n,r,i){var o=Ds();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var o=_s();return n.forEach(function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s.isNoDocument()&&s.version.isEqual(fi.min())?(e.removeEntry(n,u),o=o.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(s,u),o=o.insert(n,s)):Zr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)}),o})}function mc(t,e){var n=oi(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)})}function gc(t,e){var n=oi(t);return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n.qe.getTargetData(t,e).next(function(i){return i?Qa.resolve(r=i):n.qe.allocateTargetId(t).next(function(i){return r=new iu(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next(function(){return r})})})}).then(function(t){var r=n.Fn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fn=n.Fn.insert(t.targetId,t),n.kn.set(e,t.targetId)),t})}function yc(t,e,n){return Object(Hr.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(Hr.d)(this,function(a){switch(a.label){case 0:r=oi(t),i=r.Fn.get(e),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(t){return r.persistence.referenceDelegate.removeTarget(t,i)})];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!Xa(s=a.sent()))throw s;return Zr("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.Fn=r.Fn.remove(e),r.kn.delete(i.target),[2]}})})}function vc(t,e,n){var r=oi(t),i=fi.min(),o=Ds();return r.persistence.runTransaction("Execute query","readonly",function(t){return function(t,e,n){var r=oi(t),i=r.kn.get(n);return void 0!==i?Qa.resolve(r.Fn.get(i)):r.qe.getTargetData(e,n)}(r,t,So(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next(function(t){o=t})}).next(function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:fi.min(),n?o:Ds())}).next(function(t){return{documents:t,Bn:o}})})}function bc(t,e){var n=oi(t),r=oi(n.qe),i=n.Fn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.lt(t,e).next(function(t){return t?t.target:null})})}function wc(t){var e=oi(t);return e.persistence.runTransaction("Get new document changes","readonly",function(t){return function(t,e,n){var r=oi(t),i=_s(),o=uu(n),s=Xu(e),a=IDBKeyRange.lowerBound(o,!0);return s.$t({index:ja.readTimeIndex,range:a},function(t,e){var n=su(r.R,e);i=i.insert(n.key,n),o=e.readTime}).next(function(){return{wn:i,readTime:cu(o)}})}(e.On,t,e.$n)}).then(function(t){var n=t.wn;return e.$n=t.readTime,n})}function Ic(t){return Object(Hr.b)(this,void 0,void 0,function(){var e;return Object(Hr.d)(this,function(n){return[2,(e=oi(t)).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return function(t){var e=Xu(t),n=fi.min();return e.$t({index:ja.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=cu(e.readTime)),r.done()}).next(function(){return n})}(t)}).then(function(t){e.$n=t})]})})}function Tc(t,e,n,r){return Object(Hr.b)(this,void 0,void 0,function(){var i,o,s,a,u,c,h,l,f,d;return Object(Hr.d)(this,function(p){switch(p.label){case 0:for(i=oi(t),o=Ds(),s=_s(),a=As(),u=0,c=n;u<c.length;u++)l=e.qn((h=c[u]).metadata.name),h.document&&(o=o.add(l)),s=s.insert(l,e.Un(h)),a=a.insert(l,e.Qn(h.metadata.readTime));return f=i.On.newChangeBuffer({trackRemovals:!0}),[4,gc(i,function(t){return So(bo(yi.fromString("__bundle__/docs/"+t)))}(r))];case 1:return d=p.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",function(t){return pc(t,f,s,fi.min(),a).next(function(e){return f.apply(t),e}).next(function(e){return i.qe.removeMatchingKeysForTargetId(t,d.targetId).next(function(){return i.qe.addMatchingKeys(t,o,d.targetId)}).next(function(){return i.Mn.En(t,e)}).next(function(){return e})})})]}})})}function _c(t,e,n){return void 0===n&&(n=Ds()),Object(Hr.b)(this,void 0,void 0,function(){var r,i;return Object(Hr.d)(this,function(o){switch(o.label){case 0:return[4,gc(t,So(mu(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=oi(t)).persistence.runTransaction("Save named query","readwrite",function(t){var o=Hs(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Qe.saveNamedQuery(t,e);var s=r.withResumeToken(Ii.EMPTY_BYTE_STRING,o);return i.Fn=i.Fn.insert(s.targetId,s),i.qe.updateTargetData(t,s).next(function(){return i.qe.removeMatchingKeysForTargetId(t,r.targetId)}).next(function(){return i.qe.addMatchingKeys(t,n,r.targetId)}).next(function(){return i.Qe.saveNamedQuery(t,e)})})]}})})}var Ec=function(){function t(t){this.R=t,this.Kn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return Qa.resolve(this.Kn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Kn.set(e.id,{id:(n=e).id,version:n.version,createTime:Hs(n.createTime)}),Qa.resolve()},t.prototype.getNamedQuery=function(t,e){return Qa.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:mu(t.bundledQuery),readTime:Hs(t.readTime)}}(e)),Qa.resolve()},t}(),Oc=function(){function t(){this.Wn=new ws(Sc.Gn),this.zn=new ws(Sc.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new Sc(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach(function(t){return n.addReference(t,e)})},t.prototype.removeReference=function(t,e){this.Yn(new Sc(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach(function(t){return n.removeReference(t,e)})},t.prototype.Zn=function(t){var e=this,n=new xi(new yi([])),r=new Sc(n,t),i=new Sc(n,t+1),o=[];return this.zn.forEachInRange([r,i],function(t){e.Yn(t),o.push(t.key)}),o},t.prototype.ts=function(){var t=this;this.Wn.forEach(function(e){return t.Yn(e)})},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new xi(new yi([])),n=new Sc(e,t),r=new Sc(e,t+1),i=Ds();return this.zn.forEachInRange([n,r],function(t){i=i.add(t.key)}),i},t.prototype.containsKey=function(t){var e=new Sc(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),Sc=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return xi.comparator(t.key,e.key)||ui(t.ns,e.ns)},t.Hn=function(t,e){return ui(t.ns,e.ns)||xi.comparator(t.key,e.key)},t}(),Ac=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new ws(Sc.Gn)}return t.prototype.checkEmpty=function(t){return Qa.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++;var o=new nu(i,e,n,r);this._n.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.rs=this.rs.add(new Sc(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return Qa.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return Qa.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this.cs(e+1),r=n<0?0:n;return Qa.resolve(this._n.length>r?this._n[r]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return Qa.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return Qa.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new Sc(e,0),i=new Sc(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],function(t){var e=n.os(t.ns);o.push(e)}),Qa.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new ws(ui);return e.forEach(function(t){var e=new Sc(t,0),i=new Sc(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],function(t){r=r.add(t.ns)})}),Qa.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;xi.isDocumentKey(i)||(i=i.child(""));var o=new Sc(new xi(i),0),s=new ws(ui);return this.rs.forEachWhile(function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.ns)),!0)},o),Qa.resolve(this.us(s))},t.prototype.us=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.os(t);null!==r&&n.push(r)}),n},t.prototype.removeMutationBatch=function(t,e){var n=this;ii(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return Qa.forEach(e.mutations,function(i){var o=new Sc(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(function(){n.rs=r})},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new Sc(e,0),r=this.rs.firstAfterOrEqual(n);return Qa.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return Qa.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),kc=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new ys(xi.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:s,readTime:n}),this.size+=s-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return Qa.resolve(n?n.document.clone():Xi.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=_s();return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():Xi.newInvalidDocument(t))}),Qa.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=_s(),i=new xi(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.value,u=a.document,c=a.readTime;if(!e.path.isPrefixOf(s.key.path))break;c.compareTo(n)<=0||jo(e,u)&&(r=r.insert(u.key,u.clone()))}return Qa.resolve(r)},t.prototype.fs=function(t,e){return Qa.forEach(this.docs,function(t){return e(t)})},t.prototype.newChangeBuffer=function(t){return new Dc(this)},t.prototype.getSize=function(t){return Qa.resolve(this.size)},t}(),Dc=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return Object(Hr.c)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach(function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)}),Qa.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(Gu),Nc=function(){function t(t){this.persistence=t,this.ds=new Qu(function(t){return $i(t)},Zi),this.lastRemoteSnapshotVersion=fi.min(),this.highestTargetId=0,this.ws=0,this._s=new Oc,this.targetCount=0,this.ys=xu.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach(function(t,n){return e(n)}),Qa.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return Qa.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return Qa.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),Qa.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),Qa.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new xu(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,Qa.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),Qa.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,Qa.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach(function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.ds.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)}),Qa.waitFor(o).next(function(){return i})},t.prototype.getTargetCount=function(t){return Qa.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return Qa.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),Qa.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.markPotentiallyOrphaned(t,e))}),Qa.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),Qa.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return Qa.resolve(n)},t.prototype.containsKey=function(t,e){return Qa.resolve(this._s.containsKey(e))},t}(),jc=function(){function t(t,e){var n=this;this.gs={},this.Ne=new Wr(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new Nc(this),this.Ut=new bu,this.Ue=function(t,e){return new kc(t,function(t){return n.referenceDelegate.ps(t)})}(this.Ut),this.R=new ou(e),this.Qe=new Ec(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new Ac(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Qe},t.prototype.runTransaction=function(t,e,n){var r=this;Zr("MemoryPersistence","Starting transaction:",t);var i=new xc(this.Ne.next());return this.referenceDelegate.Es(),n(i).next(function(t){return r.referenceDelegate.Ts(i).next(function(){return t})}).toPromise().then(function(t){return i.raiseOnCommittedEvent(),t})},t.prototype.Is=function(t,e){return Qa.or(Object.values(this.gs).map(function(n){return function(){return n.containsKey(t,e)}}))},t}(),xc=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return Object(Hr.c)(e,t),e}(Ba),Cc=function(){function t(t){this.persistence=t,this.As=new Oc,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw ri()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),Qa.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),Qa.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),Qa.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach(function(t){return n.vs.add(t.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(function(t){t.forEach(function(t){return n.vs.add(t.toString())})}).next(function(){return r.removeTargetData(t,e)})},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Qa.forEach(this.vs,function(r){var i=xi.fromPath(r);return e.Ps(t,i).next(function(t){t||n.removeEntry(i)})}).next(function(){return e.Rs=null,n.apply(t)})},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next(function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())})},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return Qa.or([function(){return Qa.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),Rc=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();function Vc(t,e){return"firestore_clients_"+t+"_"+e}function Uc(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function Pc(t,e){return"firestore_targets_"+t+"_"+e}Rc.UNAUTHENTICATED=new Rc(null),Rc.GOOGLE_CREDENTIALS=new Rc("google-credentials-uid"),Rc.FIRST_PARTY=new Rc("first-party-uid");var Lc=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new Yr(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(ti("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Mc=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new Yr(i.error.code,i.error.message)),o?new t(e,i.state,r):(ti("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Fc=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=js(),s=0;i&&s<r.activeTargetIds.length;++s)i=ji(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(ti("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),qc=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(ti("SharedClientState","Failed to parse online state: "+e),null)},t}(),Bc=function(){function t(){this.activeTargetIds=js()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Kc=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new ys(ui),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=Vc(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.ks=this.ks.insert(this.Ns,new Bc),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Qs=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(Hr.b)(this,void 0,void 0,function(){var t,e,n,r,i,o,s,a,u,c,h=this;return Object(Hr.d)(this,function(l){switch(l.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=l.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(Vc(this.persistenceKey,r)))&&(o=Fc.Vs(r,i))&&(this.ks=this.ks.insert(o.clientId,o));for(this.Ks(),(s=this.storage.getItem(this.Us))&&(a=this.js(s))&&this.Ws(a),u=0,c=this.$s;u<c.length;u++)this.Fs(c[u]);return this.$s=[],this.window.addEventListener("pagehide",function(){return h.shutdown()}),this.started=!0,[2]}})})},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.ks.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(Pc(this.persistenceKey,t));if(n){var r=Mc.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Ks(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Ks()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(Pc(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach(function(t){r.Hs(t)}),this.currentUser=t,n.forEach(function(t){r.addPendingMutation(t)})},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Zr("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Zr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Zr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Fs=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Zr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void ti("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable(function(){return Object(Hr.b)(e,void 0,void 0,function(){var t,e,r,i,o,s;return Object(Hr.d)(this,function(a){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(s=function(t){var e=Wr.o;if(null!=t)try{var n=JSON.parse(t);ii("number"==typeof n),e=n}catch(t){ti("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Wr.o&&this.sequenceNumberHandler(s);else if(n.key===this.Qs)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]})})})}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Ks=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new Lc(this.currentUser,t,e,n),i=Uc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=Uc(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){this.storage.setItem(this.Us,JSON.stringify({clientId:this.Ns,onlineState:t}))},t.prototype.Ys=function(t,e,n){var r=Pc(this.persistenceKey,t),i=new Mc(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Qs,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return Fc.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]);return Lc.Vs(new Rc(void 0!==n[2]?n[2]:null),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return Mc.Vs(r,e)},t.prototype.js=function(t){return qc.Vs(t)},t.prototype.ii=function(t){return Object(Hr.b)(this,void 0,void 0,function(){return Object(Hr.d)(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(Zr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.ks.insert(t,e):this.ks.remove(t),i=this.Gs(this.ks),o=this.Gs(r),s=[],a=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||a.push(t)}),this.syncEngine.hi(s,a).then(function(){n.ks=r})},t.prototype.Ws=function(t){this.ks.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=js();return t.forEach(function(t,n){e=e.unionWith(n.activeTargetIds)}),e},t}(),Qc=function(){function t(){this.li=new Bc,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new Bc,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),Gc=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),zc=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){Zr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){Zr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Hc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Wc=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),Xc=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return Object(Hr.c)(e,t),e.prototype.ki=function(t,e,n,r){return new Promise(function(i,o){var s=new zr;s.listenOnce(Br.COMPLETE,function(){try{switch(s.getLastErrorCode()){case qr.NO_ERROR:var e=s.getResponseJson();Zr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case qr.TIMEOUT:Zr("Connection",'RPC "'+t+'" timed out'),o(new Yr(Xr.DEADLINE_EXCEEDED,"Request time out"));break;case qr.HTTP_ERROR:var n=s.getStatus();if(Zr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(Xr).indexOf(e)>=0?e:Xr.UNKNOWN}(r.status);o(new Yr(a,r.message))}else o(new Yr(Xr.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Yr(Xr.UNAVAILABLE,"Connection failed."));break;default:ri()}}finally{Zr("Connection",'RPC "'+t+'" completed.')}});var a=JSON.stringify(r);s.send(e,"POST",a,n,15)})},e.prototype.Oi=function(t,e){var n=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new Nr,i=xe(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new Qr({})),this.Fi(o.initMessageHeaders,e),Object(U.n)()||Object(U.p)()||Object(U.l)()||Object(U.m)()||Object(U.q)()||Object(U.k)()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");Zr("Connection","Creating WebChannel: "+s,o);var a=r.createWebChannel(s,o),u=!1,c=!1,h=new Wc({Ei:function(t){c?Zr("Connection","Not sending because WebChannel is closed:",t):(u||(Zr("Connection","Opening WebChannel transport."),a.open(),u=!0),Zr("Connection","WebChannel sending:",t),a.send(t))},Ti:function(){return a.close()}}),l=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return l(a,Gr.EventType.OPEN,function(){c||Zr("Connection","WebChannel transport opened.")}),l(a,Gr.EventType.CLOSE,function(){c||(c=!0,Zr("Connection","WebChannel transport closed"),h.Vi())}),l(a,Gr.EventType.ERROR,function(t){c||(c=!0,ei("Connection","WebChannel transport errored:",t),h.Vi(new Yr(Xr.UNAVAILABLE,"The operation could not be completed")))}),l(a,Gr.EventType.MESSAGE,function(t){var e;if(!c){var n=t.data[0];ii(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){Zr("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=hs[t];if(void 0!==e)return gs(e)}(i),s=r.message;void 0===o&&(o=Xr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),c=!0,h.Vi(new Yr(o,s)),a.close()}else Zr("Connection","WebChannel received:",n),h.Si(n)}}),l(i,Kr.STAT_EVENT,function(t){10===t.stat?Zr("Connection","Detected buffering proxy"):11===t.stat&&Zr("Connection","Detected no buffering proxy")}),setTimeout(function(){h.Pi()},0),h},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId,this.Di=(t.ssl?"https":"http")+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);Zr("RestConnection","Sending: ",i,n);var o={};return this.Fi(o,r),this.ki(t,i,o,n).then(function(t){return Zr("RestConnection","Received: ",t),t},function(e){throw ei("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.Fi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.6.8",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){return this.Di+"/v1/"+e+":"+Hc[t]},t}());function Yc(){return"undefined"!=typeof window?window:null}function Jc(){return"undefined"!=typeof document?document:null}function $c(t){return new Ks(t,!0)}var Zc=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Qi=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Ki=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Qi),i=Math.max(0,n-r);i>0&&Zr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,function(){return e.Qi=Date.now(),t()}),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),th=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new Zc(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return Object(Hr.b)(this,void 0,void 0,function(){return Object(Hr.d)(this,function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,function(){return t.rr()}))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return Object(Hr.b)(this,void 0,void 0,function(){return Object(Hr.d)(this,function(t){return this.er()?[2,this.close(0)]:[2]})})},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return Object(Hr.b)(this,void 0,void 0,function(){return Object(Hr.d)(this,function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===Xr.RESOURCE_EXHAUSTED?(ti(e.toString()),ti("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Ki()):e&&e.code===Xr.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}})})},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then(function(e){t.Yi===n&&t.lr(e)},function(n){e(function(){var e=new Yr(Xr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)})})},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii(function(){n(function(){return e.state=2,e.listener.Ii()})}),this.stream.Ri(function(t){n(function(){return e.dr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji(function(){return Object(Hr.b)(t,void 0,void 0,function(){return Object(Hr.d)(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.dr=function(t){return Zr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget(function(){return e.Yi===t?n():(Zr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),eh=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,s}return Object(Hr.c)(e,t),e.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:ri()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(ii(void 0===e||"string"==typeof e),Ii.fromBase64String(e||"")):(ii(void 0===e||e instanceof Uint8Array),Ii.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?Xr.UNKNOWN:gs(t.code);return new Yr(e,t.message||"")}(a);n=new Us(r,i,o,s||null)}else if("documentChange"in e){i=Js(t,(r=e.documentChange).document.name),o=Hs(r.document.updateTime);var a=new Hi({mapValue:{fields:r.document.fields}}),u=(s=Xi.newFoundDocument(i,o,a),r.targetIds||[]);n=new Rs(u,r.removedTargetIds||[],s.key,s)}else if("documentDelete"in e)i=Js(t,(r=e.documentDelete).document),o=r.readTime?Hs(r.readTime):fi.min(),a=Xi.newNoDocument(i,o),n=new Rs([],s=r.removedTargetIds||[],a.key,a);else if("documentRemove"in e)i=Js(t,(r=e.documentRemove).document),n=new Rs([],o=r.removedTargetIds||[],i,null);else{if(!("filter"in e))return ri();var c=e.filter;i=new ps(r=c.count||0),n=new Vs(o=c.targetId,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return fi.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?fi.min():e.readTime?Hs(e.readTime):fi.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=ta(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=to(r)?{documents:sa(t,r)}:{query:aa(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=Gs(t,e.resumeToken):e.snapshotVersion.compareTo(fi.min())>0&&(n.readTime=Qs(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return ri()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=ta(this.R),e.removeTarget=t,this.cr(e)},e}(th),nh=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,s.gr=!1,s}return Object(Hr.c)(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi("Write",t)},e.prototype.onMessage=function(t){if(ii(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(ii(void 0!==e),t.map(function(t){return function(t,e){var n=Hs(t.updateTime?t.updateTime:e);return n.isEqual(fi.min())&&(n=Hs(e)),new Yo(n,t.transformResults||[])}(t,e)})):[]}(t.writeResults,t.commitTime),n=Hs(t.commitTime);return this.listener.Tr(n,e)}return ii(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=ta(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return ia(e.R,t)})};this.cr(n)},e}(th),rh=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return Object(Hr.c)(e,t),e.prototype.br=function(){if(this.Rr)throw new Yr(Xr.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then(function(i){return r.Hi.Ni(t,e,n,i)}).catch(function(t){throw"FirebaseError"===t.name?(t.code===Xr.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Yr(Xr.UNKNOWN,t.toString())})},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then(function(i){return r.Hi.$i(t,e,n,i)}).catch(function(t){throw"FirebaseError"===t.name?(t.code===Xr.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Yr(Xr.UNKNOWN,t.toString())})},e.prototype.terminate=function(){this.Rr=!0},e}(function(){}),ih=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()}))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.Fr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(ti(e),this.Vr=!1):Zr("OnlineStateTracker",e)},t.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),oh=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di(function(t){n.enqueueAndForget(function(){return Object(Hr.b)(o,void 0,void 0,function(){return Object(Hr.d)(this,function(t){switch(t.label){case 0:return ph(this)?(Zr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(Hr.b)(this,void 0,void 0,function(){var e;return Object(Hr.d)(this,function(n){switch(n.label){case 0:return(e=oi(t)).Or.add(4),[4,ah(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,sh(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Br=new ih(n,r)};function sh(t){return Object(Hr.b)(this,void 0,void 0,function(){var e,n;return Object(Hr.d)(this,function(r){switch(r.label){case 0:if(!ph(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function ah(t){return Object(Hr.b)(this,void 0,void 0,function(){var e,n;return Object(Hr.d)(this,function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function uh(t,e){var n=oi(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),dh(n)?fh(n):Dh(n).er()&&hh(n,e))}function ch(t,e){var n=oi(t),r=Dh(n);n.$r.delete(e),r.er()&&lh(n,e),0===n.$r.size&&(r.er()?r.ir():ph(n)&&n.Br.set("Unknown"))}function hh(t,e){t.qr.U(e.targetId),Dh(t).mr(e)}function lh(t,e){t.qr.U(e),Dh(t).yr(e)}function fh(t){t.qr=new Ls({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),Dh(t).start(),t.Br.Sr()}function dh(t){return ph(t)&&!Dh(t).tr()&&t.$r.size>0}function ph(t){return 0===oi(t).Or.size}function mh(t){t.qr=void 0}function gh(t){return Object(Hr.b)(this,void 0,void 0,function(){return Object(Hr.d)(this,function(e){return t.$r.forEach(function(e,n){hh(t,e)}),[2]})})}function yh(t,e){return Object(Hr.b)(this,void 0,void 0,function(){return Object(Hr.d)(this,function(n){return mh(t),dh(t)?(t.Br.Nr(e),fh(t)):t.Br.set("Unknown"),[2]})})}function vh(t,e,n){return Object(Hr.b)(this,void 0,void 0,function(){var r,i,o;return Object(Hr.d)(this,function(s){switch(s.label){case 0:if(t.Br.set("Online"),!(e instanceof Us&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Object(Hr.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(Hr.d)(this,function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?t.$r.has(o=i[r])?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]:[3,5];case 2:s.sent(),t.$r.delete(o),t.qr.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),Zr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,bh(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Rs?t.qr.X(e):e instanceof Vs?t.qr.rt(e):t.qr.et(e),n.isEqual(fi.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,fc(t.localStore)];case 8:return i=s.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach(function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(n.resumeToken,e))}}),n.targetMismatches.forEach(function(e){var n=t.$r.get(e);if(n){t.$r.set(e,n.withResumeToken(Ii.EMPTY_BYTE_STRING,n.snapshotVersion)),lh(t,e);var r=new iu(n.target,e,1,n.sequenceNumber);hh(t,r)}}),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return Zr("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,bh(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}})})}function bh(t,e,n){return Object(Hr.b)(this,void 0,void 0,function(){var r=this;return Object(Hr.d)(this,function(i){switch(i.label){case 0:if(!Xa(e))throw e;return t.Or.add(1),[4,ah(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return fc(t.localStore)}),t.asyncQueue.enqueueRetryable(function(){return Object(Hr.b)(r,void 0,void 0,function(){return Object(Hr.d)(this,function(e){switch(e.label){case 0:return Zr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,sh(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function wh(t,e){return e().catch(function(n){return bh(t,n,e)})}function Ih(t){return Object(Hr.b)(this,void 0,void 0,function(){var e,n,r,i,o;return Object(Hr.d)(this,function(s){switch(s.label){case 0:e=oi(t),n=Nh(e),r=e.kr.length>0?e.kr[e.kr.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return ph(t)&&t.kr.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,mc(e.localStore,r)];case 3:return null===(i=s.sent())?(0===e.kr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.kr.push(e);var n=Nh(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,bh(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return Th(e)&&_h(e),[2]}})})}function Th(t){return ph(t)&&!Nh(t).tr()&&t.kr.length>0}function _h(t){Nh(t).start()}function Eh(t){return Object(Hr.b)(this,void 0,void 0,function(){return Object(Hr.d)(this,function(e){return Nh(t).Ar(),[2]})})}function Oh(t){return Object(Hr.b)(this,void 0,void 0,function(){var e,n,r;return Object(Hr.d)(this,function(i){for(e=Nh(t),n=0,r=t.kr;n<r.length;n++)e.Er(r[n].mutations);return[2]})})}function Sh(t,e,n){return Object(Hr.b)(this,void 0,void 0,function(){var r,i;return Object(Hr.d)(this,function(o){switch(o.label){case 0:return r=t.kr.shift(),i=ru.from(r,e,n),[4,wh(t,function(){return t.remoteSyncer.applySuccessfulWrite(i)})];case 1:return o.sent(),[4,Ih(t)];case 2:return o.sent(),[2]}})})}function Ah(t,e){return Object(Hr.b)(this,void 0,void 0,function(){return Object(Hr.d)(this,function(n){switch(n.label){case 0:return e&&Nh(t).pr?[4,function(t,e){return Object(Hr.b)(this,void 0,void 0,function(){var n,r;return Object(Hr.d)(this,function(i){switch(i.label){case 0:return ms(r=e.code)&&r!==Xr.ABORTED?(n=t.kr.shift(),Nh(t).sr(),[4,wh(t,function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,Ih(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Th(t)&&_h(t),[2]}})})}function kh(t,e){return Object(Hr.b)(this,void 0,void 0,function(){var n;return Object(Hr.d)(this,function(r){switch(r.label){case 0:return n=oi(t),e?(n.Or.delete(2),[4,sh(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,ah(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function Dh(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=oi(t);return r.br(),new eh(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:gh.bind(null,t),Ri:yh.bind(null,t),_r:vh.bind(null,t)}),t.Mr.push(function(n){return Object(Hr.b)(e,void 0,void 0,function(){return Object(Hr.d)(this,function(e){switch(e.label){case 0:return n?(t.Ur.sr(),dh(t)?fh(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),mh(t),e.label=3;case 3:return[2]}})})})),t.Ur}function Nh(t){var e=this;return t.Qr||(t.Qr=function(t,e,n){var r=oi(t);return r.br(),new nh(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:Eh.bind(null,t),Ri:Ah.bind(null,t),Ir:Oh.bind(null,t),Tr:Sh.bind(null,t)}),t.Mr.push(function(n){return Object(Hr.b)(e,void 0,void 0,function(){return Object(Hr.d)(this,function(e){switch(e.label){case 0:return n?(t.Qr.sr(),[4,Ih(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Qr.stop()];case 3:e.sent(),t.kr.length>0&&(Zr("RemoteStore","Stopping write stream with "+t.kr.length+" pending writes"),t.kr=[]),e.label=4;case 4:return[2]}})})})),t.Qr}var jh=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Ka,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(t){})}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout(function(){return e.handleDelayElapsed()},t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Yr(Xr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget(function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then(function(e){return t.deferred.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function xh(t,e){if(ti("AsyncQueue",e+": "+t),Xa(t))return new Yr(Xr.UNAVAILABLE,e+": "+t);throw t}var Ch=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||xi.comparator(e.key,n.key)}:function(t,e){return xi.comparator(t.key,e.key)},this.keyedMap=Os(),this.sortedSet=new ys(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),Rh=function(){function t(){this.Kr=new ys(xi.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Kr.get(e);n?0!==t.type&&3===n.type?this.Kr=this.Kr.insert(e,t):3===t.type&&1!==n.type?this.Kr=this.Kr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Kr=this.Kr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Kr=this.Kr.remove(e):1===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):ri():this.Kr=this.Kr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Kr.inorderTraversal(function(e,n){t.push(n)}),t},t}(),Vh=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,Ch.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&ko(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Uh=function(){this.Wr=void 0,this.listeners=[]},Ph=function(){this.queries=new Qu(function(t){return Do(t)},ko),this.onlineState="Unknown",this.Gr=new Set};function Lh(t,e){return Object(Hr.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u;return Object(Hr.d)(this,function(c){switch(c.label){case 0:if(n=oi(t),i=!1,(o=n.queries.get(r=e.query))||(i=!0,o=new Uh),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Wr=c.sent(),[3,4];case 3:return a=c.sent(),u=xh(a,"Initialization of query '"+No(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&Bh(n),[2]}})})}function Mh(t,e){return Object(Hr.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(Hr.d)(this,function(a){return n=oi(t),i=!1,(o=n.queries.get(r=e.query))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]})})}function Fh(t,e){for(var n=oi(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=n.queries.get(s.query);if(a){for(var u=0,c=a.listeners;u<c.length;u++)c[u].Hr(s)&&(r=!0);a.Wr=s}}r&&Bh(n)}function qh(t,e,n){var r=oi(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function Bh(t){t.Gr.forEach(function(t){t.next()})}var Kh=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Vh(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){return!t.fromCache||!(this.options.so&&"Offline"!==e||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){return t.docChanges.length>0||!!(t.syncStateChanged||this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=Vh.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),Qh=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.io=function(){return"metadata"in this.payload},t}(),Gh=function(){function t(t){this.R=t}return t.prototype.qn=function(t){return Js(this.R,t)},t.prototype.Un=function(t){return t.metadata.exists?ra(this.R,t.document,!1):Xi.newNoDocument(this.qn(t.metadata.name),this.Qn(t.metadata.readTime))},t.prototype.Qn=function(t){return Hs(t)},t}();!function(){function t(t,e,n){this.ro=t,this.localStore=e,this.R=n,this.queries=[],this.documents=[],this.progress=function(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(t)}t.prototype.oo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.co=function(t){for(var e=new Map,n=new Gh(this.R),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.qn(o.metadata.name),a=0,u=o.metadata.queries;a<u.length;a++){var c=u[a],h=(e.get(c)||Ds()).add(s);e.set(c,h)}}return e},t.prototype.complete=function(){return Object(Hr.b)(this,void 0,void 0,function(){var t,e,n,r,i;return Object(Hr.d)(this,function(o){switch(o.label){case 0:return[4,Tc(this.localStore,new Gh(this.R),this.documents,this.ro.id)];case 1:t=o.sent(),e=this.co(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?[4,_c(this.localStore,i=r[n],e.get(i.name))]:[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new ic(Object.assign({},this.progress),t))]}})})}}();var zh=function(t){this.key=t},Hh=function(t){this.key=t},Wh=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=Ds(),this.mutatedKeys=Ds(),this.lo=xo(t),this.fo=new Ch(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new Rh,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=wo(this.query)&&i.size===this.query.limit?i.last():null,c=Io(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(function(t,e){var h=i.get(t),l=jo(n.query,e)?e:null,f=!!h&&n.mutatedKeys.has(h.key),d=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),p=!1;h&&l?h.data.isEqual(l.data)?f!==d&&(r.track({type:3,doc:l}),p=!0):n.yo(h,l)||(r.track({type:2,doc:l}),p=!0,(u&&n.lo(l,u)>0||c&&n.lo(l,c)<0)&&(a=!0)):!h&&l?(r.track({type:0,doc:l}),p=!0):h&&!l&&(r.track({type:1,doc:h}),p=!0,(u||c)&&(a=!0)),p&&(l?(s=s.add(l),o=d?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),wo(this.query)||Io(this.query))for(;s.size>this.query.limit;){var h=wo(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{fo:s,mo:r,Nn:a,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ri()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)}),this.po(n);var s=e?this.Eo():[],a=0===this.ho.size&&this.current?1:0,u=a!==this.ao;return this.ao=a,0!==o.length||u?{snapshot:new Vh(this.query,t.fo,i,o,t.mutatedKeys,0===a,u,!1),To:s}:{To:s}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new Rh,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach(function(t){return e.uo=e.uo.add(t)}),t.modifiedDocuments.forEach(function(t){}),t.removedDocuments.forEach(function(t){return e.uo=e.uo.delete(t)}),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=Ds(),this.fo.forEach(function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))});var n=[];return e.forEach(function(e){t.ho.has(e)||n.push(new Hh(e))}),this.ho.forEach(function(t){e.has(t)||n.push(new zh(t))}),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=Ds();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return Vh.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),Xh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Yh=function(t){this.key=t,this.bo=!1},Jh=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new Qu(function(t){return Do(t)},ko),this.Vo=new Map,this.So=new Set,this.Do=new ys(xi.comparator),this.Co=new Map,this.No=new Oc,this.xo={},this.Fo=new Map,this.ko=xu.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();function $h(t,e){return Object(Hr.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(Hr.d)(this,function(a){switch(a.label){case 0:return n=Al(t),(i=n.Po.get(e))?(n.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.Ro(),[3,4]):[3,1];case 1:return[4,gc(n.localStore,So(e))];case 2:return o=a.sent(),s=n.sharedClientState.addLocalQueryTarget(o.targetId),[4,Zh(n,e,o.targetId,"current"===s)];case 3:r=a.sent(),n.isPrimaryClient&&uh(n.remoteStore,o),a.label=4;case 4:return[2,r]}})})}function Zh(t,e,n,r){return Object(Hr.b)(this,void 0,void 0,function(){var i,o,s,a,u,c;return Object(Hr.d)(this,function(h){switch(h.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return Object(Hr.b)(this,void 0,void 0,function(){var i,o,s;return Object(Hr.d)(this,function(a){switch(a.label){case 0:return(i=e.view._o(n)).Nn?[4,vc(t.localStore,e.query,!1).then(function(t){return e.view._o(t.documents,i)})]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),s=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(fl(t,e.targetId,s.To),s.snapshot)]}})})}(t,e,n,r)},[4,vc(t.localStore,e,!0)];case 1:return i=h.sent(),o=new Wh(e,i.Bn),s=o._o(i.documents),a=Cs.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),u=o.applyChanges(s,t.isPrimaryClient,a),fl(t,n,u.To),c=new Xh(e,n,o),[2,(t.Po.set(e,c),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),u.snapshot)]}})})}function tl(t,e){return Object(Hr.b)(this,void 0,void 0,function(){var n,r,i;return Object(Hr.d)(this,function(o){switch(o.label){case 0:return n=oi(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter(function(t){return!ko(t,e)})),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,yc(n.localStore,r.targetId,!1).then(function(){n.sharedClientState.clearQueryState(r.targetId),ch(n.remoteStore,r.targetId),hl(n,r.targetId)}).catch(Pu)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return hl(n,r.targetId),[4,yc(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function el(t,e,n){return Object(Hr.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(Hr.d)(this,function(a){switch(a.label){case 0:r=kl(t),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(t,e){var n,r=oi(t),i=li.now(),o=e.reduce(function(t,e){return t.add(e.key)},Ds());return r.persistence.runTransaction("Locally write mutations","readwrite",function(t){return r.Mn.pn(t,o).next(function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],h=ns(c,n.get(c.key));null!=h&&s.push(new ss(c.key,h,Wi(h.value.mapValue),Jo.exists(!0)))}return r._n.addMutationBatch(t,i,s,e)})}).then(function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}})}(r.localStore,e)];case 2:return i=a.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new ys(ui)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,ml(r,i.changes)];case 3:return a.sent(),[4,Ih(r.remoteStore)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=xh(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}})})}function nl(t,e){return Object(Hr.b)(this,void 0,void 0,function(){var n,r;return Object(Hr.d)(this,function(i){switch(i.label){case 0:n=oi(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,dc(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach(function(t,e){var r=n.Co.get(e);r&&(ii(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?ii(r.bo):t.removedDocuments.size>0&&(ii(r.bo),r.bo=!1))}),[4,ml(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Pu(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function rl(t,e,n){var r=oi(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach(function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)}),function(t,e){var n=oi(t);n.onlineState=e;var r=!1;n.queries.forEach(function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)}),r&&Bh(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function il(t,e,n){return Object(Hr.b)(this,void 0,void 0,function(){var r,i,o,s,a,u;return Object(Hr.d)(this,function(c){switch(c.label){case 0:return(r=oi(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(o=i&&i.key)?(s=(s=new ys(xi.comparator)).insert(o,Xi.newNoDocument(o,fi.min())),a=Ds().add(o),u=new xs(fi.min(),new Map,new ws(ui),s,a),[4,nl(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),pl(r),[3,4];case 2:return[4,yc(r.localStore,e,!1).then(function(){return hl(r,e,n)}).catch(Pu)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}function ol(t,e){return Object(Hr.b)(this,void 0,void 0,function(){var n,r,i;return Object(Hr.d)(this,function(o){switch(o.label){case 0:n=oi(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,lc(n.localStore,e)];case 2:return i=o.sent(),cl(n,r,null),ul(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,ml(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Pu(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function sl(t,e,n){return Object(Hr.b)(this,void 0,void 0,function(){var r,i;return Object(Hr.d)(this,function(o){switch(o.label){case 0:r=oi(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=oi(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(t){var r;return n._n.lookupMutationBatch(t,e).next(function(e){return ii(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)}).next(function(){return n._n.performConsistencyCheck(t)}).next(function(){return n.Mn.pn(t,r)})})}(r.localStore,e)];case 2:return i=o.sent(),cl(r,e,n),ul(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,ml(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Pu(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function al(t,e){return Object(Hr.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(Hr.d)(this,function(a){switch(a.label){case 0:ph((n=oi(t)).remoteStore)||Zr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(t){var e=oi(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e._n.getHighestUnacknowledgedBatchId(t)})}(n.localStore)];case 2:return-1===(r=a.sent())?[2,void e.resolve()]:((i=n.Fo.get(r)||[]).push(e),n.Fo.set(r,i),[3,4]);case 3:return o=a.sent(),s=xh(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}})})}function ul(t,e){(t.Fo.get(e)||[]).forEach(function(t){t.resolve()}),t.Fo.delete(e)}function cl(t,e,n){var r=oi(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function hl(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach(function(e){t.No.containsKey(e)||ll(t,e)})}function ll(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(ch(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),pl(t))}function fl(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof zh?(t.No.addReference(o.key,e),dl(t,o)):o instanceof Hh?(Zr("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||ll(t,o.key)):ri()}}function dl(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(Zr("SyncEngine","New document in limbo: "+n),t.So.add(r),pl(t))}function pl(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new xi(yi.fromString(e)),r=t.ko.next();t.Co.set(r,new Yh(n)),t.Do=t.Do.insert(n,r),uh(t.remoteStore,new iu(So(bo(n.path)),r,2,Wr.o))}}function ml(t,e,n){return Object(Hr.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(Hr.d)(this,function(a){switch(a.label){case 0:return r=oi(t),i=[],o=[],s=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach(function(t,a){s.push(r.Oo(a,e,n).then(function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=sc.Pn(a.targetId,t);o.push(e)}}))}),[4,Promise.all(s)]);case 1:return a.sent(),r.vo._r(i),[4,function(t,e){return Object(Hr.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u,c;return Object(Hr.d)(this,function(h){switch(h.label){case 0:n=oi(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return Qa.forEach(e,function(e){return Qa.forEach(e.bn,function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)}).next(function(){return Qa.forEach(e.vn,function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)})})})})];case 2:return h.sent(),[3,4];case 3:if(!Xa(r=h.sent()))throw r;return Zr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)a=(s=o[i]).targetId,s.fromCache||(u=n.Fn.get(a),c=u.withLastLimboFreeSnapshotVersion(u.snapshotVersion),n.Fn=n.Fn.insert(a,c));return[2]}})})}(r.localStore,o)];case 2:a.sent(),a.label=3;case 3:return[2]}})})}function gl(t,e){return Object(Hr.b)(this,void 0,void 0,function(){var n,r;return Object(Hr.d)(this,function(i){switch(i.label){case 0:return(n=oi(t)).currentUser.isEqual(e)?[3,3]:(Zr("SyncEngine","User change. New user:",e.toKey()),[4,hc(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Fo.forEach(function(t){t.forEach(function(t){t.reject(new Yr(Xr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.Fo.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,ml(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function yl(t,e){var n=oi(t),r=n.Co.get(e);if(r&&r.bo)return Ds().add(r.key);var i=Ds(),o=n.Vo.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=n.Po.get(a[s]);i=i.unionWith(u.view.wo)}return i}function vl(t,e){return Object(Hr.b)(this,void 0,void 0,function(){var n,r,i;return Object(Hr.d)(this,function(o){switch(o.label){case 0:return[4,vc((n=oi(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&fl(n,e.targetId,i.To),i)]}})})}function bl(t){return Object(Hr.b)(this,void 0,void 0,function(){var e;return Object(Hr.d)(this,function(n){return[2,wc((e=oi(t)).localStore).then(function(t){return ml(e,t)})]})})}function wl(t,e,n,r){return Object(Hr.b)(this,void 0,void 0,function(){var i,o;return Object(Hr.d)(this,function(s){switch(s.label){case 0:return[4,function(t,e){var n=oi(t),r=oi(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return r.jt(t,e).next(function(e){return e?n.Mn.pn(t,e):Qa.resolve(null)})})}((i=oi(t)).localStore,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,Ih(i.remoteStore)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(cl(i,e,r||null),ul(i,e),function(t,e){oi(oi(t)._n).Gt(e)}(i.localStore,e)):ri(),s.label=4;case 4:return[4,ml(i,o)];case 5:return s.sent(),[3,7];case 6:Zr("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}})})}function Il(t,e){return Object(Hr.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u;return Object(Hr.d)(this,function(c){switch(c.label){case 0:return Al(n=oi(t)),kl(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,Tl(n,r.toArray())]);case 1:return i=c.sent(),n.$o=!0,[4,kh(n.remoteStore,!0)];case 2:for(c.sent(),o=0,s=i;o<s.length;o++)uh(n.remoteStore,s[o]);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(a=[],u=Promise.resolve(),n.Vo.forEach(function(t,e){n.sharedClientState.isLocalQueryTarget(e)?a.push(e):u=u.then(function(){return hl(n,e),yc(n.localStore,e,!0)}),ch(n.remoteStore,e)}),[4,u]);case 4:return c.sent(),[4,Tl(n,a)];case 5:return c.sent(),function(t){var e=oi(t);e.Co.forEach(function(t,n){ch(e.remoteStore,n)}),e.No.ts(),e.Co=new Map,e.Do=new ys(xi.comparator)}(n),n.$o=!1,[4,kh(n.remoteStore,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}})})}function Tl(t,e,n){return Object(Hr.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u,c,h,l,f,d,p;return Object(Hr.d)(this,function(m){switch(m.label){case 0:n=oi(t),r=[],i=[],o=0,s=e,m.label=1;case 1:return o<s.length?(u=void 0,(c=n.Vo.get(a=s[o]))&&0!==c.length?[4,gc(n.localStore,So(c[0]))]:[3,7]):[3,13];case 2:u=m.sent(),h=0,l=c,m.label=3;case 3:return h<l.length?(f=n.Po.get(l[h]),[4,vl(n,f)]):[3,6];case 4:(d=m.sent()).snapshot&&i.push(d.snapshot),m.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,bc(n.localStore,a)];case 8:return p=m.sent(),[4,gc(n.localStore,p)];case 9:return u=m.sent(),[4,Zh(n,_l(p),a,!1)];case 10:m.sent(),m.label=11;case 11:r.push(u),m.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}})})}function _l(t){return vo(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function El(t){var e=oi(t);return oi(oi(e.localStore).persistence).fn()}function Ol(t,e,n,r){return Object(Hr.b)(this,void 0,void 0,function(){var i,o,s;return Object(Hr.d)(this,function(a){switch(a.label){case 0:return(i=oi(t)).$o?(Zr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,wc(i.localStore)];case 3:return o=a.sent(),s=xs.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,ml(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,yc(i.localStore,e,!0)];case 6:return a.sent(),hl(i,e,r),[3,8];case 7:ri(),a.label=8;case 8:return[2]}})})}function Sl(t,e,n){return Object(Hr.b)(this,void 0,void 0,function(){var r,i,o,s,a,u,c,h,l;return Object(Hr.d)(this,function(f){switch(f.label){case 0:if(!(r=Al(t)).$o)return[3,10];i=0,o=e,f.label=1;case 1:return i<o.length?r.Vo.has(s=o[i])?(Zr("SyncEngine","Adding an already active target "+s),[3,5]):[4,bc(r.localStore,s)]:[3,6];case 2:return a=f.sent(),[4,gc(r.localStore,a)];case 3:return u=f.sent(),[4,Zh(r,_l(a),u.targetId,!1)];case 4:f.sent(),uh(r.remoteStore,u),f.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(Hr.d)(this,function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,yc(r.localStore,t,!1).then(function(){ch(r.remoteStore,t),hl(r,t)}).catch(Pu)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},h=0,l=n,f.label=7;case 7:return h<l.length?[5,c(l[h])]:[3,10];case 8:f.sent(),f.label=9;case 9:return h++,[3,7];case 10:return[2]}})})}function Al(t){var e=oi(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=nl.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=yl.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=il.bind(null,e),e.vo._r=Fh.bind(null,e.eventManager),e.vo.Mo=qh.bind(null,e.eventManager),e}function kl(t){var e=oi(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ol.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=sl.bind(null,e),e}var Dl=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(Hr.b)(this,void 0,void 0,function(){return Object(Hr.d)(this,function(e){switch(e.label){case 0:return this.R=$c(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Qo(t),[2]}})})},t.prototype.Uo=function(t){return null},t.prototype.Qo=function(t){return cc(this.persistence,new ac,t.initialUser,this.R)},t.prototype.qo=function(t){return new jc(Cc.bs,this.R)},t.prototype.Bo=function(t){return new Qc},t.prototype.terminate=function(){return Object(Hr.b)(this,void 0,void 0,function(){return Object(Hr.d)(this,function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}})})},t}(),Nl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Ko=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(Hr.c)(e,t),e.prototype.initialize=function(e){return Object(Hr.b)(this,void 0,void 0,function(){return Object(Hr.d)(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,Ic(this.localStore)];case 2:return n.sent(),[4,this.Ko.initialize(this,e)];case 3:return n.sent(),[4,kl(this.Ko.syncEngine)];case 4:return n.sent(),[4,Ih(this.Ko.remoteStore)];case 5:return n.sent(),[2]}})})},e.prototype.Qo=function(t){return cc(this.persistence,new ac,t.initialUser,this.R)},e.prototype.Uo=function(t){return new Fu(this.persistence.referenceDelegate.garbageCollector,t.asyncQueue)},e.prototype.qo=function(t){var e=rc(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Eu.withCacheSize(this.cacheSizeBytes):Eu.DEFAULT;return new tc(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,Yc(),Jc(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new Qc},e}(Dl),jl=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Ko=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(Hr.c)(e,t),e.prototype.initialize=function(e){return Object(Hr.b)(this,void 0,void 0,function(){var n,r=this;return Object(Hr.d)(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Ko.syncEngine,this.sharedClientState instanceof Kc?(this.sharedClientState.syncEngine={ui:wl.bind(null,n),ai:Ol.bind(null,n),hi:Sl.bind(null,n),fn:El.bind(null,n),ci:bl.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He(function(t){return Object(Hr.b)(r,void 0,void 0,function(){return Object(Hr.d)(this,function(e){switch(e.label){case 0:return[4,Il(this.Ko.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},e.prototype.Bo=function(t){var e=Yc();if(!Kc.yt(e))throw new Yr(Xr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=rc(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new Kc(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(Nl),xl=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(Hr.b)(this,void 0,void 0,function(){var n=this;return Object(Hr.d)(this,function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return rl(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=gl.bind(null,this.syncEngine),[4,kh(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.createEventManager=function(t){return new Ph},t.prototype.createDatastore=function(t){var e=$c(t.databaseInfo.databaseId),n=new Xc(t.databaseInfo);return function(t,e,n){return new rh(t,e,n)}(t.credentials,n,e)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,s=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return rl(s.syncEngine,t,0)},o=zc.yt()?new zc:new Gc,new oh(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){var a=new Jh(t,e,n,r,i,o);return s&&(a.$o=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return Object(Hr.b)(this,void 0,void 0,function(){var e;return Object(Hr.d)(this,function(n){switch(n.label){case 0:return e=oi(t),Zr("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,ah(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}})})}(this.remoteStore)},t}(),Cl=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),Rl=(function(){function t(t,e){var n=this;this.Go=t,this.R=e,this.metadata=new Ka,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then(function(t){t&&t.io()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}t.prototype.close=function(){return this.Go.cancel()},t.prototype.getMetadata=function(){return Object(Hr.b)(this,void 0,void 0,function(){return Object(Hr.d)(this,function(t){return[2,this.metadata.promise]})})},t.prototype.Lo=function(){return Object(Hr.b)(this,void 0,void 0,function(){return Object(Hr.d)(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Ho())]}})})},t.prototype.Ho=function(){return Object(Hr.b)(this,void 0,void 0,function(){var t,e,n,r;return Object(Hr.d)(this,function(i){switch(i.label){case 0:return[4,this.Jo()];case 1:return null===(t=i.sent())?[2,null]:(e=this.zo.decode(t),n=Number(e),isNaN(n)&&this.Yo("length string ("+e+") is not valid number"),[4,this.Xo(n)]);case 2:return r=i.sent(),[2,new Qh(JSON.parse(r),t.length+n)]}})})},t.prototype.Zo=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},t.prototype.Jo=function(){return Object(Hr.b)(this,void 0,void 0,function(){var t,e;return Object(Hr.d)(this,function(n){switch(n.label){case 0:return this.Zo()<0?[4,this.tc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.Zo())<0&&this.Yo("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}})})},t.prototype.Xo=function(t){return Object(Hr.b)(this,void 0,void 0,function(){var e;return Object(Hr.d)(this,function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.tc()]:[3,3];case 1:n.sent()&&this.Yo("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.zo.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}})})},t.prototype.Yo=function(t){throw this.Go.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.tc=function(){return Object(Hr.b)(this,void 0,void 0,function(){var t,e;return Object(Hr.d)(this,function(n){switch(n.label){case 0:return[4,this.Go.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}})})}}(),function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return Object(Hr.b)(this,void 0,void 0,function(){var e,n=this;return Object(Hr.d)(this,function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new Yr(Xr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(Hr.b)(this,void 0,void 0,function(){var n,r,i,o,s,a;return Object(Hr.d)(this,function(u){switch(u.label){case 0:return n=oi(t),r=ta(n.R)+"/documents",i={documents:e.map(function(t){return Ys(n.R,t)})},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=u.sent(),s=new Map,o.forEach(function(t){var e=function(t,e){return"found"in e?function(t,e){ii(!!e.found);var n=Js(t,e.found.name),r=Hs(e.found.updateTime),i=new Hi({mapValue:{fields:e.found.fields}});return Xi.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){ii(!!e.missing),ii(!!e.readTime);var n=Js(t,e.missing),r=Hs(e.readTime);return Xi.newNoDocument(n,r)}(t,e):ri()}(n.R,t);s.set(e.key.toString(),e)}),a=[],[2,(e.forEach(function(t){var e=s.get(t.toString());ii(!!e),a.push(e)}),a)]}})})}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach(function(t){return n.recordVersion(t)}),e)]}})})},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new fs(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return Object(Hr.b)(this,void 0,void 0,function(){var t,e=this;return Object(Hr.d)(this,function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=xi.fromPath(n);e.mutations.push(new ds(r,e.precondition(r)))}),[4,function(t,e){return Object(Hr.b)(this,void 0,void 0,function(){var n,r,i;return Object(Hr.d)(this,function(o){switch(o.label){case 0:return n=oi(t),r=ta(n.R)+"/documents",i={writes:e.map(function(t){return ia(n.R,t)})},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}})})},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw ri();e=fi.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Yr(Xr.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?Jo.updateTime(e):Jo.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(fi.min()))throw new Yr(Xr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Jo.updateTime(e)}return Jo.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}()),Vl=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new Zc(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji(function(){return Object(Hr.b)(t,void 0,void 0,function(){var t,e,n=this;return Object(Hr.d)(this,function(r){return t=new Rl(this.datastore),(e=this.sc(t))&&e.then(function(e){n.asyncQueue.enqueueAndForget(function(){return t.commit().then(function(){n.deferred.resolve(e)}).catch(function(t){n.ic(t)})})}).catch(function(t){n.ic(t)}),[2]})})})},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!Di(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget(function(){return e.nc(),Promise.resolve()})):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!ms(e)}return!1},t}(),Ul=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=Rc.UNAUTHENTICATED,this.clientId=ai.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,function(t){return Object(Hr.b)(r,void 0,void 0,function(){return Object(Hr.d)(this,function(e){switch(e.label){case 0:return Zr("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}})})})}return t.prototype.getConfiguration=function(){return Object(Hr.b)(this,void 0,void 0,function(){return Object(Hr.d)(this,function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]})})},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Yr(Xr.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new Ka;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(function(){return Object(Hr.b)(t,void 0,void 0,function(){var t,n;return Object(Hr.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=xh(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}})})}),e.promise},t}();function Pl(t,e){return Object(Hr.b)(this,void 0,void 0,function(){var n,r,i=this;return Object(Hr.d)(this,function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),Zr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener(function(t){return Object(Hr.b)(i,void 0,void 0,function(){return Object(Hr.d)(this,function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,hc(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}})})}),e.persistence.setDatabaseDeletedListener(function(){return t.terminate()}),t.offlineComponents=e,[2]}})})}function Ll(t,e){return Object(Hr.b)(this,void 0,void 0,function(){var n,r;return Object(Hr.d)(this,function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,Ml(t)];case 1:return n=i.sent(),Zr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener(function(t){return function(t,e){return Object(Hr.b)(this,void 0,void 0,function(){var n,r;return Object(Hr.d)(this,function(i){switch(i.label){case 0:return(n=oi(t)).asyncQueue.verifyOperationInProgress(),Zr("RemoteStore","RemoteStore received new credentials"),r=ph(n),n.Or.add(3),[4,ah(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,sh(n)];case 3:return i.sent(),[2]}})})}(e.remoteStore,t)}),t.onlineComponents=e,[2]}})})}function Ml(t){return Object(Hr.b)(this,void 0,void 0,function(){return Object(Hr.d)(this,function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(Zr("FirestoreClient","Using default OfflineComponentProvider"),[4,Pl(t,new Dl)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}})})}function Fl(t){return Object(Hr.b)(this,void 0,void 0,function(){return Object(Hr.d)(this,function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(Zr("FirestoreClient","Using default OnlineComponentProvider"),[4,Ll(t,new xl)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}})})}function ql(t){return Ml(t).then(function(t){return t.persistence})}function Bl(t){return Ml(t).then(function(t){return t.localStore})}function Kl(t){return Fl(t).then(function(t){return t.remoteStore})}function Ql(t){return Fl(t).then(function(t){return t.syncEngine})}function Gl(t){return Object(Hr.b)(this,void 0,void 0,function(){var e,n;return Object(Hr.d)(this,function(r){switch(r.label){case 0:return[4,Fl(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=$h.bind(null,e.syncEngine),n.onUnlisten=tl.bind(null,e.syncEngine),n)]}})})}function zl(t,e,n){var r=this;void 0===n&&(n={});var i=new Ka;return t.asyncQueue.enqueueAndForget(function(){return Object(Hr.b)(r,void 0,void 0,function(){var r;return Object(Hr.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Cl({next:function(o){e.enqueueAndForget(function(){return Mh(t,s)});var a=o.docs.has(n);!a&&o.fromCache?i.reject(new Yr(Xr.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new Yr(Xr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Kh(bo(n.path),o,{includeMetadataChanges:!0,so:!0});return Lh(t,s)},[4,Gl(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}})})}),i.promise}function Hl(t,e,n){var r=this;void 0===n&&(n={});var i=new Ka;return t.asyncQueue.enqueueAndForget(function(){return Object(Hr.b)(r,void 0,void 0,function(){var r;return Object(Hr.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Cl({next:function(n){e.enqueueAndForget(function(){return Mh(t,s)}),n.fromCache&&"server"===r.source?i.reject(new Yr(Xr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Kh(n,o,{includeMetadataChanges:!0,so:!0});return Lh(t,s)},[4,Gl(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}})})}),i.promise}var Wl=function(t,e,n,r,i,o,s,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=a},Xl=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Yl=new Map,Jl=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},$l=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable(function(){return e(Rc.UNAUTHENTICATED)})},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Zl=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable(function(){return e(n.token.user)})},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),tf=function(){function t(t){var e=this;this.currentUser=Rc.UNAUTHENTICATED,this.oc=new Ka,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable(function(){return e.changeListener(e.currentUser)})};var n=function(t){Zr("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit(function(t){return n(t)}),setTimeout(function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):(Zr("FirebaseCredentialsProvider","Auth not yet detected"),e.oc.resolve())}},0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.cc!==e?(Zr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(ii("string"==typeof n.accessToken),new Jl(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable(function(){return Object(Hr.b)(n,void 0,void 0,function(){return Object(Hr.d)(this,function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}})})})},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return ii(null===t||"string"==typeof t),new Rc(t)},t}(),ef=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=Rc.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),nf=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new ef(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable(function(){return e(Rc.FIRST_PARTY)})},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function rf(t,e,n){if(!n)throw new Yr(Xr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function of(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function sf(t,e,n,r){if(!0===e&&!0===r)throw new Yr(Xr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function af(t){if(!xi.isDocumentKey(t))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function uf(t){if(xi.isDocumentKey(t))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function cf(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":ri()}function hf(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Yr(Xr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=cf(t);throw new Yr(Xr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function lf(t,e){if(e<=0)throw new Yr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var ff=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Yr(Xr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Yr(Xr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,sf("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),df=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ff({}),this._settingsFrozen=!1,t instanceof Xl?(this._databaseId=t,this._credentials=new $l):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Yr(Xr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xl(t.options.projectId)}(t),this._credentials=new tf(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new Yr(Xr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new Yr(Xr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ff(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new $l;switch(t.type){case"gapi":var e=t.client;return ii(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new nf(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Yr(Xr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return(t=Yl.get(this))&&(Zr("ComponentProvider","Removing Datastore"),Yl.delete(this),t.terminate()),Promise.resolve();var t},t}(),pf=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new gf(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),mf=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),gf=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,bo(r))||this)._path=r,i.type="collection",i}return Object(Hr.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new pf(this.firestore,null,new xi(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(mf);function yf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Object(U.h)(t),rf("collection","path",e),t instanceof df)return uf(n=yi.fromString.apply(yi,Object(Hr.f)([e],r))),new gf(t,null,n);if(!(t instanceof pf||t instanceof gf))throw new Yr(Xr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return uf(n=yi.fromString.apply(yi,Object(Hr.f)([t.path],r)).child(yi.fromString(e))),new gf(t.firestore,null,n)}function vf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Object(U.h)(t),1===arguments.length&&(e=ai.u()),rf("doc","path",e),t instanceof df)return af(n=yi.fromString.apply(yi,Object(Hr.f)([e],r))),new pf(t,null,new xi(n));if(!(t instanceof pf||t instanceof gf))throw new Yr(Xr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return af(n=t._path.child(yi.fromString.apply(yi,Object(Hr.f)([e],r)))),new pf(t.firestore,t instanceof gf?t.converter:null,new xi(n))}function bf(t,e){return t=Object(U.h)(t),e=Object(U.h)(e),(t instanceof pf||t instanceof gf)&&(e instanceof pf||e instanceof gf)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function wf(t,e){return t=Object(U.h)(t),e=Object(U.h)(e),t instanceof mf&&e instanceof mf&&t.firestore===e.firestore&&ko(t._query,e._query)&&t.converter===e.converter}var If=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=[],this.Zi=new Zc(this,"async_queue_retry"),this.Tc=function(){var e=Jc();e&&Zr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=Jc();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Tc)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ic(),this.Ac(t)},t.prototype.enterRestrictedMode=function(){if(!this._c){this._c=!0;var t=Jc();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Tc)}},t.prototype.enqueue=function(t){return this.Ic(),this._c?new Promise(function(t){}):this.Ac(t)},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget(function(){return e.wc.push(t),e.Rc()})},t.prototype.Rc=function(){return Object(Hr.b)(this,void 0,void 0,function(){var t,e=this;return Object(Hr.d)(this,function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!Xa(t=n.sent()))throw t;return Zr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji(function(){return e.Rc()}),n.label=5;case 5:return[2]}})})},t.prototype.Ac=function(t){var e=this,n=this.dc.then(function(){return e.gc=!0,t().catch(function(t){throw e.yc=t,e.gc=!1,ti("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(function(t){return e.gc=!1,t})});return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ic(),this.Ec.indexOf(t)>-1&&(e=0);var i=jh.createAndSchedule(this,t,e,n,function(t){return r.bc(t)});return this.mc.push(i),i},t.prototype.Ic=function(){this.yc&&ri()},t.prototype.verifyOperationInProgress=function(){},t.prototype.vc=function(){return Object(Hr.b)(this,void 0,void 0,function(){var t;return Object(Hr.d)(this,function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.Pc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Vc=function(t){var e=this;return this.vc().then(function(){e.mc.sort(function(t,e){return t.targetTimeMs-e.targetTimeMs});for(var n=0,r=e.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.vc()})},t.prototype.Sc=function(t){this.Ec.push(t)},t.prototype.bc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}();function Tf(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}!function(){function t(){this._progressObserver={},this._taskCompletionResolver=new Ka,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}t.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},t.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},t.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},t.prototype._failWith=function(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},t.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)}}();var _f=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new If,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return Object(Hr.c)(e,t),e.prototype._terminate=function(){return this._firestoreClient||Of(this),this._firestoreClient.terminate()},e}(df);function Ef(t){return t._firestoreClient||Of(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Of(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new Wl(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new Ul(t._credentials,t._queue,r)}function Sf(t,e,n){var r=this,i=new Ka;return t.asyncQueue.enqueue(function(){return Object(Hr.b)(r,void 0,void 0,function(){var r;return Object(Hr.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,Pl(t,n)];case 1:return o.sent(),[4,Ll(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===Xr.FAILED_PRECONDITION||t.code===Xr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function Af(t){if(t._initialized||t._terminated)throw new Yr(Xr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var kf=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bi(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),Df=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(Ii.fromBase64String(e))}catch(e){throw new Yr(Xr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(Ii.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),Nf=function(t){this._methodName=t},jf=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Yr(Xr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Yr(Xr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return ui(this._lat,t._lat)||ui(this._long,t._long)},t}(),xf=/^__.*__$/,Cf=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new ss(t,this.data,this.fieldMask,e,this.fieldTransforms):new os(t,this.data,e,this.fieldTransforms)},t}(),Rf=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new ss(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();function Vf(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ri()}}var Uf=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Dc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Cc",{get:function(){return this.settings.Cc},enumerable:!1,configurable:!0}),t.prototype.Nc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.xc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.kc(t),r},t.prototype.$c=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.Dc(),r},t.prototype.Oc=function(t){return this.Nc({path:void 0,Fc:!0})},t.prototype.Mc=function(t){return nd(t,this.settings.methodName,this.settings.Lc||!1,this.path,this.settings.Bc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find(function(e){return t.isPrefixOf(e)})||void 0!==this.fieldTransforms.find(function(e){return t.isPrefixOf(e.field)})},t.prototype.Dc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.kc(this.path.get(t))},t.prototype.kc=function(t){if(0===t.length)throw this.Mc("Document fields must not be empty");if(Vf(this.Cc)&&xf.test(t))throw this.Mc('Document fields cannot begin and end with "__"')},t}(),Pf=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||$c(t)}return t.prototype.qc=function(t,e,n,r){return void 0===r&&(r=!1),new Uf({Cc:t,methodName:e,Bc:n,path:bi.emptyPath(),Fc:!1,Lc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function Lf(t){var e=t._freezeSettings(),n=$c(t._databaseId);return new Pf(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Mf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.qc(o.merge||o.mergeFields?2:0,e,n,i);$f("Data must be an object, but it was:",s,r);var a,u,c=Yf(r,s);if(o.merge)a=new wi(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var d=Zf(e,f[l],n);if(!s.contains(d))throw new Yr(Xr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");rd(h,d)||h.push(d)}a=new wi(h),u=s.fieldTransforms.filter(function(t){return a.covers(t.field)})}else a=null,u=s.fieldTransforms;return new Cf(new Hi(c),a,u)}var Ff=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Hr.c)(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Cc)throw t.Mc(1===t.Cc?this._methodName+"() can only appear at the top level of your update data":this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Nf);function qf(t,e,n){return new Uf({Cc:3,Bc:e.settings.Bc,methodName:t._methodName,Fc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var Bf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Hr.c)(e,t),e.prototype._toFieldTransform=function(t){return new Xo(t.path,new qo)},e.prototype.isEqual=function(t){return t instanceof e},e}(Nf),Kf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return Object(Hr.c)(e,t),e.prototype._toFieldTransform=function(t){var e=qf(this,t,!0),n=this.Uc.map(function(t){return Xf(t,e)}),r=new Bo(n);return new Xo(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Nf),Qf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return Object(Hr.c)(e,t),e.prototype._toFieldTransform=function(t){var e=qf(this,t,!0),n=this.Uc.map(function(t){return Xf(t,e)}),r=new Qo(n);return new Xo(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Nf),Gf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Qc=n,r}return Object(Hr.c)(e,t),e.prototype._toFieldTransform=function(t){var e=new zo(t.R,Uo(t.R,this.Qc));return new Xo(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Nf);function zf(t,e,n,r){var i=t.qc(1,e,n);$f("Data must be an object, but it was:",i,r);var o=[],s=Hi.empty();pi(r,function(t,r){var a=ed(e,t,n);r=Object(U.h)(r);var u=i.$c(a);if(r instanceof Ff)o.push(a);else{var c=Xf(r,u);null!=c&&(o.push(a),s.set(a,c))}});var a=new wi(o);return new Rf(s,a,i.fieldTransforms)}function Hf(t,e,n,r,i,o){var s=t.qc(1,e,n),a=[Zf(e,r,n)],u=[i];if(o.length%2!=0)throw new Yr(Xr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(Zf(e,o[c])),u.push(o[c+1]);for(var h=[],l=Hi.empty(),f=a.length-1;f>=0;--f)if(!rd(h,a[f])){var d=a[f],p=u[f];p=Object(U.h)(p);var m=s.$c(d);if(p instanceof Ff)h.push(d);else{var g=Xf(p,m);null!=g&&(h.push(d),l.set(d,g))}}var y=new wi(h);return new Rf(l,y,s.fieldTransforms)}function Wf(t,e,n,r){return void 0===r&&(r=!1),Xf(n,t.qc(r?4:3,e))}function Xf(t,e){if(Jf(t=Object(U.h)(t)))return $f("Unsupported field value:",e,t),Yf(t,e);if(t instanceof Nf)return function(t,e){if(!Vf(e.Cc))throw e.Mc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Mc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Fc&&4!==e.Cc)throw e.Mc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Xf(o[i],e.Oc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=Object(U.h)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Uo(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=li.fromDate(t);return{timestampValue:Qs(e.R,n)}}if(t instanceof li)return n=new li(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Qs(e.R,n)};if(t instanceof jf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Df)return{bytesValue:Gs(e.R,t._byteString)};if(t instanceof pf){var r=t.firestore._databaseId;if(!r.isEqual(n=e.databaseId))throw e.Mc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Ws(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Mc("Unsupported field value: "+cf(t))}(t,e)}function Yf(t,e){var n={};return mi(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):pi(t,function(t,r){var i=Xf(r,e.xc(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function Jf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof li||t instanceof jf||t instanceof Df||t instanceof pf||t instanceof Nf)}function $f(t,e,n){if(!Jf(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=cf(n);throw e.Mc("an object"===r?t+" a custom object":t+" "+r)}}function Zf(t,e,n){if((e=Object(U.h)(e))instanceof kf)return e._internalPath;if("string"==typeof e)return ed(t,e);throw nd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var td=new RegExp("[~\\*/\\[\\]]");function ed(t,e,n){if(e.search(td)>=0)throw nd("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(kf.bind.apply(kf,Object(Hr.f)([void 0],e.split(".")))))._internalPath}catch(r){throw nd("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function nd(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new Yr(Xr.INVALID_ARGUMENT,(a+=". ")+t+u)}function rd(t,e){return t.some(function(t){return t.isEqual(e)})}var id=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new pf(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new od(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(sd("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),od=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Hr.c)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(id);function sd(t,e){return"string"==typeof e?ed(t,e):e instanceof kf?e._internalPath:e._delegate._internalPath}var ad=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),ud=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this)._firestore=e,a._firestoreImpl=e,a.metadata=o,a}return Object(Hr.c)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new cd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(sd("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(id),cd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Hr.c)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(ud),hd=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new ad(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach(function(r){t.call(e,new cd(n._firestore,n._userDataWriter,r.key,r,new ad(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))})},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Yr(Xr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map(function(e){return{type:"added",doc:new cd(t._firestore,t._userDataWriter,e.doc.key,e.doc,new ad(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}})}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new cd(t._firestore,t._userDataWriter,e.doc.key,e.doc,new ad(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:ld(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function ld(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ri()}}function fd(t,e){return t instanceof ud&&e instanceof ud?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof hd&&e instanceof hd&&t._firestore===e._firestore&&wf(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function dd(t){if(Io(t)&&0===t.explicitOrderBy.length)throw new Yr(Xr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var pd=function(){};function md(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var gd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Kc=e,i.jc=n,i.Wc=r,i.type="where",i}return Object(Hr.c)(e,t),e.prototype._apply=function(t){var e=Lf(t.firestore),n=function(t,e,n,r,i,o,s){var a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){_d(s,o);for(var u=[],c=0,h=s;c<h.length;c++)u.push(Td(r,t,h[c]));a={arrayValue:{values:u}}}else a=Td(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||_d(s,o),a=Wf(n,"where",s,"in"===o||"not-in"===o);var l=eo.create(i,o,a);return function(t,e){if(e.g()){var n=_o(t);if(null!==n&&!n.isEqual(e.field))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=To(t);null!==r&&Ed(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new Yr(Xr.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,l),l}(t._query,0,e,t.firestore._databaseId,this.Kc,this.jc,this.Wc);return new mf(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new yo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(pd),yd=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Kc=e,r.Gc=n,r.type="orderBy",r}return Object(Hr.c)(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new fo(e,n);return function(t,e){if(null===To(t)){var n=_o(t);null!==n&&Ed(0,n,e.field)}}(t,r),r}(t._query,this.Kc,this.Gc);return new mf(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new yo(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(pd),vd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.zc=n,i.Hc=r,i}return Object(Hr.c)(e,t),e.prototype._apply=function(t){return new mf(t.firestore,t.converter,Ao(t._query,this.zc,this.Hc))},e}(pd),bd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return Object(Hr.c)(e,t),e.prototype._apply=function(t){var e=Id(t,this.type,this.Jc,this.Yc);return new mf(t.firestore,t.converter,function(t,e){return new yo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(pd),wd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return Object(Hr.c)(e,t),e.prototype._apply=function(t){var e=Id(t,this.type,this.Jc,this.Yc);return new mf(t.firestore,t.converter,function(t,e){return new yo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(pd);function Id(t,e,n,r){if(n[0]=Object(U.h)(n[0]),n[0]instanceof id)return function(t,e,n,r,i){if(!r)throw new Yr(Xr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=Oo(t);s<a.length;s++){var u=a[s];if(u.field.isKeyField())o.push(Fi(e,r.key));else{var c=r.data.field(u.field);if(Si(c))throw new Yr(Xr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=u.field.canonicalString();throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new ho(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=Lf(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new Yr(Xr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Eo(t)&&-1!==c.indexOf("/"))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(yi.fromString(c));if(!xi.isDocumentKey(h))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var l=new xi(h);a.push(Fi(e,l))}else{var f=Wf(n,r,c);a.push(f)}}return new ho(a,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function Td(t,e,n){if("string"==typeof(n=Object(U.h)(n))){if(""===n)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Eo(e)&&-1!==n.indexOf("/"))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(yi.fromString(n));if(!xi.isDocumentKey(r))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Fi(t,new xi(r))}if(n instanceof pf)return Fi(t,n._key);throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+cf(n)+".")}function _d(t,e){if(!Array.isArray(t)||0===t.length)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Ed(t,e,n){if(!n.isEqual(e))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}var Od=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),Ci(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ei(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Oi(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw ri()}},t.prototype.convertObject=function(t,e){var n=this,r={};return pi(t.fields,function(t,i){r[t]=n.convertValue(i,e)}),r},t.prototype.convertGeoPoint=function(t){return new jf(Ei(t.latitude),Ei(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.convertValue(t,e)})},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=Ai(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(ki(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=_i(t);return new li(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=yi.fromString(t);ii(ba(n));var r=new Xl(n.get(1),n.get(3)),i=new xi(n.popFirst(5));return r.isEqual(e)||ti("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();function Sd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Ad=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(Hr.c)(e,t),e.prototype.convertBytes=function(t){return new Df(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new pf(this.firestore,null,e)},e}(Od),kd=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=Lf(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=Dd(t,this._firestore),i=Sd(r.converter,e,n),o=Mf(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,Jo.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=Dd(t,this._firestore);return o="string"==typeof(e=Object(U.h)(e))||e instanceof kf?Hf(this._dataReader,"WriteBatch.update",s._key,e,n,r):zf(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(o.toMutation(s._key,Jo.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=Dd(t,this._firestore);return this._mutations=this._mutations.concat(new fs(e._key,Jo.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new Yr(Xr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function Dd(t,e){if((t=Object(U.h)(t)).firestore!==e)throw new Yr(Xr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Nd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(Hr.c)(e,t),e.prototype.convertBytes=function(t){return new Df(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new pf(this.firestore,null,e)},e}(Od);function jd(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=hf(t,pf);var o=hf(t.firestore,_f),s=Lf(o);return Cd(o,[("string"==typeof(e=Object(U.h)(e))||e instanceof kf?Hf(s,"updateDoc",t._key,e,n,r):zf(s,"updateDoc",t._key,e)).toMutation(t._key,Jo.exists(!0))])}function xd(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t=Object(U.h)(t);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||Tf(i[a])||(s=i[a],a++);var u,c,h,l={includeMetadataChanges:s.includeMetadataChanges};if(Tf(i[a])){var f=i[a];i[a]=null===(e=f.next)||void 0===e?void 0:e.bind(f),i[a+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),i[a+2]=null===(r=f.complete)||void 0===r?void 0:r.bind(f)}if(t instanceof pf)c=hf(t.firestore,_f),h=bo(t._key.path),u={next:function(e){i[a]&&i[a](Rd(c,t,e))},error:i[a+1],complete:i[a+2]};else{var d=hf(t,mf);c=hf(d.firestore,_f),h=d._query;var p=new Nd(c);u={next:function(t){i[a]&&i[a](new hd(c,p,d,t))},error:i[a+1],complete:i[a+2]},dd(t._query)}return function(t,e,n,r){var i=this,o=new Cl(r),s=new Kh(e,o,n);return t.asyncQueue.enqueueAndForget(function(){return Object(Hr.b)(i,void 0,void 0,function(){var e;return Object(Hr.d)(this,function(n){switch(n.label){case 0:return e=Lh,[4,Gl(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})}),function(){o.Wo(),t.asyncQueue.enqueueAndForget(function(){return Object(Hr.b)(i,void 0,void 0,function(){var e;return Object(Hr.d)(this,function(n){switch(n.label){case 0:return e=Mh,[4,Gl(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})})}}(Ef(c),h,l,u)}function Cd(t,e){return function(t,e){var n=this,r=new Ka;return t.asyncQueue.enqueueAndForget(function(){return Object(Hr.b)(n,void 0,void 0,function(){var n;return Object(Hr.d)(this,function(i){switch(i.label){case 0:return n=el,[4,Ql(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(Ef(t),e)}function Rd(t,e,n){var r=n.docs.get(e._key),i=new Nd(t);return new ud(t,i,e._key,r,new ad(n.hasPendingWrites,n.fromCache),e.converter)}var Vd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return Object(Hr.c)(e,t),e.prototype.get=function(e){var n=this,r=Dd(e,this._firestore),i=new Nd(this._firestore);return t.prototype.get.call(this,e).then(function(t){return new ud(n._firestore,i,r._key,t._document,new ad(!1,!1),r.converter)})},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=Lf(t)}return t.prototype.get=function(t){var e=this,n=Dd(t,this._firestore),r=new Ad(this._firestore);return this._transaction.lookup([n._key]).then(function(t){if(!t||1!==t.length)return ri();var i=t[0];if(i.isFoundDocument())return new id(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new id(e._firestore,r,n._key,null,n.converter);throw ri()})},t.prototype.set=function(t,e,n){var r=Dd(t,this._firestore),i=Sd(r.converter,e,n),o=Mf(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=Dd(t,this._firestore);return o="string"==typeof(e=Object(U.h)(e))||e instanceof kf?Hf(this._dataReader,"Transaction.update",s._key,e,n,r):zf(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this},t.prototype.delete=function(t){var e=Dd(t,this._firestore);return this._transaction.delete(e._key),this},t}());function Ud(){if("undefined"==typeof Uint8Array)throw new Yr(Xr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Pd(){if("undefined"==typeof atob)throw new Yr(Xr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Ld=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return Pd(),new t(Df.fromBase64String(e))},t.fromUint8Array=function(e){return Ud(),new t(Df.fromUint8Array(e))},t.prototype.toBase64=function(){return Pd(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return Ud(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),Md=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Af(t=hf(t,_f));var n=Ef(t),r=t._freezeSettings(),i=new xl;return Sf(n,i,new Nl(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Af(t=hf(t,_f));var e=Ef(t),n=t._freezeSettings(),r=new xl;return Sf(e,r,new jl(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new Yr(Xr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Ka;return t._queue.enqueueAndForgetEvenWhileRestricted(function(){return Object(Hr.b)(e,void 0,void 0,function(){var e;return Object(Hr.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(Hr.b)(this,void 0,void 0,function(){return Object(Hr.d)(this,function(e){switch(e.label){case 0:return za.yt()?[4,za.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}})})}(rc(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise}(t._delegate)},t}(),Fd=function(){function t(t,e,n){var r=this;this._delegate=e,this.Xc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof Xl||(this.Zc=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||ei("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={});var i=(t=hf(t,df))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==e&&ei("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:e+":"+n,ssl:!1})),r.mockUserToken){var o=Object(U.d)(r.mockUserToken),s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new Yr(Xr.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");t._credentials=new Zl(new Jl(o,new Rc(s)))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue(function(){return Object(Hr.b)(e,void 0,void 0,function(){var e,n;return Object(Hr.d)(this,function(r){switch(r.label){case 0:return[4,ql(t)];case 1:return e=r.sent(),[4,Kl(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=oi(t);return e.Or.delete(0),sh(e)}(n))]}})})})}(Ef(hf(this._delegate,_f)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue(function(){return Object(Hr.b)(e,void 0,void 0,function(){var e,n;return Object(Hr.d)(this,function(r){switch(r.label){case 0:return[4,ql(t)];case 1:return e=r.sent(),[4,Kl(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return Object(Hr.b)(this,void 0,void 0,function(){var e;return Object(Hr.d)(this,function(n){switch(n.label){case 0:return(e=oi(t)).Or.add(0),[4,ah(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}})})}(n))]}})})})}(Ef(hf(this._delegate,_f)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&sf("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Xc.enableMultiTabIndexedDbPersistence(this):this.Xc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Xc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.Zc&&(this.Zc._removeServiceInstance("firestore"),this.Zc._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new Ka;return t.asyncQueue.enqueueAndForget(function(){return Object(Hr.b)(e,void 0,void 0,function(){var e;return Object(Hr.d)(this,function(r){switch(r.label){case 0:return e=al,[4,Ql(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}})})}),n.promise}(Ef(hf(this._delegate,_f)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new Cl(e);return t.asyncQueue.enqueueAndForget(function(){return Object(Hr.b)(n,void 0,void 0,function(){var e;return Object(Hr.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){oi(t).Gr.add(e),e.next()},[4,Gl(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})}),function(){r.Wo(),t.asyncQueue.enqueueAndForget(function(){return Object(Hr.b)(n,void 0,void 0,function(){var e;return Object(Hr.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){oi(t).Gr.delete(e)},[4,Gl(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})})}}(Ef(t=hf(t,_f)),Tf(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.Zc)throw new Yr(Xr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Zc},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new tp(this,yf(this._delegate,t))}catch(t){throw zd(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new Gd(this,vf(this._delegate,t))}catch(t){throw zd(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new Jd(this,function(t,e){if(t=hf(t,df),rf("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new mf(t,null,function(t){return new yo(yi.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw zd(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new Ka;return t.asyncQueue.enqueueAndForget(function(){return Object(Hr.b)(n,void 0,void 0,function(){var n;return Object(Hr.d)(this,function(i){switch(i.label){case 0:return[4,function(t){return Fl(t).then(function(t){return t.datastore})}(t)];case 1:return n=i.sent(),new Vl(t.asyncQueue,n,e,r).run(),[2]}})})}),r.promise}(Ef(t),function(n){return e(new Vd(t,n))})}(this._delegate,function(n){return t(new Bd(e,n))})},t.prototype.batch=function(){var t=this;return Ef(this._delegate),new Kd(new kd(this._delegate,function(e){return Cd(t._delegate,e)}))},t.prototype.loadBundle=function(t){throw new Yr(Xr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new Yr(Xr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),qd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(Hr.c)(e,t),e.prototype.convertBytes=function(t){return new Ld(new Df(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return Gd.tu(e,this.firestore,null)},e}(Od),Bd=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new qd(t)}return t.prototype.get=function(t){var e=this,n=ep(t);return this._delegate.get(n).then(function(t){return new Xd(e._firestore,new ud(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))})},t.prototype.set=function(t,e,n){var r=ep(t);return n?(of("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=ep(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Object(Hr.f)([s,e,n],i)),this},t.prototype.delete=function(t){var e=ep(t);return this._delegate.delete(e),this},t}(),Kd=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=ep(t);return n?(of("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=ep(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Object(Hr.f)([s,e,n],i)),this},t.prototype.delete=function(t){var e=ep(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),Qd=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new cd(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new Yd(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.eu=function(e,n){var r=t.nu,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new qd(e),n),i.set(n,o)),o},t}();Qd.nu=new WeakMap;var Gd=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new qd(t)}return t.su=function(e,n,r){if(e.length%2!=0)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new pf(n._delegate,r,new xi(e)))},t.tu=function(e,n,r){return new t(n,new pf(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new tp(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new tp(this.firestore,yf(this._delegate,t))}catch(t){throw zd(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=Object(U.h)(t))instanceof pf&&bf(this._delegate,t)},t.prototype.set=function(t,e){e=of("DocumentReference.set",e);try{return function(t,e,n){t=hf(t,pf);var r=hf(t.firestore,_f),i=Sd(t.converter,e,n);return Cd(r,[Mf(Lf(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,Jo.none())])}(this._delegate,t,e)}catch(t){throw zd(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?jd(this._delegate,t):jd.apply(void 0,Object(Hr.f)([this._delegate,t,e],n))}catch(t){throw zd(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return Cd(hf((t=this._delegate).firestore,_f),[new fs(t._key,Jo.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Hd(e),i=Wd(e,function(e){return new Xd(t.firestore,new ud(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))});return xd(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=hf(t,pf);var e=hf(t.firestore,_f),n=Ef(e),r=new Nd(e);return function(t,e){var n=this,r=new Ka;return t.asyncQueue.enqueueAndForget(function(){return Object(Hr.b)(n,void 0,void 0,function(){var n;return Object(Hr.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(Hr.b)(this,void 0,void 0,function(){var r,i;return Object(Hr.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=oi(t);return n.persistence.runTransaction("read document","readonly",function(t){return n.Mn.mn(t,e)})}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new Yr(Xr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=xh(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}})})},[4,Bl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t._key).then(function(n){return new ud(e,r,t._key,n,new ad(null!==n&&n.hasLocalMutations,!0),t.converter)})}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=hf(t,pf);var e=hf(t.firestore,_f);return zl(Ef(e),t._key,{source:"server"}).then(function(n){return Rd(e,t,n)})}(this._delegate):function(t){t=hf(t,pf);var e=hf(t.firestore,_f);return zl(Ef(e),t._key).then(function(n){return Rd(e,t,n)})}(this._delegate)).then(function(t){return new Xd(e.firestore,new ud(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))})},t.prototype.withConverter=function(e){return new t(this.firestore,this._delegate.withConverter(e?Qd.eu(this.firestore,e):null))},t}();function zd(t,e,n){return t.message=t.message.replace(e,n),t}function Hd(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Tf(r))return r}return{}}function Wd(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=Tf(t[0])?t[0]:Tf(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Xd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new Gd(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return fd(this._delegate,t._delegate)},t}(),Yd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(Hr.c)(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(Xd),Jd=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new qd(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,md(this._delegate,function(t,e,n){var r=e,i=sd("where",t);return new gd(i,r,n)}(e,n,r)))}catch(e){throw zd(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,md(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=sd("orderBy",t);return new yd(r,n)}(e,n)))}catch(e){throw zd(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,md(this._delegate,function(t){return lf("limit",t),new vd("limit",t,"F")}(e)))}catch(e){throw zd(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,md(this._delegate,function(t){return lf("limitToLast",t),new vd("limitToLast",t,"L")}(e)))}catch(e){throw zd(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,md(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new bd("startAt",t,!0)}).apply(void 0,e)))}catch(e){throw zd(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,md(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new bd("startAfter",t,!1)}).apply(void 0,e)))}catch(e){throw zd(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,md(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new wd("endBefore",t,!0)}).apply(void 0,e)))}catch(e){throw zd(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,md(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new wd("endAt",t,!1)}).apply(void 0,e)))}catch(e){throw zd(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return wf(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=hf(t,mf);var e=hf(t.firestore,_f),n=Ef(e),r=new Nd(e);return function(t,e){var n=this,r=new Ka;return t.asyncQueue.enqueueAndForget(function(){return Object(Hr.b)(n,void 0,void 0,function(){var n;return Object(Hr.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(Hr.b)(this,void 0,void 0,function(){var r,i,o,s,a;return Object(Hr.d)(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,vc(t,e,!0)];case 1:return a=u.sent(),r=new Wh(e,a.Bn),i=r._o(a.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=u.sent(),a=xh(s,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}})})},[4,Bl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t._query).then(function(n){return new hd(e,r,t,n)})}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=hf(t,mf);var e=hf(t.firestore,_f),n=Ef(e),r=new Nd(e);return Hl(n,t._query,{source:"server"}).then(function(n){return new hd(e,r,t,n)})}(this._delegate):function(t){t=hf(t,mf);var e=hf(t.firestore,_f),n=Ef(e),r=new Nd(e);return dd(t._query),Hl(n,t._query).then(function(n){return new hd(e,r,t,n)})}(this._delegate)).then(function(t){return new Zd(e.firestore,new hd(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))})},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Hd(e),i=Wd(e,function(e){return new Zd(t.firestore,new hd(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))});return xd(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,this._delegate.withConverter(e?Qd.eu(this.firestore,e):null))},t}(),$d=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new Yd(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),Zd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new Jd(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map(function(e){return new Yd(t._firestore,e)})},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map(function(t){return new $d(e._firestore,t)})},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach(function(r){t.call(e,new Yd(n._firestore,r))})},t.prototype.isEqual=function(t){return fd(this._delegate,t._delegate)},t}(),tp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return Object(Hr.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new Gd(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Gd(this.firestore,void 0===t?vf(this._delegate):vf(this._delegate,t))}catch(t){throw zd(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=hf(t.firestore,_f),r=vf(t),i=Sd(t.converter,e);return Cd(n,[Mf(Lf(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,Jo.exists(!1))]).then(function(){return r})}(this._delegate,t).then(function(t){return new Gd(e.firestore,t)})},e.prototype.isEqual=function(t){return bf(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,this._delegate.withConverter(t?Qd.eu(this.firestore,t):null))},e}(Jd);function ep(t){return hf(t,pf)}var np,rp=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(kf.bind.apply(kf,Object(Hr.f)([void 0],t)))}return t.documentId=function(){return new t(bi.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=Object(U.h)(t))instanceof kf&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),ip=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new Bf("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new Ff("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Kf("arrayUnion",t)}).apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Qf("arrayRemove",t)}).apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new Gf("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}(),op=n("/6Yf"),sp={Firestore:Fd,GeoPoint:jf,Timestamp:li,Blob:Ld,Transaction:Bd,WriteBatch:Kd,DocumentReference:Gd,DocumentSnapshot:Xd,Query:Jd,QueryDocumentSnapshot:Yd,QuerySnapshot:Zd,CollectionReference:tp,FieldPath:rp,FieldValue:ip,setLogLevel:function(t){Jr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new op.a("firestore",function(t){return function(t,e){return new Fd(t,new _f(t,e),new Md)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},sp)))})(np=V.a),np.registerVersion("@firebase/firestore","2.3.7");var ap=n("UbJi");function up(t,e){return function(t,e=T.b){return new _.a(n=>{let r;return null!=e?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{null!=r&&r()}})}(t,e)}function cp(t,e){return up(t,e).pipe(Object(k.a)(t=>({payload:t,type:"query"})))}function hp(t,e){return cp(t,e).pipe(Object(S.a)(void 0),Object(A.a)(),Object(k.a)(([t,e])=>{const n=e.payload.docChanges(),r=n.map(t=>({type:t.type,payload:t}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(e.payload.metadata)&&e.payload.docs.forEach((e,i)=>{const o=n.find(t=>t.doc.ref.isEqual(e.ref)),s=null==t?void 0:t.payload.docs.find(t=>t.ref.isEqual(e.ref));o&&JSON.stringify(o.doc.metadata)===JSON.stringify(e.metadata)||!o&&s&&JSON.stringify(s.metadata)===JSON.stringify(e.metadata)||r.push({type:"modified",payload:{oldIndex:i,newIndex:i,type:"modified",doc:e}})}),r}))}function lp(t,e,n){return hp(t,n).pipe(Object(D.a)((t,n)=>function(t,e,n){return e.forEach(e=>{n.indexOf(e.type)>-1&&(t=function(t,e){switch(e.type){case"added":if(!t[e.newIndex]||!t[e.newIndex].doc.ref.isEqual(e.doc.ref))return fp(t,e.newIndex,0,e);break;case"modified":if(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}return fp(t,e.newIndex,1,e)}break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return fp(t,e.oldIndex,1)}return t}(t,e))}),t}(t,n.map(t=>t.payload),e),[]),Object(N.a)(),Object(k.a)(t=>t.map(t=>({type:t.type,payload:t}))))}function fp(t,e,n,...r){const i=t.slice();return i.splice(e,n,...r),i}function dp(t){return t&&0!==t.length||(t=["added","removed","modified"]),t}class pp{constructor(t,e,n){this.ref=t,this.query=e,this.afs=n}stateChanges(t){let e=hp(this.query,this.afs.schedulers.outsideAngular);return t&&t.length>0&&(e=e.pipe(Object(k.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)))),e.pipe(Object(S.a)(void 0),Object(A.a)(),Object(j.a)(([t,e])=>e.length>0||!t),Object(k.a)(([t,e])=>e),this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(D.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=dp(t);return lp(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return cp(this.query,this.afs.schedulers.outsideAngular).pipe(Object(k.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(E.a)(this.query.get(t)).pipe(Object(x.b)(this.afs.schedulers.insideAngular))}add(t){return this.ref.add(t)}doc(t){return new mp(this.ref.doc(t),this.afs)}}class mp{constructor(t,e){this.ref=t,this.afs=e}set(t,e){return this.ref.set(t,e)}update(t){return this.ref.update(t)}delete(){return this.ref.delete()}collection(t,e){const n=this.ref.collection(t),{ref:r,query:i}=Ip(n,e);return new pp(r,i,this.afs)}snapshotChanges(){return up(this.ref,this.afs.schedulers.outsideAngular).pipe(Object(S.a)(void 0),Object(A.a)(),Object(k.a)(([t,e])=>e.exists?(null==t?void 0:t.exists)?{payload:e,type:"modified"}:{payload:e,type:"added"}:{payload:e,type:"removed"})).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return this.snapshotChanges().pipe(Object(k.a)(({payload:e})=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data()))}get(t){return Object(E.a)(this.ref.get(t)).pipe(Object(x.b)(this.afs.schedulers.insideAngular))}}class gp{constructor(t,e){this.query=t,this.afs=e}stateChanges(t){return t&&0!==t.length?hp(this.query,this.afs.schedulers.outsideAngular).pipe(Object(k.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)),Object(j.a)(t=>t.length>0),this.afs.keepUnstableUntilFirst):hp(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(D.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=dp(t);return lp(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return cp(this.query,this.afs.schedulers.outsideAngular).pipe(Object(k.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign({[t.idField]:e.id},e.data()):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(E.a)(this.query.get(t)).pipe(Object(x.b)(this.afs.schedulers.insideAngular))}}const yp=new i.s("angularfire2.enableFirestorePersistence"),vp=new i.s("angularfire2.firestore.persistenceSettings"),bp=new i.s("angularfire2.firestore.settings"),wp=new i.s("angularfire2.firestore.use-emulator");function Ip(t,e=(t=>t)){return{query:e(t),ref:t}}let Tp=(()=>{class t{constructor(t,e,n,i,o,s,a,u,c){this.schedulers=new C.d(s),this.keepUnstableUntilFirst=Object(C.h)(this.schedulers);const h=Object(C.g)(t,s,e);!R.a.auth&&c&&Object(C.j)();const l=u;[this.firestore,this.persistenceEnabled$]=Object(C.f)(`${h.name}.firestore`,"AngularFirestore",h,()=>{const t=s.runOutsideAngular(()=>h.firestore());if(i&&t.settings(i),l&&t.useEmulator(...l),n&&!Object(r.u)(o)){const e=()=>{try{return Object(E.a)(t.enablePersistence(a||void 0).then(()=>!0,()=>!1))}catch(np){return"undefined"!=typeof console&&console.warn(np),Object(O.a)(!1)}};return[t,s.runOutsideAngular(e)]}return[t,Object(O.a)(!1)]},[i,l,n])}collection(t,e){let n;n="string"==typeof t?this.firestore.collection(t):t;const{ref:r,query:i}=Ip(n,e),o=this.schedulers.ngZone.run(()=>r);return new pp(o,i,this)}collectionGroup(t,e){const n=e||(t=>t),r=this.firestore.collectionGroup(t);return new gp(n(r),this)}doc(t){let e;e="string"==typeof t?this.firestore.doc(t):t;const n=this.schedulers.ngZone.run(()=>e);return new mp(n,this)}createId(){return this.firestore.collection("_").doc().id}}return t.\u0275fac=function(e){return new(e||t)(i.Zb(C.c),i.Zb(C.b,8),i.Zb(yp,8),i.Zb(bp,8),i.Zb(i.D),i.Zb(i.B),i.Zb(vp,8),i.Zb(wp,8),i.Zb(ap.b,8))},t.\u0275prov=i.Lb({factory:function(){return new t(i.Zb(C.c),i.Zb(C.b,8),i.Zb(yp,8),i.Zb(bp,8),i.Zb(i.D),i.Zb(i.B),i.Zb(vp,8),i.Zb(wp,8),i.Zb(ap.b,8))},token:t,providedIn:"any"}),t})();var _p=n("kmnG"),Ep=n("qFsG");let Op=(()=>{class t{constructor(t,e,n,r){this.dialogRef=t,this.data=e,this.db=n,this.auth=r,this.userData={}}ngOnInit(){this.auth.user.subscribe(t=>{this.userData=t})}saveData(){if(this.loading=!0,null==this.data.id){let t=(new Date).getTime().toString();this.data.uid=this.userData.uid,this.db.collection("comments").doc(t).set(this.data).then(t=>{this.dialogRef.close(this.data),this.loading=!1}).catch(t=>{console.log(t),this.loading=!1,alert("Tidak Dapat Berkomentar")})}else this.db.collection("comments/").doc(this.data.id).update(this.data).then(t=>{this.dialogRef.close(this.data),this.loading=!1}).catch(t=>{console.log(t),this.loading=!1,alert("Tidak Dapat Berkomentar")})}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(I.f),i.Pb(I.a),i.Pb(Tp),i.Pb(ap.a))},t.\u0275cmp=i.Jb({type:t,selectors:[["app-producthome"]],decls:12,vars:3,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["appearance","outline",2,"width","100%"],["matInput","","placeholder","Write here",3,"ngModel","ngModelChange"],["mat-dialog-action","","align","end"],["mat-button","","mat-dialog-close",""],["mat-flat-button","",3,"disabled","click"]],template:function(t,e){1&t&&(i.Vb(0,"h3",0),i.Ac(1," Tambah tulisan\n"),i.Ub(),i.Vb(2,"div",1),i.Vb(3,"mat-form-field",2),i.Vb(4,"mat-label"),i.Ac(5,"Isi tulisan"),i.Ub(),i.Vb(6,"input",3),i.cc("ngModelChange",function(t){return e.data.title=t}),i.Ub(),i.Ub(),i.Ub(),i.Vb(7,"div",4),i.Vb(8,"button",5),i.Ac(9,"Batal"),i.Ub(),i.Vb(10,"button",6),i.cc("click",function(){return e.saveData()}),i.Ac(11),i.Ub(),i.Ub()),2&t&&(i.Eb(6),i.lc("ngModel",e.data.title),i.Eb(4),i.lc("disabled",e.loading),i.Eb(1),i.Bc(e.loading?"Menyimpan..":"Simpan"))},directives:[I.g,I.d,_p.b,_p.e,Ep.b,v.c,v.j,v.l,a.a,I.c],styles:[""]}),t})();var Sp=n("Xa2L"),Ap=n("Wp6s");function kp(t,e){1&t&&(i.Vb(0,"div",2),i.Qb(1,"mat-spinner"),i.Ub())}function Dp(t,e){if(1&t){const t=i.Wb();i.Vb(0,"tr"),i.Qb(1,"td"),i.Vb(2,"td"),i.Ac(3),i.Ub(),i.Vb(4,"td"),i.Ac(5),i.Ub(),i.Vb(6,"td",8),i.Vb(7,"button",9),i.cc("click",function(){i.tc(t);const n=e.$implicit,r=e.index;return i.gc(2).Producthome(n,r)}),i.Ac(8,"Edit"),i.Ub(),i.Vb(9,"button",10),i.cc("click",function(){i.tc(t);const n=e.$implicit,r=e.index;return i.gc(2).DeleteProduct(n.id,r)}),i.Ac(10),i.Ub(),i.Ub(),i.Ub()}if(2&t){const t=e.$implicit,n=e.index,r=i.gc(2);i.Eb(3),i.Bc(n+1),i.Eb(2),i.Bc(t.title),i.Eb(4),i.lc("disabled",r.loadingDelete[n]),i.Eb(1),i.Bc(r.loadingDelete[n]?"Menghapus..":"Delete comment?")}}function Np(t,e){if(1&t){const t=i.Wb();i.Vb(0,"mat-card"),i.Vb(1,"mat-card-header"),i.Vb(2,"mat-card-title"),i.Ac(3),i.Ub(),i.Ub(),i.Vb(4,"mat-card-content"),i.Vb(5,"div",3),i.Qb(6,"span",4),i.Vb(7,"button",5),i.cc("click",function(){return i.tc(t),i.gc().Producthome({},-1)}),i.Ac(8,"Tambah Komentar"),i.Ub(),i.Ub(),i.Vb(9,"table",6),i.Vb(10,"thead"),i.Qb(11,"th"),i.Vb(12,"th"),i.Ac(13,"No"),i.Ub(),i.Vb(14,"th"),i.Ac(15,"Komentar anda"),i.Ub(),i.Ub(),i.Vb(16,"tbody"),i.zc(17,Dp,11,4,"tr",7),i.Ub(),i.Ub(),i.Ub(),i.Ub()}if(2&t){const t=i.gc();i.Eb(3),i.Bc(t.title),i.Eb(14),i.lc("ngForOf",t.comments)}}const jp=[{path:"",component:g,children:[{path:"beranda",component:w},{path:"product",component:(()=>{class t{constructor(t,e,n){this.dialog=t,this.auth=e,this.db=n,this.comments={},this.userData={},this.loadingDelete={}}ngOnInit(){this.title="Komentar",this.auth.user.subscribe(t=>{this.userData=t,this.getComments()})}getComments(){this.loading=!0,this.db.collection("comments",t=>t.where("uid","==",this.userData.uid)).valueChanges({idField:"id"}).subscribe(t=>{console.log(t),this.comments=t,this.loading=!1},t=>{this.loading=!1})}Producthome(t,e){this.dialog.open(Op,{width:"400px",data:t}).afterClosed().subscribe(t=>{})}DeleteProduct(t,e){confirm("Delete item?")&&this.db.collection("comments").doc(t).delete().then(t=>{this.comments.splice(e,1),this.loadingDelete[e]=!1}).catch(t=>{this.loadingDelete[e]=!1,alert("Tidak dapat menghapus data")})}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(I.b),i.Pb(ap.a),i.Pb(Tp))},t.\u0275cmp=i.Jb({type:t,selectors:[["app-product"]],decls:2,vars:2,consts:[["style","height: 300px;","class","uk-flex uk-flex-center uk-flex-middle",4,"ngIf"],[4,"ngIf"],[1,"uk-flex","uk-flex-center","uk-flex-middle",2,"height","300px"],[1,"uk-flex"],[1,"uk-width-expand"],["mat-flat-button","","color","primary",3,"click"],[1,"uk-table","uk-table-middle","uk-table-divider"],[4,"ngFor","ngForOf"],["align","right"],["mat-button","","color","primary",3,"click"],["mat-button","","color","warn",3,"disabled","click"]],template:function(t,e){1&t&&(i.zc(0,kp,2,0,"div",0),i.zc(1,Np,18,2,"mat-card",1)),2&t&&(i.lc("ngIf",e.loading),i.Eb(1),i.lc("ngIf",!e.loading))},directives:[r.k,Sp.b,Ap.a,Ap.c,Ap.e,Ap.b,a.a,r.j],styles:[""]}),t})()},{path:"collection",component:(()=>{class t{constructor(t){this.router=t}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(o.a))},t.\u0275cmp=i.Jb({type:t,selectors:[["app-collection"]],decls:247,vars:0,consts:[[1,"gambar"],[1,"foto"],["src","https://i.pinimg.com/564x/b5/04/c3/b504c347c5c728a87cd45242042131e4.jpg"],["src","https://www.thisisanfield.com/wp-content/uploads/IMG_0716.jpg"],["src","https://www.highpresssoccer.com/wp-content/uploads/2020/07/GettyImages-1257661211.jpg"],["src","https://img.okezone.com/content/2019/12/23/45/2145280/gelar-piala-dunia-klub-bantu-liverpool-menangi-trofi-liga-inggris-7pm9Fvb6l9.jpg"],["src","https://d3j2s6hdd6a7rg.cloudfront.net/v2/uploads/media/default/0002/09/thumb_108209_default_news_size_5.jpeg"],["src","https://static.football5star.com/2017/12/reu_134225.jpg"],["src","https://img.okezone.com/content/2016/11/25/51/1551449/liga-champions-2004-2005-jadi-momen-terindah-steven-gerrard-gXUaZDeyXx.jpg"],["src","https://cdn-brilio-net.akamaized.net/community/2019/08/16/21309/image_1565887353_5d558b79280f5.jpg"],["src","https://d3j2s6hdd6a7rg.cloudfront.net/v2/uploads/media/default/0001/89/thumb_88507_default_news_size_5.jpeg"],["src","https://d3j2s6hdd6a7rg.cloudfront.net/v2/uploads/media/default/0001/31/thumb_30605_default_news_size_5.jpeg"],["src","https://d3j2s6hdd6a7rg.cloudfront.net/v2/uploads/media/default/0001/80/thumb_79567_default_news_size_5.jpeg"],["src","https://kanalinspirasi.com/wp-content/uploads/2019/06/legenda-liverpool-ian-rush.jpg"],["src","https://tmssl.akamaized.net/images/foto/normal/jerzy-dudek-liverpool-2005-1591945572-41221.jpg?lm=1591945553"],["src","https://images.daznservices.com/di/library/GOAL_INTERNATIONAL/21/35/nevilles-liverpool-xi-xabi-alonso_1shmv3sv62ef1keho657fycde.jpg?t=-1034614121&quality=60&w=1200&h=800"],["src","https://www.thetimes.co.uk/imageserver/image/%2Fmethode%2Ftimes%2Fprodmigration%2Fweb%2Fbin%2Fa586bbc4-ec49-364c-96c3-b92ef313fca4.jpg?crop=780%2C520%2C0%2C0"],["src","https://i.pinimg.com/originals/a0/3a/ab/a03aabecc6f86adfc3289c6dfbee18b7.jpg"],["src","https://secure.static.goal.com/45100/45182_gallery.jpg"],["src","https://p4.wallpaperbetter.com/wallpaper/826/593/130/dirk-kuyt-liverpool-fc-wallpaper-preview.jpg"],["src","https://d3j2s6hdd6a7rg.cloudfront.net/v2/uploads/media/default/0001/07/thumb_6618_default_news_size_5.jpeg"],["src","https://images.daznservices.com/di/library/goal_uk/a2/f0/hd-luis-suarez-liverpool_l94i7uvqn3t81n7b3mv2ptmoi.jpg?t=-1713635019&quality=60&w=1200&h=800"],["src","https://d3j2s6hdd6a7rg.cloudfront.net/v2/uploads/media/default/0002/05/thumb_104454_default_news_size_5.jpeg"],["src","https://cdn-2.tstatic.net/sumsel/foto/bank/images/pepe-reina.jpg"],["src","https://primaradio.co.id/wp-content/uploads/2016/12/Vladimir-Smicer.jpg"],["src","https://blue.kumparan.com/image/upload/fl_progressive,fl_lossy,c_fill,q_auto:best,w_640/v1541149175/swbx25fqmzyp9zlmb75l.jpg"],["src","https://blue.kumparan.com/image/upload/fl_progressive,fl_lossy,c_fill,q_auto:best,w_640/v1541149231/zw7vusdfjqcbkkes3q3v.jpg"],["src","http://d3nfwcxd527z59.cloudfront.net/content/uploads/2018/02/19193146/Steve-McManaman-Liverpool-League-Cup-trophy.jpg"],["src","https://akcdn.detik.net.id/community/media/visual/2019/12/12/758572da-787c-47a5-b933-44be6cb4aeac.jpeg?w=700&q=90"],["src","https://cdn-2.tstatic.net/tribunnews/foto/bank/images/20141010_000903_martin-skrtel-liverpool.jpg"],["src","https://d3j2s6hdd6a7rg.cloudfront.net/v2/uploads/media/default/0001/67/thumb_66724_default_news_size_5.jpeg"],["src","https://www.ligaolahraga.com/storage/images/news/2020/11/12/alisson-becker-sudah-tentukan-klub-tujuan-setelah-tinggalkan-liverpool.jpeg"],["src","https://cdn.antaranews.com/cache/800x533/2021/06/24/Celleher.jpg"],["src","https://images.daznservices.com/di/library/GOAL/97/b7/adrian-liverpool-2019-20_4n70aorha5b1mqasvqpu8vxi.jpg?t=-864490400&quality=100"],["src","https://d3j2s6hdd6a7rg.cloudfront.net/v2/uploads/media/default/0001/28/9e6db55ad5dd0c5e4086e350d8f442985fba0203.jpeg"],["src","https://d3j2s6hdd6a7rg.cloudfront.net/v2/uploads/media/default/0002/10/thumb_109025_default_news_size_5.jpeg"],["src","https://d3j2s6hdd6a7rg.cloudfront.net/v2/uploads/media/default/0002/24/thumb_123048_default_news_size_5.jpeg"],["src","https://pbs.twimg.com/media/E5wS1FTXEAAnK2O.jpg"],["src","https://i2-prod.liverpoolecho.co.uk/incoming/article20636686.ece/ALTERNATES/s615b/1_vvd1.jpg"],["src","https://pbs.twimg.com/media/E10_2TDXoAIiXNS.jpg"],["src","https://d3j2s6hdd6a7rg.cloudfront.net/v2/uploads/media/default/0002/18/8dcb023d7d8b5fce396aa5dc989c6aad29b591a9.jpeg"],["src","https://d3j2s6hdd6a7rg.cloudfront.net/v2/uploads/media/default/0002/17/thumb_116165_default_news_size_5.jpeg"],["src","https://www.thisisanfield.com/wp-content/uploads/2021-05-23-083-Liverpool_Crystal_Palace.jpg"],["src","https://www.thisisanfield.com/wp-content/uploads/2021-05-23-082-Liverpool_Crystal_Palace.jpg"],["src","https://i0.wp.com/i.dailymail.co.uk/1s/2021/07/08/08/45185093-9768001-image-m-2_1625730518610.jpg?resize=634%2C482&ssl=1"],["src","https://www.thisisanfield.com/wp-content/uploads/2020-11-25-234-Liverpool_Atalanta.jpg"],["src","https://pbs.twimg.com/media/E10iHylWYAIuXSJ.jpg"],["src","https://d3j2s6hdd6a7rg.cloudfront.net/v2/uploads/media/default/0002/22/25c795036c6302c60de1a763352f1956219ca14f.jpeg"],["src","https://d3j2s6hdd6a7rg.cloudfront.net/v2/uploads/media/default/0002/24/27b5eee2dfc7a1ea805b0b25862780b9702a6d1d.jpeg"],["src","https://www.anfieldwatch.co.uk/wp-content/uploads/2021/05/P2021-05-23-Liverpool_Crystal_Palace-97.jpg"],["src","https://d3j2s6hdd6a7rg.cloudfront.net/v2/uploads/media/default/0002/18/thumb_117614_default_news_size_5.jpeg"],["src","https://d3j2s6hdd6a7rg.cloudfront.net/v2/uploads/media/default/0002/24/thumb_123014_default_news_size_5.jpeg"],["src","https://sm.imgix.net/20/48/james-milner.jpg?w=1200&h=1200&auto=compress,format&fit=clip"],["src","https://cdn.vox-cdn.com/thumbor/MT9Ccp-8HNxOGIiDEF8MMu31kiE=/1400x1400/filters:format(jpeg)/cdn.vox-cdn.com/uploads/chorus_asset/file/22260324/1230654856.jpg"],["src","https://cdn.medcom.id/images/content/2021/05/22/1279662/TmF205bnSZ.jpeg"],["src","https://d3j2s6hdd6a7rg.cloudfront.net/v2/uploads/media/default/0002/22/cc235d9c81093c6721adc68c2f9b4a162296b00c.jpeg"],["src","https://pbs.twimg.com/media/E2FSSeGWEAsKOEN.jpg"],["src","https://d3j2s6hdd6a7rg.cloudfront.net/v2/uploads/media/default/0002/24/262bf0412015d67202e18bdd284f0a70624b74ce.jpeg"],["src","https://www.thisisanfield.com/wp-content/uploads/2020-08-25-642-Salzburg_Liverpool-1.jpg"],["src","https://www.thisisanfield.com/wp-content/uploads/P2020-10-27-Liverpool_Midtjylland-67.jpg"],["src","https://d3j2s6hdd6a7rg.cloudfront.net/v2/uploads/media/default/0002/24/531d1dddac4e0f743195a44a2e23808120d1dbcd.jpeg"]],template:function(t,e){1&t&&(i.Vb(0,"h3"),i.Ac(1,"KOLEKSI POTO LIVERPOOL DAN TROFI YANG DIRAIH"),i.Ub(),i.Vb(2,"div",0),i.Vb(3,"div",1),i.Qb(4,"img",2),i.Vb(5,"p"),i.Ac(6,"Inilah daftar piala yang sudah dimenangkan oleh Liverpool"),i.Ub(),i.Ub(),i.Vb(7,"div",1),i.Qb(8,"img",3),i.Vb(9,"p"),i.Ac(10,"Liverpool merupakan klub Inggris tersukses di benua biru dengan raihan 6 trofi"),i.Ub(),i.Ub(),i.Vb(11,"div",1),i.Qb(12,"img",4),i.Vb(13,"p"),i.Ac(14,"Penantian berharga selama 30 tahun"),i.Ub(),i.Ub(),i.Vb(15,"div",1),i.Qb(16,"img",5),i.Vb(17,"p"),i.Ac(18,"Liverpool menangkan piala dunia antar klub setelah kalahkan Flamengo di final"),i.Ub(),i.Ub(),i.Vb(19,"div",1),i.Qb(20,"img",6),i.Vb(21,"p"),i.Ac(22,"Piala Premier League ke-19 Liverpool"),i.Ub(),i.Ub(),i.Vb(23,"div",1),i.Qb(24,"img",7),i.Vb(25,"p"),i.Ac(26,"Gol ikonik Gerrard saat Liverpool menangkan piala FA 2006"),i.Ub(),i.Ub(),i.Vb(27,"div",1),i.Qb(28,"img",8),i.Vb(29,"p"),i.Ac(30,"Miracle of Istanbul! Momen terbaik dari semua fans Liverpool"),i.Ub(),i.Ub(),i.Vb(31,"div",1),i.Qb(32,"img",9),i.Vb(33,"p"),i.Ac(34,"Kalahkan Chelsea lewat adu penalti, Liverpool menangkan trofi Super Cup"),i.Ub(),i.Ub(),i.Vb(35,"div",1),i.Qb(36,"img",10),i.Vb(37,"p"),i.Ac(38,"Trofi UCL Liverpool yang ke 6, emang jago banget dah Liverpool!"),i.Ub(),i.Ub(),i.Ub(),i.Vb(39,"h3"),i.Ac(40,"Legend Liverpool"),i.Ub(),i.Vb(41,"div",0),i.Vb(42,"div",1),i.Qb(43,"img",11),i.Vb(44,"p"),i.Ac(45,"Steven Gerrard"),i.Ub(),i.Ub(),i.Vb(46,"div",1),i.Qb(47,"img",12),i.Vb(48,"p"),i.Ac(49,"Jamie Carragher"),i.Ub(),i.Ub(),i.Vb(50,"div",1),i.Qb(51,"img",13),i.Vb(52,"p"),i.Ac(53,"Ian Rush"),i.Ub(),i.Ub(),i.Vb(54,"div",1),i.Qb(55,"img",14),i.Vb(56,"p"),i.Ac(57,"Jerzy Dudek"),i.Ub(),i.Ub(),i.Vb(58,"div",1),i.Qb(59,"img",15),i.Vb(60,"p"),i.Ac(61,"Xabi Alonso"),i.Ub(),i.Ub(),i.Vb(62,"div",1),i.Qb(63,"img",16),i.Vb(64,"p"),i.Ac(65,"Sir Kenny Dalglish"),i.Ub(),i.Ub(),i.Vb(66,"div",1),i.Qb(67,"img",17),i.Vb(68,"p"),i.Ac(69,"John Arne Riise"),i.Ub(),i.Ub(),i.Vb(70,"div",1),i.Qb(71,"img",18),i.Vb(72,"p"),i.Ac(73,"Fernando Torres"),i.Ub(),i.Ub(),i.Vb(74,"div",1),i.Qb(75,"img",19),i.Vb(76,"p"),i.Ac(77,"Dirk Kyut"),i.Ub(),i.Ub(),i.Vb(78,"div",1),i.Qb(79,"img",20),i.Vb(80,"p"),i.Ac(81,"Daniel Agger"),i.Ub(),i.Ub(),i.Vb(82,"div",1),i.Qb(83,"img",21),i.Vb(84,"p"),i.Ac(85,"Luis Suarez"),i.Ub(),i.Ub(),i.Vb(86,"div",1),i.Qb(87,"img",22),i.Vb(88,"p"),i.Ac(89,"Robbie Fowler"),i.Ub(),i.Ub(),i.Vb(90,"div",1),i.Qb(91,"img",23),i.Vb(92,"p"),i.Ac(93,"Pepe Reina"),i.Ub(),i.Ub(),i.Vb(94,"div",1),i.Qb(95,"img",24),i.Vb(96,"p"),i.Ac(97,"Vladimir Smicer"),i.Ub(),i.Ub(),i.Vb(98,"div",1),i.Qb(99,"img",25),i.Vb(100,"p"),i.Ac(101,"Ray Clemence"),i.Ub(),i.Ub(),i.Vb(102,"div",1),i.Qb(103,"img",26),i.Vb(104,"p"),i.Ac(105,"Alen Hansen"),i.Ub(),i.Ub(),i.Vb(106,"div",1),i.Qb(107,"img",27),i.Vb(108,"p"),i.Ac(109,"Steve McManaman"),i.Ub(),i.Ub(),i.Vb(110,"div",1),i.Qb(111,"img",28),i.Vb(112,"p"),i.Ac(113,"Jordan Henderson"),i.Ub(),i.Ub(),i.Vb(114,"div",1),i.Qb(115,"img",29),i.Vb(116,"p"),i.Ac(117,"Martin Skrtel"),i.Ub(),i.Ub(),i.Vb(118,"div",1),i.Qb(119,"img",30),i.Vb(120,"p"),i.Ac(121,"Jose Enrique"),i.Ub(),i.Ub(),i.Ub(),i.Vb(122,"h3"),i.Ac(123,"Official Squad of Liverpool FC 2020/2021*"),i.Ub(),i.Vb(124,"div",0),i.Vb(125,"div",1),i.Qb(126,"img",31),i.Vb(127,"p"),i.Ac(128,"Alisson Becker"),i.Ub(),i.Ub(),i.Vb(129,"div",1),i.Qb(130,"img",32),i.Vb(131,"p"),i.Ac(132,"Caoimhin Kelleher"),i.Ub(),i.Ub(),i.Vb(133,"div",1),i.Qb(134,"img",33),i.Vb(135,"p"),i.Ac(136,"Adrian San Miguel"),i.Ub(),i.Ub(),i.Vb(137,"div",1),i.Qb(138,"img",34),i.Vb(139,"p"),i.Ac(140,"Loris Karius"),i.Ub(),i.Ub(),i.Vb(141,"div",1),i.Qb(142,"img",35),i.Vb(143,"p"),i.Ac(144,"Kostas Tsimikas"),i.Ub(),i.Ub(),i.Vb(145,"div",1),i.Qb(146,"img",36),i.Vb(147,"p"),i.Ac(148,"Ibrahima Konate"),i.Ub(),i.Ub(),i.Vb(149,"div",1),i.Qb(150,"img",37),i.Vb(151,"p"),i.Ac(152,"Joe Gomez"),i.Ub(),i.Ub(),i.Vb(153,"div",1),i.Qb(154,"img",38),i.Vb(155,"p"),i.Ac(156,"Virgil Van Dijk"),i.Ub(),i.Ub(),i.Vb(157,"div",1),i.Qb(158,"img",39),i.Vb(159,"p"),i.Ac(160,"Andy Robertson"),i.Ub(),i.Ub(),i.Vb(161,"div",1),i.Qb(162,"img",40),i.Vb(163,"p"),i.Ac(164,"Ben Davies"),i.Ub(),i.Ub(),i.Vb(165,"div",1),i.Qb(166,"img",41),i.Vb(167,"p"),i.Ac(168,"Joel Matip"),i.Ub(),i.Ub(),i.Vb(169,"div",1),i.Qb(170,"img",42),i.Vb(171,"p"),i.Ac(172,"Rhys Williams"),i.Ub(),i.Ub(),i.Vb(173,"div",1),i.Qb(174,"img",43),i.Vb(175,"p"),i.Ac(176,"Nathaniel Phillips"),i.Ub(),i.Ub(),i.Vb(177,"div",1),i.Qb(178,"img",44),i.Vb(179,"p"),i.Ac(180,"Trent Alexander-Arnold"),i.Ub(),i.Ub(),i.Vb(181,"div",1),i.Qb(182,"img",45),i.Vb(183,"p"),i.Ac(184,"Neco Williams"),i.Ub(),i.Ub(),i.Vb(185,"div",1),i.Qb(186,"img",46),i.Vb(187,"p"),i.Ac(188,"Fabinho"),i.Ub(),i.Ub(),i.Vb(189,"div",1),i.Qb(190,"img",47),i.Vb(191,"p"),i.Ac(192,"Naby Keita"),i.Ub(),i.Ub(),i.Vb(193,"div",1),i.Qb(194,"img",48),i.Vb(195,"p"),i.Ac(196,"Curtis Jones"),i.Ub(),i.Ub(),i.Vb(197,"div",1),i.Qb(198,"img",49),i.Vb(199,"p"),i.Ac(200,"Thiago Alcantara"),i.Ub(),i.Ub(),i.Vb(201,"div",1),i.Qb(202,"img",50),i.Vb(203,"p"),i.Ac(204,"Jordan Henderson"),i.Ub(),i.Ub(),i.Vb(205,"div",1),i.Qb(206,"img",51),i.Vb(207,"p"),i.Ac(208,"Alex Oxlade-Chamberlain"),i.Ub(),i.Ub(),i.Vb(209,"div",1),i.Qb(210,"img",52),i.Vb(211,"p"),i.Ac(212,"James Milner"),i.Ub(),i.Ub(),i.Vb(213,"div",1),i.Qb(214,"img",53),i.Vb(215,"p"),i.Ac(216,"Xherdan Shaqiri"),i.Ub(),i.Ub(),i.Vb(217,"div",1),i.Qb(218,"img",54),i.Vb(219,"p"),i.Ac(220,"Mohamed Salah"),i.Ub(),i.Ub(),i.Vb(221,"div",1),i.Qb(222,"img",55),i.Vb(223,"p"),i.Ac(224,"Sadio Mane"),i.Ub(),i.Ub(),i.Vb(225,"div",1),i.Qb(226,"img",56),i.Vb(227,"p"),i.Ac(228,"Roberto Firmino"),i.Ub(),i.Ub(),i.Vb(229,"div",1),i.Qb(230,"img",57),i.Vb(231,"p"),i.Ac(232,"Diogo Jota"),i.Ub(),i.Ub(),i.Vb(233,"div",1),i.Qb(234,"img",58),i.Vb(235,"p"),i.Ac(236,"Takumi Minamino"),i.Ub(),i.Ub(),i.Vb(237,"div",1),i.Qb(238,"img",59),i.Vb(239,"p"),i.Ac(240,"Divock Origi"),i.Ub(),i.Ub(),i.Vb(241,"div",1),i.Qb(242,"img",60),i.Vb(243,"p"),i.Ac(244,"Harvey Elliot"),i.Ub(),i.Ub(),i.Ub(),i.Vb(245,"p"),i.Ac(246,"*Poto pemain bisa berganti sewaktu-waktu tergantung ada pemain yang keluar atau pemain baru masuk"),i.Ub())},styles:[".gambar[_ngcontent-%COMP%]{width:90%;display:grid;grid-template-columns:2fr 2fr 2fr;margin:auto}.gambar[_ngcontent-%COMP%]   .foto[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:300px}.foto[_ngcontent-%COMP%]{margin:10px;text-align:center}.foto[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding:10px;color:#fff;background:green;text-decoration:none;cursor:pointer}"]}),t})()},{path:"",pathMatch:"full",redirectTo:"/admin/beranda"}]}];let xp=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.Nb({type:t}),t.\u0275inj=i.Mb({imports:[[r.c,o.c.forChild(jp),y.a,v.f,b.b]]}),t})()}}]);